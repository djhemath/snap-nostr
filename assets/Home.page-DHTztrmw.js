var cn=Object.defineProperty;var ln=(e,t,n)=>t in e?cn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var bt=(e,t,n)=>ln(e,typeof t!="symbol"?t+"":t,n);import{r as reactExports,o,c as commonjsGlobal,g as getDefaultExportFromCjs,j as jsxRuntimeExports,i as isSafari,p as proxyImg,t as toReadableStatsFormat,d as defaultImgProxy,b as bitMask$1,n as numberToBytesLE$1,a as numberToBytesBE$1,e as bytesToNumberLE$1,f as bytesToNumberBE$1,v as validateObject$1,h as bitLen$1,k as abool,l as inRange,m as concatBytes$3,q as ensureBytes$1,s as aInRange,u as hexToBytes$2,w as createHmacDrbg$1,x as isBytes$1,y as numberToHexUnpadded$1,z as abytes,A as bytesToHex$2,B as ut$2,C as memoized,D as hmac$2,E as concatBytes$4,F as randomBytes$2,G as sha256$2,H as bytesToHex$3,I as bech32$2,J as hexToBytes$3,M as MILLISATS_PER_SAT,K as useNoteContext,L as useRelaysContext,N as getBreakpoint,O as GRADIENTS,P as initialGradient,Q as NOSTR_BRANDING_COLORS,R as getDataURLFromHTMLDOM,S as downloadImage,T as trackEvent,U as copyDataURL}from"./index-B2K4Do85.js";function r(e){var t,n,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(n=r(e[t]))&&(s&&(s+=" "),s+=n)}else for(n in e)e[n]&&(s&&(s+=" "),s+=n);return s}function clsx(){for(var e,t,n=0,s="",a=arguments.length;n<a;n++)(e=arguments[n])&&(t=r(e))&&(s&&(s+=" "),s+=t);return s}const c=e=>typeof e=="number"&&!isNaN(e),d$1=e=>typeof e=="string",u=e=>typeof e=="function",p=e=>d$1(e)||u(e)?e:null,m$1=e=>reactExports.isValidElement(e)||d$1(e)||u(e)||c(e);function f$1(e,t,n){n===void 0&&(n=300);const{scrollHeight:s,style:a}=e;requestAnimationFrame(()=>{a.minHeight="initial",a.height=s+"px",a.transition=`all ${n}ms`,requestAnimationFrame(()=>{a.height="0",a.padding="0",a.margin="0",setTimeout(t,n)})})}function g$1(e){let{enter:t,exit:n,appendPosition:s=!1,collapse:a=!0,collapseDuration:l=300}=e;return function(de){let{children:pe,position:me,preventExitTransition:Be,done:Le,nodeRef:Ye,isIn:tt,playToast:ot}=de;const yt=s?`${t}--${me}`:t,nt=s?`${n}--${me}`:n,st=reactExports.useRef(0);return reactExports.useLayoutEffect(()=>{const gt=Ye.current,wt=yt.split(" "),vt=Rt=>{Rt.target===Ye.current&&(ot(),gt.removeEventListener("animationend",vt),gt.removeEventListener("animationcancel",vt),st.current===0&&Rt.type!=="animationcancel"&&gt.classList.remove(...wt))};gt.classList.add(...wt),gt.addEventListener("animationend",vt),gt.addEventListener("animationcancel",vt)},[]),reactExports.useEffect(()=>{const gt=Ye.current,wt=()=>{gt.removeEventListener("animationend",wt),a?f$1(gt,Le,l):Le()};tt||(Be?wt():(st.current=1,gt.className+=` ${nt}`,gt.addEventListener("animationend",wt)))},[tt]),o.createElement(o.Fragment,null,pe)}}function y$1(e,t){return e!=null?{content:e.content,containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,status:t}:{}}const v$1=new Map;let h=[];const T$1=new Set,E=e=>T$1.forEach(t=>t(e)),b=()=>v$1.size>0;function I$1(e,t){var n;if(t)return!((n=v$1.get(t))==null||!n.isToastActive(e));let s=!1;return v$1.forEach(a=>{a.isToastActive(e)&&(s=!0)}),s}function _$1(e,t){m$1(e)&&(b()||h.push({content:e,options:t}),v$1.forEach(n=>{n.buildToast(e,t)}))}function C$1(e,t){v$1.forEach(n=>{t!=null&&t!=null&&t.containerId?(t==null?void 0:t.containerId)===n.id&&n.toggle(e,t==null?void 0:t.id):n.toggle(e,t==null?void 0:t.id)})}function L$1(e){const{subscribe:t,getSnapshot:n,setProps:s}=reactExports.useRef(function(l){const de=l.containerId||1;return{subscribe(pe){const me=function(Le,Ye,tt){let ot=1,yt=0,nt=[],st=[],gt=[],wt=Ye;const vt=new Map,Rt=new Set,Bt=()=>{gt=Array.from(vt.values()),Rt.forEach(kt=>kt())},$t=kt=>{st=kt==null?[]:st.filter(Lt=>Lt!==kt),Bt()},Ct=kt=>{const{toastId:Lt,onOpen:Pt,updateId:mt,children:_t}=kt.props,Tt=mt==null;kt.staleId&&vt.delete(kt.staleId),vt.set(Lt,kt),st=[...st,kt.props.toastId].filter(xt=>xt!==kt.staleId),Bt(),tt(y$1(kt,Tt?"added":"updated")),Tt&&u(Pt)&&Pt(reactExports.isValidElement(_t)&&_t.props)};return{id:Le,props:wt,observe:kt=>(Rt.add(kt),()=>Rt.delete(kt)),toggle:(kt,Lt)=>{vt.forEach(Pt=>{Lt!=null&&Lt!==Pt.props.toastId||u(Pt.toggle)&&Pt.toggle(kt)})},removeToast:$t,toasts:vt,clearQueue:()=>{yt-=nt.length,nt=[]},buildToast:(kt,Lt)=>{if((Mt=>{let{containerId:jt,toastId:Ft,updateId:Ut}=Mt;const Ot=jt?jt!==Le:Le!==1,Ht=vt.has(Ft)&&Ut==null;return Ot||Ht})(Lt))return;const{toastId:Pt,updateId:mt,data:_t,staleId:Tt,delay:xt}=Lt,ht=()=>{$t(Pt)},ft=mt==null;ft&&yt++;const Et={...wt,style:wt.toastStyle,key:ot++,...Object.fromEntries(Object.entries(Lt).filter(Mt=>{let[jt,Ft]=Mt;return Ft!=null})),toastId:Pt,updateId:mt,data:_t,closeToast:ht,isIn:!1,className:p(Lt.className||wt.toastClassName),bodyClassName:p(Lt.bodyClassName||wt.bodyClassName),progressClassName:p(Lt.progressClassName||wt.progressClassName),autoClose:!Lt.isLoading&&(St=Lt.autoClose,At=wt.autoClose,St===!1||c(St)&&St>0?St:At),deleteToast(){const Mt=vt.get(Pt),{onClose:jt,children:Ft}=Mt.props;u(jt)&&jt(reactExports.isValidElement(Ft)&&Ft.props),tt(y$1(Mt,"removed")),vt.delete(Pt),yt--,yt<0&&(yt=0),nt.length>0?Ct(nt.shift()):Bt()}};var St,At;Et.closeButton=wt.closeButton,Lt.closeButton===!1||m$1(Lt.closeButton)?Et.closeButton=Lt.closeButton:Lt.closeButton===!0&&(Et.closeButton=!m$1(wt.closeButton)||wt.closeButton);let Nt=kt;reactExports.isValidElement(kt)&&!d$1(kt.type)?Nt=reactExports.cloneElement(kt,{closeToast:ht,toastProps:Et,data:_t}):u(kt)&&(Nt=kt({closeToast:ht,toastProps:Et,data:_t}));const It={content:Nt,props:Et,staleId:Tt};wt.limit&&wt.limit>0&&yt>wt.limit&&ft?nt.push(It):c(xt)?setTimeout(()=>{Ct(It)},xt):Ct(It)},setProps(kt){wt=kt},setToggle:(kt,Lt)=>{vt.get(kt).toggle=Lt},isToastActive:kt=>st.some(Lt=>Lt===kt),getSnapshot:()=>gt}}(de,l,E);v$1.set(de,me);const Be=me.observe(pe);return h.forEach(Le=>_$1(Le.content,Le.options)),h=[],()=>{Be(),v$1.delete(de)}},setProps(pe){var me;(me=v$1.get(de))==null||me.setProps(pe)},getSnapshot(){var pe;return(pe=v$1.get(de))==null?void 0:pe.getSnapshot()}}}(e)).current;s(e);const a=reactExports.useSyncExternalStore(t,n,n);return{getToastToRender:function(l){if(!a)return[];const de=new Map;return e.newestOnTop&&a.reverse(),a.forEach(pe=>{const{position:me}=pe.props;de.has(me)||de.set(me,[]),de.get(me).push(pe)}),Array.from(de,pe=>l(pe[0],pe[1]))},isToastActive:I$1,count:a==null?void 0:a.length}}function N(e){const[t,n]=reactExports.useState(!1),[s,a]=reactExports.useState(!1),l=reactExports.useRef(null),de=reactExports.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:pe,pauseOnHover:me,closeToast:Be,onClick:Le,closeOnClick:Ye}=e;var tt,ot;function yt(){n(!0)}function nt(){n(!1)}function st(vt){const Rt=l.current;de.canDrag&&Rt&&(de.didMove=!0,t&&nt(),de.delta=e.draggableDirection==="x"?vt.clientX-de.start:vt.clientY-de.start,de.start!==vt.clientX&&(de.canCloseOnClick=!1),Rt.style.transform=`translate3d(${e.draggableDirection==="x"?`${de.delta}px, var(--y)`:`0, calc(${de.delta}px + var(--y))`},0)`,Rt.style.opacity=""+(1-Math.abs(de.delta/de.removalDistance)))}function gt(){document.removeEventListener("pointermove",st),document.removeEventListener("pointerup",gt);const vt=l.current;if(de.canDrag&&de.didMove&&vt){if(de.canDrag=!1,Math.abs(de.delta)>de.removalDistance)return a(!0),e.closeToast(),void e.collapseAll();vt.style.transition="transform 0.2s, opacity 0.2s",vt.style.removeProperty("transform"),vt.style.removeProperty("opacity")}}(ot=v$1.get((tt={id:e.toastId,containerId:e.containerId,fn:n}).containerId||1))==null||ot.setToggle(tt.id,tt.fn),reactExports.useEffect(()=>{if(e.pauseOnFocusLoss)return document.hasFocus()||nt(),window.addEventListener("focus",yt),window.addEventListener("blur",nt),()=>{window.removeEventListener("focus",yt),window.removeEventListener("blur",nt)}},[e.pauseOnFocusLoss]);const wt={onPointerDown:function(vt){if(e.draggable===!0||e.draggable===vt.pointerType){de.didMove=!1,document.addEventListener("pointermove",st),document.addEventListener("pointerup",gt);const Rt=l.current;de.canCloseOnClick=!0,de.canDrag=!0,Rt.style.transition="none",e.draggableDirection==="x"?(de.start=vt.clientX,de.removalDistance=Rt.offsetWidth*(e.draggablePercent/100)):(de.start=vt.clientY,de.removalDistance=Rt.offsetHeight*(e.draggablePercent===80?1.5*e.draggablePercent:e.draggablePercent)/100)}},onPointerUp:function(vt){const{top:Rt,bottom:Bt,left:$t,right:Ct}=l.current.getBoundingClientRect();vt.nativeEvent.type!=="touchend"&&e.pauseOnHover&&vt.clientX>=$t&&vt.clientX<=Ct&&vt.clientY>=Rt&&vt.clientY<=Bt?nt():yt()}};return pe&&me&&(wt.onMouseEnter=nt,e.stacked||(wt.onMouseLeave=yt)),Ye&&(wt.onClick=vt=>{Le&&Le(vt),de.canCloseOnClick&&Be()}),{playToast:yt,pauseToast:nt,isRunning:t,preventExitTransition:s,toastRef:l,eventHandlers:wt}}function $$1(e){let{delay:t,isRunning:n,closeToast:s,type:a="default",hide:l,className:de,style:pe,controlledProgress:me,progress:Be,rtl:Le,isIn:Ye,theme:tt}=e;const ot=l||me&&Be===0,yt={...pe,animationDuration:`${t}ms`,animationPlayState:n?"running":"paused"};me&&(yt.transform=`scaleX(${Be})`);const nt=clsx("Toastify__progress-bar",me?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${tt}`,`Toastify__progress-bar--${a}`,{"Toastify__progress-bar--rtl":Le}),st=u(de)?de({rtl:Le,type:a,defaultClassName:nt}):clsx(nt,de),gt={[me&&Be>=1?"onTransitionEnd":"onAnimationEnd"]:me&&Be<1?null:()=>{Ye&&s()}};return o.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":ot},o.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${tt} Toastify__progress-bar--${a}`}),o.createElement("div",{role:"progressbar","aria-hidden":ot?"true":"false","aria-label":"notification timer",className:st,style:yt,...gt}))}let w$1=1;const k$1=()=>""+w$1++;function P(e){return e&&(d$1(e.toastId)||c(e.toastId))?e.toastId:k$1()}function M$1(e,t){return _$1(e,t),t.toastId}function x$1(e,t){return{...t,type:t&&t.type||e,toastId:P(t)}}function A$1(e){return(t,n)=>M$1(t,x$1(e,n))}function B$1(e,t){return M$1(e,x$1("default",t))}B$1.loading=(e,t)=>M$1(e,x$1("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t})),B$1.promise=function(e,t,n){let s,{pending:a,error:l,success:de}=t;a&&(s=d$1(a)?B$1.loading(a,n):B$1.loading(a.render,{...n,...a}));const pe={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},me=(Le,Ye,tt)=>{if(Ye==null)return void B$1.dismiss(s);const ot={type:Le,...pe,...n,data:tt},yt=d$1(Ye)?{render:Ye}:Ye;return s?B$1.update(s,{...ot,...yt}):B$1(yt.render,{...ot,...yt}),tt},Be=u(e)?e():e;return Be.then(Le=>me("success",de,Le)).catch(Le=>me("error",l,Le)),Be},B$1.success=A$1("success"),B$1.info=A$1("info"),B$1.error=A$1("error"),B$1.warning=A$1("warning"),B$1.warn=B$1.warning,B$1.dark=(e,t)=>M$1(e,x$1("default",{theme:"dark",...t})),B$1.dismiss=function(e){(function(t){var n;if(b()){if(t==null||d$1(n=t)||c(n))v$1.forEach(s=>{s.removeToast(t)});else if(t&&("containerId"in t||"id"in t)){const s=v$1.get(t.containerId);s?s.removeToast(t.id):v$1.forEach(a=>{a.removeToast(t.id)})}}else h=h.filter(s=>t!=null&&s.options.toastId!==t)})(e)},B$1.clearWaitingQueue=function(e){e===void 0&&(e={}),v$1.forEach(t=>{!t.props.limit||e.containerId&&t.id!==e.containerId||t.clearQueue()})},B$1.isActive=I$1,B$1.update=function(e,t){t===void 0&&(t={});const n=((s,a)=>{var l;let{containerId:de}=a;return(l=v$1.get(de||1))==null?void 0:l.toasts.get(s)})(e,t);if(n){const{props:s,content:a}=n,l={delay:100,...s,...t,toastId:t.toastId||e,updateId:k$1()};l.toastId!==e&&(l.staleId=e);const de=l.render||a;delete l.render,M$1(de,l)}},B$1.done=e=>{B$1.update(e,{progress:1})},B$1.onChange=function(e){return T$1.add(e),()=>{T$1.delete(e)}},B$1.play=e=>C$1(!0,e),B$1.pause=e=>C$1(!1,e);const O$1=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect,D$1=e=>{let{theme:t,type:n,isLoading:s,...a}=e;return o.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:t==="colored"?"currentColor":`var(--toastify-icon-color-${n})`,...a})},z$1={info:function(e){return o.createElement(D$1,{...e},o.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(e){return o.createElement(D$1,{...e},o.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(e){return o.createElement(D$1,{...e},o.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(e){return o.createElement(D$1,{...e},o.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return o.createElement("div",{className:"Toastify__spinner"})}},R$1=e=>{const{isRunning:t,preventExitTransition:n,toastRef:s,eventHandlers:a,playToast:l}=N(e),{closeButton:de,children:pe,autoClose:me,onClick:Be,type:Le,hideProgressBar:Ye,closeToast:tt,transition:ot,position:yt,className:nt,style:st,bodyClassName:gt,bodyStyle:wt,progressClassName:vt,progressStyle:Rt,updateId:Bt,role:$t,progress:Ct,rtl:kt,toastId:Lt,deleteToast:Pt,isIn:mt,isLoading:_t,closeOnClick:Tt,theme:xt}=e,ht=clsx("Toastify__toast",`Toastify__toast-theme--${xt}`,`Toastify__toast--${Le}`,{"Toastify__toast--rtl":kt},{"Toastify__toast--close-on-click":Tt}),ft=u(nt)?nt({rtl:kt,position:yt,type:Le,defaultClassName:ht}):clsx(ht,nt),Et=function(It){let{theme:Mt,type:jt,isLoading:Ft,icon:Ut}=It,Ot=null;const Ht={theme:Mt,type:jt};return Ut===!1||(u(Ut)?Ot=Ut({...Ht,isLoading:Ft}):reactExports.isValidElement(Ut)?Ot=reactExports.cloneElement(Ut,Ht):Ft?Ot=z$1.spinner():(Vt=>Vt in z$1)(jt)&&(Ot=z$1[jt](Ht))),Ot}(e),St=!!Ct||!me,At={closeToast:tt,type:Le,theme:xt};let Nt=null;return de===!1||(Nt=u(de)?de(At):reactExports.isValidElement(de)?reactExports.cloneElement(de,At):function(It){let{closeToast:Mt,theme:jt,ariaLabel:Ft="close"}=It;return o.createElement("button",{className:`Toastify__close-button Toastify__close-button--${jt}`,type:"button",onClick:Ut=>{Ut.stopPropagation(),Mt(Ut)},"aria-label":Ft},o.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},o.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}(At)),o.createElement(ot,{isIn:mt,done:Pt,position:yt,preventExitTransition:n,nodeRef:s,playToast:l},o.createElement("div",{id:Lt,onClick:Be,"data-in":mt,className:ft,...a,style:st,ref:s},o.createElement("div",{...mt&&{role:$t},className:u(gt)?gt({type:Le}):clsx("Toastify__toast-body",gt),style:wt},Et!=null&&o.createElement("div",{className:clsx("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!_t})},Et),o.createElement("div",null,pe)),Nt,o.createElement($$1,{...Bt&&!St?{key:`pb-${Bt}`}:{},rtl:kt,theme:xt,delay:me,isRunning:t,isIn:mt,closeToast:tt,hide:Ye,type:Le,style:Rt,className:vt,controlledProgress:St,progress:Ct||0})))},S$1=function(e,t){return t===void 0&&(t=!1),{enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:t}},H$1=g$1(S$1("bounce",!0));g$1(S$1("slide",!0));g$1(S$1("zoom"));g$1(S$1("flip"));const q$1={position:"top-right",transition:H$1,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};function Q$1(e){let t={...q$1,...e};const n=e.stacked,[s,a]=reactExports.useState(!0),l=reactExports.useRef(null),{getToastToRender:de,isToastActive:pe,count:me}=L$1(t),{className:Be,style:Le,rtl:Ye,containerId:tt}=t;function ot(nt){const st=clsx("Toastify__toast-container",`Toastify__toast-container--${nt}`,{"Toastify__toast-container--rtl":Ye});return u(Be)?Be({position:nt,rtl:Ye,defaultClassName:st}):clsx(st,p(Be))}function yt(){n&&(a(!0),B$1.play())}return O$1(()=>{if(n){var nt;const st=l.current.querySelectorAll('[data-in="true"]'),gt=12,wt=(nt=t.position)==null?void 0:nt.includes("top");let vt=0,Rt=0;Array.from(st).reverse().forEach((Bt,$t)=>{const Ct=Bt;Ct.classList.add("Toastify__toast--stacked"),$t>0&&(Ct.dataset.collapsed=`${s}`),Ct.dataset.pos||(Ct.dataset.pos=wt?"top":"bot");const kt=vt*(s?.2:1)+(s?0:gt*$t);Ct.style.setProperty("--y",`${wt?kt:-1*kt}px`),Ct.style.setProperty("--g",`${gt}`),Ct.style.setProperty("--s",""+(1-(s?Rt:0))),vt+=Ct.offsetHeight,Rt+=.025})}},[s,me,n]),o.createElement("div",{ref:l,className:"Toastify",id:tt,onMouseEnter:()=>{n&&(a(!1),B$1.pause())},onMouseLeave:yt},de((nt,st)=>{const gt=st.length?{...Le}:{...Le,pointerEvents:"none"};return o.createElement("div",{className:ot(nt),style:gt,key:`container-${nt}`},st.map(wt=>{let{content:vt,props:Rt}=wt;return o.createElement(R$1,{...Rt,stacked:n,collapseAll:yt,isIn:pe(Rt.toastId,Rt.containerId),style:Rt.style,key:`toast-${Rt.key}`},vt)}))}))}var dayjs_min={exports:{}};(function(e,t){(function(n,s){e.exports=s()})(commonjsGlobal,function(){var n=1e3,s=6e4,a=36e5,l="millisecond",de="second",pe="minute",me="hour",Be="day",Le="week",Ye="month",tt="quarter",ot="year",yt="date",nt="Invalid Date",st=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,gt=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,wt={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(xt){var ht=["th","st","nd","rd"],ft=xt%100;return"["+xt+(ht[(ft-20)%10]||ht[ft]||ht[0])+"]"}},vt=function(xt,ht,ft){var Et=String(xt);return!Et||Et.length>=ht?xt:""+Array(ht+1-Et.length).join(ft)+xt},Rt={s:vt,z:function(xt){var ht=-xt.utcOffset(),ft=Math.abs(ht),Et=Math.floor(ft/60),St=ft%60;return(ht<=0?"+":"-")+vt(Et,2,"0")+":"+vt(St,2,"0")},m:function xt(ht,ft){if(ht.date()<ft.date())return-xt(ft,ht);var Et=12*(ft.year()-ht.year())+(ft.month()-ht.month()),St=ht.clone().add(Et,Ye),At=ft-St<0,Nt=ht.clone().add(Et+(At?-1:1),Ye);return+(-(Et+(ft-St)/(At?St-Nt:Nt-St))||0)},a:function(xt){return xt<0?Math.ceil(xt)||0:Math.floor(xt)},p:function(xt){return{M:Ye,y:ot,w:Le,d:Be,D:yt,h:me,m:pe,s:de,ms:l,Q:tt}[xt]||String(xt||"").toLowerCase().replace(/s$/,"")},u:function(xt){return xt===void 0}},Bt="en",$t={};$t[Bt]=wt;var Ct="$isDayjsObject",kt=function(xt){return xt instanceof _t||!(!xt||!xt[Ct])},Lt=function xt(ht,ft,Et){var St;if(!ht)return Bt;if(typeof ht=="string"){var At=ht.toLowerCase();$t[At]&&(St=At),ft&&($t[At]=ft,St=At);var Nt=ht.split("-");if(!St&&Nt.length>1)return xt(Nt[0])}else{var It=ht.name;$t[It]=ht,St=It}return!Et&&St&&(Bt=St),St||!Et&&Bt},Pt=function(xt,ht){if(kt(xt))return xt.clone();var ft=typeof ht=="object"?ht:{};return ft.date=xt,ft.args=arguments,new _t(ft)},mt=Rt;mt.l=Lt,mt.i=kt,mt.w=function(xt,ht){return Pt(xt,{locale:ht.$L,utc:ht.$u,x:ht.$x,$offset:ht.$offset})};var _t=function(){function xt(ft){this.$L=Lt(ft.locale,null,!0),this.parse(ft),this.$x=this.$x||ft.x||{},this[Ct]=!0}var ht=xt.prototype;return ht.parse=function(ft){this.$d=function(Et){var St=Et.date,At=Et.utc;if(St===null)return new Date(NaN);if(mt.u(St))return new Date;if(St instanceof Date)return new Date(St);if(typeof St=="string"&&!/Z$/i.test(St)){var Nt=St.match(st);if(Nt){var It=Nt[2]-1||0,Mt=(Nt[7]||"0").substring(0,3);return At?new Date(Date.UTC(Nt[1],It,Nt[3]||1,Nt[4]||0,Nt[5]||0,Nt[6]||0,Mt)):new Date(Nt[1],It,Nt[3]||1,Nt[4]||0,Nt[5]||0,Nt[6]||0,Mt)}}return new Date(St)}(ft),this.init()},ht.init=function(){var ft=this.$d;this.$y=ft.getFullYear(),this.$M=ft.getMonth(),this.$D=ft.getDate(),this.$W=ft.getDay(),this.$H=ft.getHours(),this.$m=ft.getMinutes(),this.$s=ft.getSeconds(),this.$ms=ft.getMilliseconds()},ht.$utils=function(){return mt},ht.isValid=function(){return this.$d.toString()!==nt},ht.isSame=function(ft,Et){var St=Pt(ft);return this.startOf(Et)<=St&&St<=this.endOf(Et)},ht.isAfter=function(ft,Et){return Pt(ft)<this.startOf(Et)},ht.isBefore=function(ft,Et){return this.endOf(Et)<Pt(ft)},ht.$g=function(ft,Et,St){return mt.u(ft)?this[Et]:this.set(St,ft)},ht.unix=function(){return Math.floor(this.valueOf()/1e3)},ht.valueOf=function(){return this.$d.getTime()},ht.startOf=function(ft,Et){var St=this,At=!!mt.u(Et)||Et,Nt=mt.p(ft),It=function(Dt,qt){var Wt=mt.w(St.$u?Date.UTC(St.$y,qt,Dt):new Date(St.$y,qt,Dt),St);return At?Wt:Wt.endOf(Be)},Mt=function(Dt,qt){return mt.w(St.toDate()[Dt].apply(St.toDate("s"),(At?[0,0,0,0]:[23,59,59,999]).slice(qt)),St)},jt=this.$W,Ft=this.$M,Ut=this.$D,Ot="set"+(this.$u?"UTC":"");switch(Nt){case ot:return At?It(1,0):It(31,11);case Ye:return At?It(1,Ft):It(0,Ft+1);case Le:var Ht=this.$locale().weekStart||0,Vt=(jt<Ht?jt+7:jt)-Ht;return It(At?Ut-Vt:Ut+(6-Vt),Ft);case Be:case yt:return Mt(Ot+"Hours",0);case me:return Mt(Ot+"Minutes",1);case pe:return Mt(Ot+"Seconds",2);case de:return Mt(Ot+"Milliseconds",3);default:return this.clone()}},ht.endOf=function(ft){return this.startOf(ft,!1)},ht.$set=function(ft,Et){var St,At=mt.p(ft),Nt="set"+(this.$u?"UTC":""),It=(St={},St[Be]=Nt+"Date",St[yt]=Nt+"Date",St[Ye]=Nt+"Month",St[ot]=Nt+"FullYear",St[me]=Nt+"Hours",St[pe]=Nt+"Minutes",St[de]=Nt+"Seconds",St[l]=Nt+"Milliseconds",St)[At],Mt=At===Be?this.$D+(Et-this.$W):Et;if(At===Ye||At===ot){var jt=this.clone().set(yt,1);jt.$d[It](Mt),jt.init(),this.$d=jt.set(yt,Math.min(this.$D,jt.daysInMonth())).$d}else It&&this.$d[It](Mt);return this.init(),this},ht.set=function(ft,Et){return this.clone().$set(ft,Et)},ht.get=function(ft){return this[mt.p(ft)]()},ht.add=function(ft,Et){var St,At=this;ft=Number(ft);var Nt=mt.p(Et),It=function(Ft){var Ut=Pt(At);return mt.w(Ut.date(Ut.date()+Math.round(Ft*ft)),At)};if(Nt===Ye)return this.set(Ye,this.$M+ft);if(Nt===ot)return this.set(ot,this.$y+ft);if(Nt===Be)return It(1);if(Nt===Le)return It(7);var Mt=(St={},St[pe]=s,St[me]=a,St[de]=n,St)[Nt]||1,jt=this.$d.getTime()+ft*Mt;return mt.w(jt,this)},ht.subtract=function(ft,Et){return this.add(-1*ft,Et)},ht.format=function(ft){var Et=this,St=this.$locale();if(!this.isValid())return St.invalidDate||nt;var At=ft||"YYYY-MM-DDTHH:mm:ssZ",Nt=mt.z(this),It=this.$H,Mt=this.$m,jt=this.$M,Ft=St.weekdays,Ut=St.months,Ot=St.meridiem,Ht=function(qt,Wt,zt,Gt){return qt&&(qt[Wt]||qt(Et,At))||zt[Wt].slice(0,Gt)},Vt=function(qt){return mt.s(It%12||12,qt,"0")},Dt=Ot||function(qt,Wt,zt){var Gt=qt<12?"AM":"PM";return zt?Gt.toLowerCase():Gt};return At.replace(gt,function(qt,Wt){return Wt||function(zt){switch(zt){case"YY":return String(Et.$y).slice(-2);case"YYYY":return mt.s(Et.$y,4,"0");case"M":return jt+1;case"MM":return mt.s(jt+1,2,"0");case"MMM":return Ht(St.monthsShort,jt,Ut,3);case"MMMM":return Ht(Ut,jt);case"D":return Et.$D;case"DD":return mt.s(Et.$D,2,"0");case"d":return String(Et.$W);case"dd":return Ht(St.weekdaysMin,Et.$W,Ft,2);case"ddd":return Ht(St.weekdaysShort,Et.$W,Ft,3);case"dddd":return Ft[Et.$W];case"H":return String(It);case"HH":return mt.s(It,2,"0");case"h":return Vt(1);case"hh":return Vt(2);case"a":return Dt(It,Mt,!0);case"A":return Dt(It,Mt,!1);case"m":return String(Mt);case"mm":return mt.s(Mt,2,"0");case"s":return String(Et.$s);case"ss":return mt.s(Et.$s,2,"0");case"SSS":return mt.s(Et.$ms,3,"0");case"Z":return Nt}return null}(qt)||Nt.replace(":","")})},ht.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},ht.diff=function(ft,Et,St){var At,Nt=this,It=mt.p(Et),Mt=Pt(ft),jt=(Mt.utcOffset()-this.utcOffset())*s,Ft=this-Mt,Ut=function(){return mt.m(Nt,Mt)};switch(It){case ot:At=Ut()/12;break;case Ye:At=Ut();break;case tt:At=Ut()/3;break;case Le:At=(Ft-jt)/6048e5;break;case Be:At=(Ft-jt)/864e5;break;case me:At=Ft/a;break;case pe:At=Ft/s;break;case de:At=Ft/n;break;default:At=Ft}return St?At:mt.a(At)},ht.daysInMonth=function(){return this.endOf(Ye).$D},ht.$locale=function(){return $t[this.$L]},ht.locale=function(ft,Et){if(!ft)return this.$L;var St=this.clone(),At=Lt(ft,Et,!0);return At&&(St.$L=At),St},ht.clone=function(){return mt.w(this.$d,this)},ht.toDate=function(){return new Date(this.valueOf())},ht.toJSON=function(){return this.isValid()?this.toISOString():null},ht.toISOString=function(){return this.$d.toISOString()},ht.toString=function(){return this.$d.toUTCString()},xt}(),Tt=_t.prototype;return Pt.prototype=Tt,[["$ms",l],["$s",de],["$m",pe],["$H",me],["$W",Be],["$M",Ye],["$y",ot],["$D",yt]].forEach(function(xt){Tt[xt[1]]=function(ht){return this.$g(ht,xt[0],xt[1])}}),Pt.extend=function(xt,ht){return xt.$i||(xt(ht,_t,Pt),xt.$i=!0),Pt},Pt.locale=Lt,Pt.isDayjs=kt,Pt.unix=function(xt){return Pt(1e3*xt)},Pt.en=$t[Bt],Pt.Ls=$t,Pt.p={},Pt})})(dayjs_min);var dayjs_minExports=dayjs_min.exports;const dayjs=getDefaultExportFromCjs(dayjs_minExports);function SearchIcon(){return jsxRuntimeExports.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:jsxRuntimeExports.jsx("path",{d:"M21.71 20.29L18 16.61C19.4401 14.8144 20.1375 12.5353 19.9488 10.2413C19.7601 7.94731 18.6997 5.81279 16.9855 4.27665C15.2714 2.74051 13.0338 1.91951 10.7329 1.98247C8.43207 2.04543 6.24275 2.98757 4.61517 4.61515C2.98759 6.24273 2.04546 8.43204 1.9825 10.7329C1.91954 13.0338 2.74053 15.2714 4.27667 16.9855C5.81281 18.6997 7.94733 19.7601 10.2413 19.9488C12.5353 20.1375 14.8144 19.4401 16.61 18L20.29 21.68C20.383 21.7737 20.4936 21.8481 20.6154 21.8989C20.7373 21.9497 20.868 21.9758 21 21.9758C21.132 21.9758 21.2627 21.9497 21.3846 21.8989C21.5065 21.8481 21.6171 21.7737 21.71 21.68C21.8903 21.4935 21.991 21.2443 21.991 20.985C21.991 20.7257 21.8903 20.4765 21.71 20.29ZM11 18C9.61556 18 8.26218 17.5895 7.11103 16.8203C5.95989 16.0511 5.06268 14.9579 4.53287 13.6788C4.00306 12.3997 3.86443 10.9922 4.13453 9.63437C4.40463 8.2765 5.07131 7.02922 6.05028 6.05026C7.02925 5.07129 8.27653 4.4046 9.63439 4.13451C10.9923 3.86441 12.3997 4.00303 13.6788 4.53285C14.9579 5.06266 16.0511 5.95987 16.8203 7.11101C17.5895 8.26216 18 9.61553 18 11C18 12.8565 17.2625 14.637 15.9498 15.9498C14.637 17.2625 12.8565 18 11 18Z",fill:"#878787"})})}function HeartIcon({isSelected:e=!0}){return jsxRuntimeExports.jsxs("svg",{width:"30",height:"30",viewBox:"0 0 60 60",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[jsxRuntimeExports.jsx("path",{d:"M30 54.095H29.965C23.5075 53.975 4.87503 37.14 4.87503 21.195C4.87503 13.535 11.1875 6.81 18.3825 6.81C24.1075 6.81 27.9575 10.76 29.9975 13.635C32.0325 10.765 35.8825 6.81 41.61 6.81C48.81 6.81 55.12 13.535 55.12 21.1975C55.12 37.1375 36.485 53.9725 30.0275 54.09H30V54.095Z",fill:e?"white":"none"}),jsxRuntimeExports.jsx("path",{d:"M30 54.095H29.965C23.5075 53.975 4.87503 37.14 4.87503 21.195C4.87503 13.535 11.1875 6.81 18.3825 6.81C24.1075 6.81 27.9575 10.76 29.9975 13.635C32.0325 10.765 35.8825 6.81 41.61 6.81C48.81 6.81 55.12 13.535 55.12 21.1975C55.12 37.1375 36.485 53.9725 30.0275 54.09H30V54.095ZM18.385 10.5625C13.185 10.5625 8.62753 15.5325 8.62753 21.2C8.62753 35.55 26.2125 50.19 30.0025 50.345C33.7975 50.19 51.3775 35.5525 51.3775 21.2C51.3775 15.5325 46.82 10.5625 41.62 10.5625C35.3 10.5625 31.77 17.9025 31.74 17.975C31.165 19.38 28.85 19.38 28.2725 17.975C28.2375 17.9 24.7075 10.5625 18.385 10.5625Z",fill:"white",stroke:"white",strokeWidth:"0.520833"})]})}function CopyIcon(){return jsxRuntimeExports.jsxs("svg",{width:"30",height:"30",viewBox:"0 0 60 60",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[jsxRuntimeExports.jsx("path",{d:"M50 22.5H27.5C24.7386 22.5 22.5 24.7386 22.5 27.5V50C22.5 52.7614 24.7386 55 27.5 55H50C52.7614 55 55 52.7614 55 50V27.5C55 24.7386 52.7614 22.5 50 22.5Z",fill:"white",stroke:"white",strokeWidth:"2.08333",strokeLinecap:"round",strokeLinejoin:"round"}),jsxRuntimeExports.jsx("path",{d:"M12.5 37.5H10C8.67392 37.5 7.40215 36.9732 6.46447 36.0355C5.52678 35.0978 5 33.8261 5 32.5V10C5 8.67392 5.52678 7.40215 6.46447 6.46447C7.40215 5.52678 8.67392 5 10 5H32.5C33.8261 5 35.0978 5.52678 36.0355 6.46447C36.9732 7.40215 37.5 8.67392 37.5 10V12.5",stroke:"white",strokeWidth:"2.08333",strokeLinecap:"round",strokeLinejoin:"round"})]})}function DownloadIcon(){return jsxRuntimeExports.jsxs("svg",{width:"30",height:"30",viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[jsxRuntimeExports.jsx("path",{d:"M35 25V31.6667C35 32.5507 34.6488 33.3986 34.0237 34.0237C33.3986 34.6488 32.5507 35 31.6667 35H8.33333C7.44928 35 6.60143 34.6488 5.97631 34.0237C5.35119 33.3986 5 32.5507 5 31.6667V25",stroke:"white",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),jsxRuntimeExports.jsx("path",{d:"M11.6667 16.6667L20 25L28.3333 16.6667",stroke:"white",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),jsxRuntimeExports.jsx("path",{d:"M20 25V5",stroke:"white",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"})]})}function HeartIcon2(){return jsxRuntimeExports.jsx("svg",{width:"25px",height:"25px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:jsxRuntimeExports.jsx("path",{d:"M12 5.881C12.981 4.729 14.484 4 16.05 4C18.822 4 21 6.178 21 8.95C21 12.3492 17.945 15.1195 13.3164 19.3167L13.305 19.327L12 20.515L10.695 19.336L10.6595 19.3037C6.04437 15.1098 3 12.3433 3 8.95C3 6.178 5.178 4 7.95 4C9.516 4 11.019 4.729 12 5.881Z",fill:"#F9595F"})})}function Bitcoin(){return jsxRuntimeExports.jsx("svg",{width:"25",height:"25",viewBox:"0 0 36 36",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:jsxRuntimeExports.jsx("path",{d:"M18 1.5C14.7366 1.5 11.5465 2.46771 8.8331 4.28075C6.11969 6.09379 4.00484 8.67074 2.756 11.6857C1.50715 14.7007 1.18039 18.0183 1.81705 21.219C2.45371 24.4197 4.02518 27.3597 6.33275 29.6673C8.64031 31.9748 11.5803 33.5463 14.781 34.183C17.9817 34.8196 21.2993 34.4929 24.3143 33.244C27.3293 31.9952 29.9062 29.8803 31.7193 27.1669C33.5323 24.4535 34.5 21.2634 34.5 18C34.5 13.6239 32.7616 9.42709 29.6673 6.33274C26.5729 3.23839 22.3761 1.5 18 1.5V1.5ZM18 31.5C15.33 31.5 12.7199 30.7082 10.4998 29.2248C8.27975 27.7414 6.54942 25.633 5.52763 23.1662C4.50585 20.6994 4.23851 17.985 4.75941 15.3663C5.28031 12.7475 6.56606 10.3421 8.45407 8.45406C10.3421 6.56605 12.7475 5.2803 15.3663 4.7594C17.985 4.2385 20.6994 4.50584 23.1662 5.52763C25.633 6.54941 27.7414 8.27974 29.2248 10.4998C30.7082 12.7199 31.5 15.33 31.5 18C31.5 21.5804 30.0777 25.0142 27.5459 27.5459C25.0142 30.0777 21.5804 31.5 18 31.5V31.5ZM21 10.5V9C21 8.60218 20.842 8.22065 20.5607 7.93934C20.2794 7.65804 19.8978 7.5 19.5 7.5C19.1022 7.5 18.7207 7.65804 18.4393 7.93934C18.158 8.22065 18 8.60218 18 9V10.5H16.5V9C16.5 8.60218 16.342 8.22065 16.0607 7.93934C15.7794 7.65804 15.3978 7.5 15 7.5C14.6022 7.5 14.2207 7.65804 13.9393 7.93934C13.658 8.22065 13.5 8.60218 13.5 9V10.5H12C11.6022 10.5 11.2207 10.658 10.9393 10.9393C10.658 11.2206 10.5 11.6022 10.5 12C10.5 12.3978 10.658 12.7794 10.9393 13.0607C11.2207 13.342 11.6022 13.5 12 13.5H13.5V22.5H12C11.6022 22.5 11.2207 22.658 10.9393 22.9393C10.658 23.2206 10.5 23.6022 10.5 24C10.5 24.3978 10.658 24.7794 10.9393 25.0607C11.2207 25.342 11.6022 25.5 12 25.5H13.5V27C13.5 27.3978 13.658 27.7794 13.9393 28.0607C14.2207 28.342 14.6022 28.5 15 28.5C15.3978 28.5 15.7794 28.342 16.0607 28.0607C16.342 27.7794 16.5 27.3978 16.5 27V25.5H18V27C18 27.3978 18.158 27.7794 18.4393 28.0607C18.7207 28.342 19.1022 28.5 19.5 28.5C19.8978 28.5 20.2794 28.342 20.5607 28.0607C20.842 27.7794 21 27.3978 21 27V25.5C22.1935 25.5 23.3381 25.0259 24.182 24.182C25.0259 23.3381 25.5 22.1935 25.5 21C25.4975 19.8919 25.0862 18.8237 24.345 18C25.0862 17.1763 25.4975 16.1081 25.5 15C25.5 13.8065 25.0259 12.6619 24.182 11.818C23.3381 10.9741 22.1935 10.5 21 10.5V10.5ZM21 22.5H16.5V19.5H21C21.3978 19.5 21.7794 19.658 22.0607 19.9393C22.342 20.2206 22.5 20.6022 22.5 21C22.5 21.3978 22.342 21.7794 22.0607 22.0607C21.7794 22.342 21.3978 22.5 21 22.5ZM21 16.5H16.5V13.5H21C21.3978 13.5 21.7794 13.658 22.0607 13.9393C22.342 14.2206 22.5 14.6022 22.5 15C22.5 15.3978 22.342 15.7794 22.0607 16.0607C21.7794 16.342 21.3978 16.5 21 16.5Z",fill:"#FE983B"})})}function VerificationCheck(){return jsxRuntimeExports.jsx("svg",{width:"20",height:"20",viewBox:"0 0 13 12",fill:"#ca077c",xmlns:"http://www.w3.org/2000/svg",children:jsxRuntimeExports.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.50941 0L9.53314 1.94972L11.759 2.29179L11.4059 4.4533L13 6.00021L11.4061 7.54734L11.7585 9.7082L9.53201 10.0503L8.50838 12L6.4994 11.0066L4.49194 11.9996L3.46887 10.0502L1.24134 9.70816L1.59414 7.5473L0 6.00038L1.59392 4.45325L1.24147 2.29239L3.46783 1.94984L4.49111 0.000754215L6.49943 0.993864L8.50941 0ZM4.11667 5.72772L3.25 6.60044L5.41667 8.78226L9.75 4.41863L8.88333 3.5459L5.41667 7.03681L4.11667 5.72772Z",fill:"#ca077c"})})}function Relays(){return jsxRuntimeExports.jsx("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:jsxRuntimeExports.jsx("path",{d:"M14.9999 10.9999H9.99989C9.73467 10.9999 9.48032 11.1053 9.29278 11.2928C9.10525 11.4803 8.99989 11.7347 8.99989 11.9999V19.9999C8.99962 20.1816 9.04884 20.3599 9.14227 20.5157C9.23569 20.6715 9.3698 20.7989 9.53018 20.8842C9.69056 20.9696 9.87116 21.0096 10.0526 21C10.234 20.9904 10.4094 20.9316 10.5599 20.8299L12.4999 19.5299L14.3899 20.7899C14.5644 20.9254 14.7789 20.9992 14.9999 20.9999C15.1523 21.0005 15.3028 20.9663 15.4399 20.8999C15.6082 20.8174 15.7499 20.6893 15.8489 20.5302C15.948 20.3711 16.0003 20.1873 15.9999 19.9999V11.9999C15.9999 11.7347 15.8945 11.4803 15.707 11.2928C15.5195 11.1053 15.2651 10.9999 14.9999 10.9999ZM13.9999 18.1199L13.0599 17.4899C12.8945 17.3781 12.6995 17.3184 12.4999 17.3184C12.3003 17.3184 12.1053 17.3781 11.9399 17.4899L10.9999 18.1299V12.9999H13.9999V18.1199ZM18.4199 7.21989C17.8089 5.8159 16.7544 4.65097 15.418 3.90362C14.0815 3.15627 12.5369 2.86773 11.0209 3.0822C9.50477 3.29668 8.10082 4.00235 7.02415 5.09107C5.94747 6.17979 5.25748 7.59151 5.05989 9.10989C4.10648 9.33822 3.27011 9.90873 2.70963 10.7131C2.14914 11.5174 1.90357 12.4996 2.01955 13.4731C2.13553 14.4466 2.60498 15.3436 3.33876 15.9938C4.07253 16.6439 5.01952 17.002 5.99989 16.9999C6.26511 16.9999 6.51946 16.8945 6.707 16.707C6.89453 16.5195 6.99989 16.2651 6.99989 15.9999C6.99989 15.7347 6.89453 15.4803 6.707 15.2928C6.51946 15.1053 6.26511 14.9999 5.99989 14.9999C5.46946 14.9999 4.96075 14.7892 4.58568 14.4141C4.2106 14.039 3.99989 13.5303 3.99989 12.9999C3.99989 12.4695 4.2106 11.9608 4.58568 11.5857C4.96075 11.2106 5.46946 10.9999 5.99989 10.9999C6.26511 10.9999 6.51946 10.8945 6.707 10.707C6.89453 10.5195 6.99989 10.2651 6.99989 9.99989C7.00244 8.81717 7.42418 7.67365 8.19016 6.77248C8.95614 5.87131 10.0168 5.27085 11.1836 5.07777C12.3505 4.88469 13.548 5.1115 14.5635 5.7179C15.5789 6.32431 16.3465 7.27103 16.7299 8.38989C16.7871 8.56173 16.8898 8.71483 17.0272 8.83283C17.1646 8.95083 17.3314 9.02931 17.5099 9.0599C18.1112 9.16874 18.665 9.45863 19.0971 9.89078C19.5292 10.3229 19.819 10.8767 19.9277 11.4781C20.0364 12.0794 19.9589 12.6997 19.7056 13.2558C19.4522 13.8119 19.035 14.2774 18.5099 14.5899C18.2792 14.7225 18.1105 14.9413 18.0412 15.1983C17.9718 15.4552 18.0073 15.7292 18.1399 15.9599C18.2725 16.1906 18.4913 16.3592 18.7483 16.4286C19.0052 16.498 19.2792 16.4625 19.5099 16.3299C20.2681 15.8898 20.8973 15.2581 21.3343 14.4981C21.7714 13.7381 22.0009 12.8766 21.9999 11.9999C21.9969 10.924 21.6469 9.87783 21.0019 9.0167C20.357 8.15557 19.4515 7.52544 18.4199 7.21989Z",fill:"#FFF"})})}function Close(){return jsxRuntimeExports.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:jsxRuntimeExports.jsx("path",{d:"M13.41 12L17.71 7.71C17.8983 7.5217 18.0041 7.2663 18.0041 7C18.0041 6.7337 17.8983 6.47831 17.71 6.29C17.5217 6.1017 17.2663 5.99591 17 5.99591C16.7337 5.99591 16.4783 6.1017 16.29 6.29L12 10.59L7.71 6.29C7.5217 6.1017 7.2663 5.99591 7 5.99591C6.7337 5.99591 6.4783 6.1017 6.29 6.29C6.1017 6.47831 5.99591 6.7337 5.99591 7C5.99591 7.2663 6.1017 7.5217 6.29 7.71L10.59 12L6.29 16.29C6.19627 16.383 6.12188 16.4936 6.07111 16.6154C6.02034 16.7373 5.9942 16.868 5.9942 17C5.9942 17.132 6.02034 17.2627 6.07111 17.3846C6.12188 17.5064 6.19627 17.617 6.29 17.71C6.38296 17.8037 6.49356 17.8781 6.61542 17.9289C6.73728 17.9797 6.86799 18.0058 7 18.0058C7.13201 18.0058 7.26272 17.9797 7.38458 17.9289C7.50644 17.8781 7.61704 17.8037 7.71 17.71L12 13.41L16.29 17.71C16.383 17.8037 16.4936 17.8781 16.6154 17.9289C16.7373 17.9797 16.868 18.0058 17 18.0058C17.132 18.0058 17.2627 17.9797 17.3846 17.9289C17.5064 17.8781 17.617 17.8037 17.71 17.71C17.8037 17.617 17.8781 17.5064 17.9289 17.3846C17.9797 17.2627 18.0058 17.132 18.0058 17C18.0058 16.868 17.9797 16.7373 17.9289 16.6154C17.8781 16.4936 17.8037 16.383 17.71 16.29L13.41 12Z",fill:"#848484"})})}function Delete(){return jsxRuntimeExports.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:jsxRuntimeExports.jsx("path",{d:"M10 18C10.2652 18 10.5196 17.8946 10.7071 17.7071C10.8946 17.5196 11 17.2652 11 17V11C11 10.7348 10.8946 10.4804 10.7071 10.2929C10.5196 10.1054 10.2652 10 10 10C9.73478 10 9.48043 10.1054 9.29289 10.2929C9.10536 10.4804 9 10.7348 9 11V17C9 17.2652 9.10536 17.5196 9.29289 17.7071C9.48043 17.8946 9.73478 18 10 18ZM20 6H16V5C16 4.20435 15.6839 3.44129 15.1213 2.87868C14.5587 2.31607 13.7956 2 13 2H11C10.2044 2 9.44129 2.31607 8.87868 2.87868C8.31607 3.44129 8 4.20435 8 5V6H4C3.73478 6 3.48043 6.10536 3.29289 6.29289C3.10536 6.48043 3 6.73478 3 7C3 7.26522 3.10536 7.51957 3.29289 7.70711C3.48043 7.89464 3.73478 8 4 8H5V19C5 19.7956 5.31607 20.5587 5.87868 21.1213C6.44129 21.6839 7.20435 22 8 22H16C16.7956 22 17.5587 21.6839 18.1213 21.1213C18.6839 20.5587 19 19.7956 19 19V8H20C20.2652 8 20.5196 7.89464 20.7071 7.70711C20.8946 7.51957 21 7.26522 21 7C21 6.73478 20.8946 6.48043 20.7071 6.29289C20.5196 6.10536 20.2652 6 20 6ZM10 5C10 4.73478 10.1054 4.48043 10.2929 4.29289C10.4804 4.10536 10.7348 4 11 4H13C13.2652 4 13.5196 4.10536 13.7071 4.29289C13.8946 4.48043 14 4.73478 14 5V6H10V5ZM17 19C17 19.2652 16.8946 19.5196 16.7071 19.7071C16.5196 19.8946 16.2652 20 16 20H8C7.73478 20 7.48043 19.8946 7.29289 19.7071C7.10536 19.5196 7 19.2652 7 19V8H17V19ZM14 18C14.2652 18 14.5196 17.8946 14.7071 17.7071C14.8946 17.5196 15 17.2652 15 17V11C15 10.7348 14.8946 10.4804 14.7071 10.2929C14.5196 10.1054 14.2652 10 14 10C13.7348 10 13.4804 10.1054 13.2929 10.2929C13.1054 10.4804 13 10.7348 13 11V17C13 17.2652 13.1054 17.5196 13.2929 17.7071C13.4804 17.8946 13.7348 18 14 18Z",fill:"#FE3B3B"})})}function Plus(){return jsxRuntimeExports.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:jsxRuntimeExports.jsx("path",{d:"M19 11H13V5C13 4.73478 12.8946 4.48043 12.7071 4.29289C12.5196 4.10536 12.2652 4 12 4C11.7348 4 11.4804 4.10536 11.2929 4.29289C11.1054 4.48043 11 4.73478 11 5V11H5C4.73478 11 4.48043 11.1054 4.29289 11.2929C4.10536 11.4804 4 11.7348 4 12C4 12.2652 4.10536 12.5196 4.29289 12.7071C4.48043 12.8946 4.73478 13 5 13H11V19C11 19.2652 11.1054 19.5196 11.2929 19.7071C11.4804 19.8946 11.7348 20 12 20C12.2652 20 12.5196 19.8946 12.7071 19.7071C12.8946 19.5196 13 19.2652 13 19V13H19C19.2652 13 19.5196 12.8946 19.7071 12.7071C19.8946 12.5196 20 12.2652 20 12C20 11.7348 19.8946 11.4804 19.7071 11.2929C19.5196 11.1054 19.2652 11 19 11Z",fill:"#FFFFFF"})})}function QuestionMark(){return jsxRuntimeExports.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:jsxRuntimeExports.jsx("path",{d:"M9.4083 12.7417C9.37246 12.7813 9.33906 12.823 9.3083 12.8667C9.27676 12.9131 9.25154 12.9636 9.2333 13.0167C9.20927 13.0639 9.19242 13.1145 9.1833 13.1667C9.17921 13.2222 9.17921 13.2779 9.1833 13.3333C9.18048 13.4427 9.20331 13.5511 9.24996 13.65C9.28739 13.7534 9.3471 13.8473 9.42487 13.9251C9.50263 14.0029 9.59655 14.0626 9.69996 14.1C9.79971 14.1441 9.90757 14.1669 10.0166 14.1669C10.1257 14.1669 10.2335 14.1441 10.3333 14.1C10.4367 14.0626 10.5306 14.0029 10.6084 13.9251C10.6862 13.8473 10.7459 13.7534 10.7833 13.65C10.8203 13.5487 10.8373 13.4411 10.8333 13.3333C10.8339 13.2237 10.8129 13.1149 10.7714 13.0134C10.73 12.9119 10.6689 12.8195 10.5916 12.7417C10.5142 12.6636 10.422 12.6016 10.3204 12.5593C10.2189 12.517 10.11 12.4952 9.99996 12.4952C9.88995 12.4952 9.78103 12.517 9.67948 12.5593C9.57793 12.6016 9.48576 12.6636 9.4083 12.7417ZM9.99996 1.66667C8.35179 1.66667 6.74062 2.15541 5.37021 3.07109C3.9998 3.98677 2.9317 5.28826 2.30097 6.81098C1.67024 8.33369 1.50521 10.0092 1.82675 11.6258C2.1483 13.2423 2.94197 14.7271 4.10741 15.8926C5.27284 17.058 6.7577 17.8517 8.37421 18.1732C9.99072 18.4948 11.6663 18.3297 13.189 17.699C14.7117 17.0683 16.0132 16.0002 16.9289 14.6298C17.8446 13.2593 18.3333 11.6482 18.3333 10C18.3333 8.90566 18.1177 7.82202 17.699 6.81098C17.2802 5.79993 16.6663 4.88127 15.8925 4.10745C15.1187 3.33363 14.2 2.7198 13.189 2.30101C12.1779 1.88222 11.0943 1.66667 9.99996 1.66667ZM9.99996 16.6667C8.68142 16.6667 7.39249 16.2757 6.29616 15.5431C5.19983 14.8106 4.34535 13.7694 3.84077 12.5512C3.33618 11.3331 3.20416 9.99261 3.46139 8.6994C3.71863 7.4062 4.35357 6.21831 5.28592 5.28596C6.21827 4.35361 7.40615 3.71867 8.69936 3.46144C9.99257 3.2042 11.333 3.33622 12.5512 3.84081C13.7694 4.34539 14.8105 5.19988 15.5431 6.2962C16.2756 7.39253 16.6666 8.68146 16.6666 10C16.6666 11.7681 15.9642 13.4638 14.714 14.714C13.4638 15.9643 11.7681 16.6667 9.99996 16.6667ZM9.99996 5.83334C9.56085 5.83306 9.12941 5.94844 8.74905 6.16787C8.3687 6.38731 8.05285 6.70305 7.8333 7.08334C7.773 7.17819 7.73252 7.28425 7.71427 7.39515C7.69603 7.50605 7.70041 7.6195 7.72715 7.72866C7.75389 7.83782 7.80244 7.94045 7.86987 8.03037C7.9373 8.12028 8.02222 8.19563 8.11952 8.25187C8.21683 8.30812 8.3245 8.3441 8.43607 8.35765C8.54764 8.37121 8.6608 8.36205 8.76874 8.33074C8.87668 8.29942 8.97717 8.2466 9.06417 8.17544C9.15116 8.10428 9.22287 8.01626 9.27496 7.91667C9.34838 7.7895 9.4541 7.68399 9.58142 7.61082C9.70873 7.53765 9.85312 7.49942 9.99996 7.5C10.221 7.5 10.4329 7.5878 10.5892 7.74408C10.7455 7.90036 10.8333 8.11232 10.8333 8.33334C10.8333 8.55435 10.7455 8.76631 10.5892 8.92259C10.4329 9.07887 10.221 9.16667 9.99996 9.16667C9.77895 9.16667 9.56699 9.25447 9.41071 9.41075C9.25443 9.56703 9.16663 9.77899 9.16663 10V10.8333C9.16663 11.0544 9.25443 11.2663 9.41071 11.4226C9.56699 11.5789 9.77895 11.6667 9.99996 11.6667C10.221 11.6667 10.4329 11.5789 10.5892 11.4226C10.7455 11.2663 10.8333 11.0544 10.8333 10.8333V10.6833C11.3844 10.4834 11.8478 10.096 12.1423 9.58906C12.4368 9.0821 12.5437 8.48775 12.4445 7.90991C12.3452 7.33208 12.046 6.80752 11.5991 6.42793C11.1523 6.04835 10.5862 5.83789 9.99996 5.83334Z",fill:"#4C9EFF"})})}function Mail(){return jsxRuntimeExports.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:jsxRuntimeExports.jsx("path",{d:"M11.6666 9.59165H13.6833C13.793 9.59229 13.9017 9.57127 14.0032 9.5298C14.1047 9.48833 14.1971 9.42722 14.275 9.34999L18.0916 5.53332C18.1697 5.45585 18.2317 5.36368 18.274 5.26214C18.3163 5.16059 18.3381 5.05166 18.3381 4.94165C18.3381 4.83164 18.3163 4.72272 18.274 4.62117C18.2317 4.51962 18.1697 4.42746 18.0916 4.34999L16.075 2.33332C15.9975 2.25521 15.9053 2.19322 15.8038 2.15091C15.7022 2.1086 15.5933 2.08682 15.4833 2.08682C15.3733 2.08682 15.2644 2.1086 15.1628 2.15091C15.0613 2.19322 14.9691 2.25521 14.8916 2.33332L11.075 6.14999C10.9227 6.30968 10.8364 6.52102 10.8333 6.74165V8.75832C10.8333 8.97933 10.9211 9.1913 11.0774 9.34758C11.2337 9.50386 11.4456 9.59165 11.6666 9.59165ZM12.5 7.09165L15.4833 4.10832L16.3166 4.94165L13.3333 7.92499H12.5V7.09165ZM17.5 8.75832C17.2789 8.75832 17.067 8.84612 16.9107 9.0024C16.7544 9.15868 16.6666 9.37064 16.6666 9.59165V15.425C16.6666 15.646 16.5788 15.858 16.4225 16.0142C16.2663 16.1705 16.0543 16.2583 15.8333 16.2583H4.16663C3.94561 16.2583 3.73365 16.1705 3.57737 16.0142C3.42109 15.858 3.33329 15.646 3.33329 15.425V7.41665L8.23329 12.325C8.46585 12.5606 8.74287 12.7476 9.04829 12.8753C9.3537 13.003 9.68143 13.0687 10.0125 13.0687C10.3435 13.0687 10.6712 13.003 10.9766 12.8753C11.2821 12.7476 11.5591 12.5606 11.7916 12.325C11.9443 12.1692 12.0298 11.9598 12.0298 11.7417C12.0298 11.5235 11.9443 11.3141 11.7916 11.1583C11.714 11.0789 11.6213 11.0159 11.519 10.9728C11.4167 10.9298 11.3068 10.9076 11.1958 10.9076C11.0848 10.9076 10.9749 10.9298 10.8726 10.9728C10.7703 11.0159 10.6776 11.0789 10.6 11.1583C10.4442 11.311 10.2348 11.3965 10.0166 11.3965C9.7985 11.3965 9.58907 11.311 9.43329 11.1583L4.50829 6.24165H8.33329C8.55431 6.24165 8.76627 6.15386 8.92255 5.99758C9.07883 5.8413 9.16663 5.62933 9.16663 5.40832C9.16663 5.18731 9.07883 4.97535 8.92255 4.81907C8.76627 4.66279 8.55431 4.57499 8.33329 4.57499H4.16663C3.50358 4.57499 2.8677 4.83838 2.39886 5.30722C1.93002 5.77606 1.66663 6.41195 1.66663 7.07499V15.4083C1.66663 16.0714 1.93002 16.7072 2.39886 17.1761C2.8677 17.6449 3.50358 17.9083 4.16663 17.9083H15.8333C16.4963 17.9083 17.1322 17.6449 17.6011 17.1761C18.0699 16.7072 18.3333 16.0714 18.3333 15.4083V9.57499C18.3333 9.35397 18.2455 9.14201 18.0892 8.98573C17.9329 8.82945 17.721 8.74165 17.5 8.74165V8.75832Z",fill:"#CE66FF"})})}function Github(){return jsxRuntimeExports.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:jsxRuntimeExports.jsx("path",{d:"M12 2.2467C9.6255 2.2468 7.32849 3.09182 5.51999 4.63055C3.71149 6.16929 2.50953 8.30133 2.12916 10.6452C1.74879 12.989 2.21485 15.3918 3.44393 17.4235C4.67301 19.4551 6.58491 20.9832 8.83755 21.7342C9.33755 21.8217 9.52505 21.5217 9.52505 21.2592C9.52505 21.0217 9.51254 20.2342 9.51254 19.3967C7.00003 19.8592 6.35003 18.7842 6.15003 18.2217C5.9281 17.6747 5.5763 17.1899 5.12503 16.8092C4.77503 16.6217 4.27503 16.1592 5.11252 16.1467C5.4323 16.1814 5.73901 16.2927 6.00666 16.4711C6.2743 16.6495 6.49499 16.8899 6.65003 17.1717C6.7868 17.4174 6.97071 17.6337 7.19122 17.8082C7.41173 17.9827 7.6645 18.112 7.93506 18.1886C8.20562 18.2652 8.48864 18.2877 8.76791 18.2548C9.04717 18.2219 9.3172 18.1342 9.56251 17.9967C9.6058 17.4883 9.83237 17.013 10.2 16.6592C7.97503 16.4092 5.65003 15.5467 5.65003 11.7217C5.63597 10.7279 6.00271 9.76631 6.67503 9.03423C6.36931 8.17045 6.40508 7.22252 6.77503 6.38423C6.77503 6.38423 7.6125 6.12172 9.52503 7.40923C11.1613 6.95921 12.8887 6.95921 14.525 7.40923C16.4375 6.10923 17.275 6.38423 17.275 6.38423C17.645 7.22251 17.6808 8.17046 17.375 9.03423C18.0494 9.76506 18.4164 10.7275 18.4 11.7217C18.4 15.5592 16.0625 16.4092 13.8375 16.6592C14.0762 16.9011 14.26 17.1915 14.3764 17.5107C14.4929 17.83 14.5393 18.1705 14.5125 18.5092C14.5125 19.8468 14.5 20.9217 14.5 21.2592C14.5 21.5217 14.6875 21.8342 15.1875 21.7342C17.4362 20.9771 19.3426 19.4455 20.5664 17.4128C21.7903 15.38 22.2519 12.9785 21.8689 10.6369C21.4859 8.29535 20.2832 6.16608 18.4755 4.62922C16.6678 3.09235 14.3727 2.24794 12 2.2467Z",fill:"#FFF"})})}function NostrichHead({fill:e}){return jsxRuntimeExports.jsx("svg",{width:"24",height:"24",viewBox:"0 0 56 56",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:jsxRuntimeExports.jsx("path",{d:"M56 24.4076V53.9817C56 55.0939 55.1041 55.9964 54.0001 55.9964H30.0016C28.8977 55.9964 28.0018 55.0939 28.0018 53.9817V48.4741C28.1111 41.7228 28.8201 35.2558 30.3085 32.3137C31.2009 30.5442 32.6717 29.5812 34.3612 29.066C37.5532 28.0995 43.1543 28.7604 45.5315 28.6467C45.5315 28.6467 52.7127 28.9345 52.7127 24.8376C52.7127 21.5401 49.5031 21.7995 49.5031 21.7995C45.9654 21.8919 43.2706 21.6503 41.5247 20.9574C38.6007 19.799 38.502 17.6741 38.4914 16.9635C38.3468 8.75533 26.3334 7.77107 15.7486 9.80711C4.1761 12.0244 15.8755 28.7355 15.8755 51.0431V54.0208C15.8544 55.1152 14.9761 56 13.8827 56H1.99987C0.895887 56 0 55.0975 0 53.9853V2.83553C0 1.72335 0.895887 0.820813 1.99987 0.820813H13.1702C14.2742 0.820813 15.1701 1.72335 15.1701 2.83553C15.1701 4.48782 17.0148 5.40812 18.3481 4.44518C22.3654 1.54569 27.5221 0 33.2924 0C46.2193 0 55.993 7.58985 55.993 24.4076H56ZM34.541 18.4061C34.541 16.0254 32.6258 14.0959 30.2626 14.0959C27.8995 14.0959 25.9843 16.0254 25.9843 18.4061C25.9843 20.7868 27.8995 22.7162 30.2626 22.7162C32.6258 22.7162 34.541 20.7868 34.541 18.4061Z",fill:e})})}var __assign=function(){return __assign=Object.assign||function(t){for(var n,s=1,a=arguments.length;s<a;s++){n=arguments[s];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(t[l]=n[l])}return t},__assign.apply(this,arguments)};function __spreadArray$2(e,t,n){if(n||arguments.length===2)for(var s=0,a=t.length,l;s<a;s++)(l||!(s in t))&&(l||(l=Array.prototype.slice.call(t,0,s)),l[s]=t[s]);return e.concat(l||Array.prototype.slice.call(t))}typeof SuppressedError=="function"&&SuppressedError;var MS="-ms-",MOZ="-moz-",WEBKIT="-webkit-",COMMENT="comm",RULESET="rule",DECLARATION="decl",IMPORT="@import",KEYFRAMES="@keyframes",LAYER="@layer",abs=Math.abs,from=String.fromCharCode,assign=Object.assign;function hash$2(e,t){return charat(e,0)^45?(((t<<2^charat(e,0))<<2^charat(e,1))<<2^charat(e,2))<<2^charat(e,3):0}function trim(e){return e.trim()}function match(e,t){return(e=t.exec(e))?e[0]:e}function replace(e,t,n){return e.replace(t,n)}function indexof(e,t,n){return e.indexOf(t,n)}function charat(e,t){return e.charCodeAt(t)|0}function substr(e,t,n){return e.slice(t,n)}function strlen(e){return e.length}function sizeof(e){return e.length}function append(e,t){return t.push(e),e}function combine(e,t){return e.map(t).join("")}function filter(e,t){return e.filter(function(n){return!match(n,t)})}var line=1,column=1,length=0,position=0,character=0,characters="";function node(e,t,n,s,a,l,de,pe){return{value:e,root:t,parent:n,type:s,props:a,children:l,line,column,length:de,return:"",siblings:pe}}function copy(e,t){return assign(node("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},t)}function lift(e){for(;e.root;)e=copy(e.root,{children:[e]});append(e,e.siblings)}function char(){return character}function prev(){return character=position>0?charat(characters,--position):0,column--,character===10&&(column=1,line--),character}function next(){return character=position<length?charat(characters,position++):0,column++,character===10&&(column=1,line++),character}function peek(){return charat(characters,position)}function caret(){return position}function slice(e,t){return substr(characters,e,t)}function token(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function alloc(e){return line=column=1,length=strlen(characters=e),position=0,[]}function dealloc(e){return characters="",e}function delimit(e){return trim(slice(position-1,delimiter(e===91?e+2:e===40?e+1:e)))}function whitespace(e){for(;(character=peek())&&character<33;)next();return token(e)>2||token(character)>3?"":" "}function escaping(e,t){for(;--t&&next()&&!(character<48||character>102||character>57&&character<65||character>70&&character<97););return slice(e,caret()+(t<6&&peek()==32&&next()==32))}function delimiter(e){for(;next();)switch(character){case e:return position;case 34:case 39:e!==34&&e!==39&&delimiter(character);break;case 40:e===41&&delimiter(e);break;case 92:next();break}return position}function commenter(e,t){for(;next()&&e+character!==57;)if(e+character===84&&peek()===47)break;return"/*"+slice(t,position-1)+"*"+from(e===47?e:next())}function identifier(e){for(;!token(peek());)next();return slice(e,position)}function compile(e){return dealloc(parse$1("",null,null,null,[""],e=alloc(e),0,[0],e))}function parse$1(e,t,n,s,a,l,de,pe,me){for(var Be=0,Le=0,Ye=de,tt=0,ot=0,yt=0,nt=1,st=1,gt=1,wt=0,vt="",Rt=a,Bt=l,$t=s,Ct=vt;st;)switch(yt=wt,wt=next()){case 40:if(yt!=108&&charat(Ct,Ye-1)==58){indexof(Ct+=replace(delimit(wt),"&","&\f"),"&\f",abs(Be?pe[Be-1]:0))!=-1&&(gt=-1);break}case 34:case 39:case 91:Ct+=delimit(wt);break;case 9:case 10:case 13:case 32:Ct+=whitespace(yt);break;case 92:Ct+=escaping(caret()-1,7);continue;case 47:switch(peek()){case 42:case 47:append(comment(commenter(next(),caret()),t,n,me),me);break;default:Ct+="/"}break;case 123*nt:pe[Be++]=strlen(Ct)*gt;case 125*nt:case 59:case 0:switch(wt){case 0:case 125:st=0;case 59+Le:gt==-1&&(Ct=replace(Ct,/\f/g,"")),ot>0&&strlen(Ct)-Ye&&append(ot>32?declaration(Ct+";",s,n,Ye-1,me):declaration(replace(Ct," ","")+";",s,n,Ye-2,me),me);break;case 59:Ct+=";";default:if(append($t=ruleset(Ct,t,n,Be,Le,a,pe,vt,Rt=[],Bt=[],Ye,l),l),wt===123)if(Le===0)parse$1(Ct,t,$t,$t,Rt,l,Ye,pe,Bt);else switch(tt===99&&charat(Ct,3)===110?100:tt){case 100:case 108:case 109:case 115:parse$1(e,$t,$t,s&&append(ruleset(e,$t,$t,0,0,a,pe,vt,a,Rt=[],Ye,Bt),Bt),a,Bt,Ye,pe,s?Rt:Bt);break;default:parse$1(Ct,$t,$t,$t,[""],Bt,0,pe,Bt)}}Be=Le=ot=0,nt=gt=1,vt=Ct="",Ye=de;break;case 58:Ye=1+strlen(Ct),ot=yt;default:if(nt<1){if(wt==123)--nt;else if(wt==125&&nt++==0&&prev()==125)continue}switch(Ct+=from(wt),wt*nt){case 38:gt=Le>0?1:(Ct+="\f",-1);break;case 44:pe[Be++]=(strlen(Ct)-1)*gt,gt=1;break;case 64:peek()===45&&(Ct+=delimit(next())),tt=peek(),Le=Ye=strlen(vt=Ct+=identifier(caret())),wt++;break;case 45:yt===45&&strlen(Ct)==2&&(nt=0)}}return l}function ruleset(e,t,n,s,a,l,de,pe,me,Be,Le,Ye){for(var tt=a-1,ot=a===0?l:[""],yt=sizeof(ot),nt=0,st=0,gt=0;nt<s;++nt)for(var wt=0,vt=substr(e,tt+1,tt=abs(st=de[nt])),Rt=e;wt<yt;++wt)(Rt=trim(st>0?ot[wt]+" "+vt:replace(vt,/&\f/g,ot[wt])))&&(me[gt++]=Rt);return node(e,t,n,a===0?RULESET:pe,me,Be,Le,Ye)}function comment(e,t,n,s){return node(e,t,n,COMMENT,from(char()),substr(e,2,-2),0,s)}function declaration(e,t,n,s,a){return node(e,t,n,DECLARATION,substr(e,0,s),substr(e,s+1,-1),s,a)}function prefix(e,t,n){switch(hash$2(e,t)){case 5103:return WEBKIT+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return WEBKIT+e+e;case 4789:return MOZ+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return WEBKIT+e+MOZ+e+MS+e+e;case 5936:switch(charat(e,t+11)){case 114:return WEBKIT+e+MS+replace(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return WEBKIT+e+MS+replace(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return WEBKIT+e+MS+replace(e,/[svh]\w+-[tblr]{2}/,"lr")+e}case 6828:case 4268:case 2903:return WEBKIT+e+MS+e+e;case 6165:return WEBKIT+e+MS+"flex-"+e+e;case 5187:return WEBKIT+e+replace(e,/(\w+).+(:[^]+)/,WEBKIT+"box-$1$2"+MS+"flex-$1$2")+e;case 5443:return WEBKIT+e+MS+"flex-item-"+replace(e,/flex-|-self/g,"")+(match(e,/flex-|baseline/)?"":MS+"grid-row-"+replace(e,/flex-|-self/g,""))+e;case 4675:return WEBKIT+e+MS+"flex-line-pack"+replace(e,/align-content|flex-|-self/g,"")+e;case 5548:return WEBKIT+e+MS+replace(e,"shrink","negative")+e;case 5292:return WEBKIT+e+MS+replace(e,"basis","preferred-size")+e;case 6060:return WEBKIT+"box-"+replace(e,"-grow","")+WEBKIT+e+MS+replace(e,"grow","positive")+e;case 4554:return WEBKIT+replace(e,/([^-])(transform)/g,"$1"+WEBKIT+"$2")+e;case 6187:return replace(replace(replace(e,/(zoom-|grab)/,WEBKIT+"$1"),/(image-set)/,WEBKIT+"$1"),e,"")+e;case 5495:case 3959:return replace(e,/(image-set\([^]*)/,WEBKIT+"$1$`$1");case 4968:return replace(replace(e,/(.+:)(flex-)?(.*)/,WEBKIT+"box-pack:$3"+MS+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+WEBKIT+e+e;case 4200:if(!match(e,/flex-|baseline/))return MS+"grid-column-align"+substr(e,t)+e;break;case 2592:case 3360:return MS+replace(e,"template-","")+e;case 4384:case 3616:return n&&n.some(function(s,a){return t=a,match(s.props,/grid-\w+-end/)})?~indexof(e+(n=n[t].value),"span",0)?e:MS+replace(e,"-start","")+e+MS+"grid-row-span:"+(~indexof(n,"span",0)?match(n,/\d+/):+match(n,/\d+/)-+match(e,/\d+/))+";":MS+replace(e,"-start","")+e;case 4896:case 4128:return n&&n.some(function(s){return match(s.props,/grid-\w+-start/)})?e:MS+replace(replace(e,"-end","-span"),"span ","")+e;case 4095:case 3583:case 4068:case 2532:return replace(e,/(.+)-inline(.+)/,WEBKIT+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(strlen(e)-1-t>6)switch(charat(e,t+1)){case 109:if(charat(e,t+4)!==45)break;case 102:return replace(e,/(.+:)(.+)-([^]+)/,"$1"+WEBKIT+"$2-$3$1"+MOZ+(charat(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~indexof(e,"stretch",0)?prefix(replace(e,"stretch","fill-available"),t,n)+e:e}break;case 5152:case 5920:return replace(e,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(s,a,l,de,pe,me,Be){return MS+a+":"+l+Be+(de?MS+a+"-span:"+(pe?me:+me-+l)+Be:"")+e});case 4949:if(charat(e,t+6)===121)return replace(e,":",":"+WEBKIT)+e;break;case 6444:switch(charat(e,charat(e,14)===45?18:11)){case 120:return replace(e,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+WEBKIT+(charat(e,14)===45?"inline-":"")+"box$3$1"+WEBKIT+"$2$3$1"+MS+"$2box$3")+e;case 100:return replace(e,":",":"+MS)+e}break;case 5719:case 2647:case 2135:case 3927:case 2391:return replace(e,"scroll-","scroll-snap-")+e}return e}function serialize$1(e,t){for(var n="",s=0;s<e.length;s++)n+=t(e[s],s,e,t)||"";return n}function stringify(e,t,n,s){switch(e.type){case LAYER:if(e.children.length)break;case IMPORT:case DECLARATION:return e.return=e.return||e.value;case COMMENT:return"";case KEYFRAMES:return e.return=e.value+"{"+serialize$1(e.children,s)+"}";case RULESET:if(!strlen(e.value=e.props.join(",")))return""}return strlen(n=serialize$1(e.children,s))?e.return=e.value+"{"+n+"}":""}function middleware(e){var t=sizeof(e);return function(n,s,a,l){for(var de="",pe=0;pe<t;pe++)de+=e[pe](n,s,a,l)||"";return de}}function rulesheet(e){return function(t){t.root||(t=t.return)&&e(t)}}function prefixer(e,t,n,s){if(e.length>-1&&!e.return)switch(e.type){case DECLARATION:e.return=prefix(e.value,e.length,n);return;case KEYFRAMES:return serialize$1([copy(e,{value:replace(e.value,"@","@"+WEBKIT)})],s);case RULESET:if(e.length)return combine(n=e.props,function(a){switch(match(a,s=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":lift(copy(e,{props:[replace(a,/:(read-\w+)/,":"+MOZ+"$1")]})),lift(copy(e,{props:[a]})),assign(e,{props:filter(n,s)});break;case"::placeholder":lift(copy(e,{props:[replace(a,/:(plac\w+)/,":"+WEBKIT+"input-$1")]})),lift(copy(e,{props:[replace(a,/:(plac\w+)/,":"+MOZ+"$1")]})),lift(copy(e,{props:[replace(a,/:(plac\w+)/,MS+"input-$1")]})),lift(copy(e,{props:[a]})),assign(e,{props:filter(n,s)});break}return""})}}var unitlessKeys={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},define_process_env_default={},f=typeof process<"u"&&define_process_env_default!==void 0&&(define_process_env_default.REACT_APP_SC_ATTR||define_process_env_default.SC_ATTR)||"data-styled",m="active",y="data-styled-version",v="6.1.13",g=`/*!sc*/
`,S=typeof window<"u"&&"HTMLElement"in window,w=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&define_process_env_default!==void 0&&define_process_env_default.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&define_process_env_default.REACT_APP_SC_DISABLE_SPEEDY!==""?define_process_env_default.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&define_process_env_default.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&define_process_env_default!==void 0&&define_process_env_default.SC_DISABLE_SPEEDY!==void 0&&define_process_env_default.SC_DISABLE_SPEEDY!==""&&define_process_env_default.SC_DISABLE_SPEEDY!=="false"&&define_process_env_default.SC_DISABLE_SPEEDY),_=Object.freeze([]),C=Object.freeze({});function I(e,t,n){return n===void 0&&(n=C),e.theme!==n.theme&&e.theme||t||n.theme}var A=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),O=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,D=/(^-|-$)/g;function R(e){return e.replace(O,"-").replace(D,"")}var T=/(a)(d)/gi,k=52,j=function(e){return String.fromCharCode(e+(e>25?39:97))};function x(e){var t,n="";for(t=Math.abs(e);t>k;t=t/k|0)n=j(t%k)+n;return(j(t%k)+n).replace(T,"$1-$2")}var V,F=5381,M=function(e,t){for(var n=t.length;n;)e=33*e^t.charCodeAt(--n);return e},z=function(e){return M(F,e)};function $(e){return x(z(e)>>>0)}function B(e){return e.displayName||e.name||"Component"}function L(e){return typeof e=="string"&&!0}var G=typeof Symbol=="function"&&Symbol.for,Y=G?Symbol.for("react.memo"):60115,W=G?Symbol.for("react.forward_ref"):60112,q={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},H={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},U={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},J=((V={})[W]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},V[Y]=U,V);function X(e){return("type"in(t=e)&&t.type.$$typeof)===Y?U:"$$typeof"in e?J[e.$$typeof]:q;var t}var Z=Object.defineProperty,K=Object.getOwnPropertyNames,Q=Object.getOwnPropertySymbols,ee$1=Object.getOwnPropertyDescriptor,te=Object.getPrototypeOf,ne=Object.prototype;function oe(e,t,n){if(typeof t!="string"){if(ne){var s=te(t);s&&s!==ne&&oe(e,s,n)}var a=K(t);Q&&(a=a.concat(Q(t)));for(var l=X(e),de=X(t),pe=0;pe<a.length;++pe){var me=a[pe];if(!(me in H||n&&n[me]||de&&me in de||l&&me in l)){var Be=ee$1(t,me);try{Z(e,me,Be)}catch{}}}}return e}function re(e){return typeof e=="function"}function se(e){return typeof e=="object"&&"styledComponentId"in e}function ie(e,t){return e&&t?"".concat(e," ").concat(t):e||t||""}function ae(e,t){if(e.length===0)return"";for(var n=e[0],s=1;s<e.length;s++)n+=e[s];return n}function ce(e){return e!==null&&typeof e=="object"&&e.constructor.name===Object.name&&!("props"in e&&e.$$typeof)}function le(e,t,n){if(n===void 0&&(n=!1),!n&&!ce(e)&&!Array.isArray(e))return t;if(Array.isArray(t))for(var s=0;s<t.length;s++)e[s]=le(e[s],t[s]);else if(ce(t))for(var s in t)e[s]=le(e[s],t[s]);return e}function ue(e,t){Object.defineProperty(e,"toString",{value:t})}function he(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(e," for more information.").concat(t.length>0?" Args: ".concat(t.join(", ")):""))}var fe$1=function(){function e(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}return e.prototype.indexOfGroup=function(t){for(var n=0,s=0;s<t;s++)n+=this.groupSizes[s];return n},e.prototype.insertRules=function(t,n){if(t>=this.groupSizes.length){for(var s=this.groupSizes,a=s.length,l=a;t>=l;)if((l<<=1)<0)throw he(16,"".concat(t));this.groupSizes=new Uint32Array(l),this.groupSizes.set(s),this.length=l;for(var de=a;de<l;de++)this.groupSizes[de]=0}for(var pe=this.indexOfGroup(t+1),me=(de=0,n.length);de<me;de++)this.tag.insertRule(pe,n[de])&&(this.groupSizes[t]++,pe++)},e.prototype.clearGroup=function(t){if(t<this.length){var n=this.groupSizes[t],s=this.indexOfGroup(t),a=s+n;this.groupSizes[t]=0;for(var l=s;l<a;l++)this.tag.deleteRule(s)}},e.prototype.getGroup=function(t){var n="";if(t>=this.length||this.groupSizes[t]===0)return n;for(var s=this.groupSizes[t],a=this.indexOfGroup(t),l=a+s,de=a;de<l;de++)n+="".concat(this.tag.getRule(de)).concat(g);return n},e}(),ye=new Map,ve=new Map,ge$1=1,Se=function(e){if(ye.has(e))return ye.get(e);for(;ve.has(ge$1);)ge$1++;var t=ge$1++;return ye.set(e,t),ve.set(t,e),t},we=function(e,t){ge$1=t+1,ye.set(e,t),ve.set(t,e)},be="style[".concat(f,"][").concat(y,'="').concat(v,'"]'),Ee=new RegExp("^".concat(f,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),Ne=function(e,t,n){for(var s,a=n.split(","),l=0,de=a.length;l<de;l++)(s=a[l])&&e.registerName(t,s)},Pe=function(e,t){for(var n,s=((n=t.textContent)!==null&&n!==void 0?n:"").split(g),a=[],l=0,de=s.length;l<de;l++){var pe=s[l].trim();if(pe){var me=pe.match(Ee);if(me){var Be=0|parseInt(me[1],10),Le=me[2];Be!==0&&(we(Le,Be),Ne(e,Le,me[3]),e.getTag().insertRules(Be,a)),a.length=0}else a.push(pe)}}},_e=function(e){for(var t=document.querySelectorAll(be),n=0,s=t.length;n<s;n++){var a=t[n];a&&a.getAttribute(f)!==m&&(Pe(e,a),a.parentNode&&a.parentNode.removeChild(a))}};function Ce(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var Ie=function(e){var t=document.head,n=e||t,s=document.createElement("style"),a=function(pe){var me=Array.from(pe.querySelectorAll("style[".concat(f,"]")));return me[me.length-1]}(n),l=a!==void 0?a.nextSibling:null;s.setAttribute(f,m),s.setAttribute(y,v);var de=Ce();return de&&s.setAttribute("nonce",de),n.insertBefore(s,l),s},Ae=function(){function e(t){this.element=Ie(t),this.element.appendChild(document.createTextNode("")),this.sheet=function(n){if(n.sheet)return n.sheet;for(var s=document.styleSheets,a=0,l=s.length;a<l;a++){var de=s[a];if(de.ownerNode===n)return de}throw he(17)}(this.element),this.length=0}return e.prototype.insertRule=function(t,n){try{return this.sheet.insertRule(n,t),this.length++,!0}catch{return!1}},e.prototype.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},e.prototype.getRule=function(t){var n=this.sheet.cssRules[t];return n&&n.cssText?n.cssText:""},e}(),Oe=function(){function e(t){this.element=Ie(t),this.nodes=this.element.childNodes,this.length=0}return e.prototype.insertRule=function(t,n){if(t<=this.length&&t>=0){var s=document.createTextNode(n);return this.element.insertBefore(s,this.nodes[t]||null),this.length++,!0}return!1},e.prototype.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},e.prototype.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},e}(),De=function(){function e(t){this.rules=[],this.length=0}return e.prototype.insertRule=function(t,n){return t<=this.length&&(this.rules.splice(t,0,n),this.length++,!0)},e.prototype.deleteRule=function(t){this.rules.splice(t,1),this.length--},e.prototype.getRule=function(t){return t<this.length?this.rules[t]:""},e}(),Re=S,Te={isServer:!S,useCSSOMInjection:!w},ke=function(){function e(t,n,s){t===void 0&&(t=C),n===void 0&&(n={});var a=this;this.options=__assign(__assign({},Te),t),this.gs=n,this.names=new Map(s),this.server=!!t.isServer,!this.server&&S&&Re&&(Re=!1,_e(this)),ue(this,function(){return function(l){for(var de=l.getTag(),pe=de.length,me="",Be=function(Ye){var tt=function(gt){return ve.get(gt)}(Ye);if(tt===void 0)return"continue";var ot=l.names.get(tt),yt=de.getGroup(Ye);if(ot===void 0||!ot.size||yt.length===0)return"continue";var nt="".concat(f,".g").concat(Ye,'[id="').concat(tt,'"]'),st="";ot!==void 0&&ot.forEach(function(gt){gt.length>0&&(st+="".concat(gt,","))}),me+="".concat(yt).concat(nt,'{content:"').concat(st,'"}').concat(g)},Le=0;Le<pe;Le++)Be(Le);return me}(a)})}return e.registerId=function(t){return Se(t)},e.prototype.rehydrate=function(){!this.server&&S&&_e(this)},e.prototype.reconstructWithOptions=function(t,n){return n===void 0&&(n=!0),new e(__assign(__assign({},this.options),t),this.gs,n&&this.names||void 0)},e.prototype.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},e.prototype.getTag=function(){return this.tag||(this.tag=(t=function(n){var s=n.useCSSOMInjection,a=n.target;return n.isServer?new De(a):s?new Ae(a):new Oe(a)}(this.options),new fe$1(t)));var t},e.prototype.hasNameForId=function(t,n){return this.names.has(t)&&this.names.get(t).has(n)},e.prototype.registerName=function(t,n){if(Se(t),this.names.has(t))this.names.get(t).add(n);else{var s=new Set;s.add(n),this.names.set(t,s)}},e.prototype.insertRules=function(t,n,s){this.registerName(t,n),this.getTag().insertRules(Se(t),s)},e.prototype.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},e.prototype.clearRules=function(t){this.getTag().clearGroup(Se(t)),this.clearNames(t)},e.prototype.clearTag=function(){this.tag=void 0},e}(),je=/&/g,xe=/^\s*\/\/.*$/gm;function Ve(e,t){return e.map(function(n){return n.type==="rule"&&(n.value="".concat(t," ").concat(n.value),n.value=n.value.replaceAll(",",",".concat(t," ")),n.props=n.props.map(function(s){return"".concat(t," ").concat(s)})),Array.isArray(n.children)&&n.type!=="@keyframes"&&(n.children=Ve(n.children,t)),n})}function Fe(e){var t,n,s,a=C,l=a.options,de=l===void 0?C:l,pe=a.plugins,me=pe===void 0?_:pe,Be=function(tt,ot,yt){return yt.startsWith(n)&&yt.endsWith(n)&&yt.replaceAll(n,"").length>0?".".concat(t):tt},Le=me.slice();Le.push(function(tt){tt.type===RULESET&&tt.value.includes("&")&&(tt.props[0]=tt.props[0].replace(je,n).replace(s,Be))}),de.prefix&&Le.push(prefixer),Le.push(stringify);var Ye=function(tt,ot,yt,nt){ot===void 0&&(ot=""),yt===void 0&&(yt=""),nt===void 0&&(nt="&"),t=nt,n=ot,s=new RegExp("\\".concat(n,"\\b"),"g");var st=tt.replace(xe,""),gt=compile(yt||ot?"".concat(yt," ").concat(ot," { ").concat(st," }"):st);de.namespace&&(gt=Ve(gt,de.namespace));var wt=[];return serialize$1(gt,middleware(Le.concat(rulesheet(function(vt){return wt.push(vt)})))),wt};return Ye.hash=me.length?me.reduce(function(tt,ot){return ot.name||he(15),M(tt,ot.name)},F).toString():"",Ye}var Me=new ke,ze=Fe(),$e=o.createContext({shouldForwardProp:void 0,styleSheet:Me,stylis:ze});$e.Consumer;o.createContext(void 0);function Ge(){return reactExports.useContext($e)}var We=function(){function e(t,n){var s=this;this.inject=function(a,l){l===void 0&&(l=ze);var de=s.name+l.hash;a.hasNameForId(s.id,de)||a.insertRules(s.id,de,l(s.rules,de,"@keyframes"))},this.name=t,this.id="sc-keyframes-".concat(t),this.rules=n,ue(this,function(){throw he(12,String(s.name))})}return e.prototype.getName=function(t){return t===void 0&&(t=ze),this.name+t.hash},e}(),qe=function(e){return e>="A"&&e<="Z"};function He(e){for(var t="",n=0;n<e.length;n++){var s=e[n];if(n===1&&s==="-"&&e[0]==="-")return e;qe(s)?t+="-"+s.toLowerCase():t+=s}return t.startsWith("ms-")?"-"+t:t}var Ue=function(e){return e==null||e===!1||e===""},Je=function(e){var t,n,s=[];for(var a in e){var l=e[a];e.hasOwnProperty(a)&&!Ue(l)&&(Array.isArray(l)&&l.isCss||re(l)?s.push("".concat(He(a),":"),l,";"):ce(l)?s.push.apply(s,__spreadArray$2(__spreadArray$2(["".concat(a," {")],Je(l),!1),["}"],!1)):s.push("".concat(He(a),": ").concat((t=a,(n=l)==null||typeof n=="boolean"||n===""?"":typeof n!="number"||n===0||t in unitlessKeys||t.startsWith("--")?String(n).trim():"".concat(n,"px")),";")))}return s};function Xe(e,t,n,s){if(Ue(e))return[];if(se(e))return[".".concat(e.styledComponentId)];if(re(e)){if(!re(l=e)||l.prototype&&l.prototype.isReactComponent||!t)return[e];var a=e(t);return Xe(a,t,n,s)}var l;return e instanceof We?n?(e.inject(n,s),[e.getName(s)]):[e]:ce(e)?Je(e):Array.isArray(e)?Array.prototype.concat.apply(_,e.map(function(de){return Xe(de,t,n,s)})):[e.toString()]}function Ze(e){for(var t=0;t<e.length;t+=1){var n=e[t];if(re(n)&&!se(n))return!1}return!0}var Ke=z(v),Qe=function(){function e(t,n,s){this.rules=t,this.staticRulesId="",this.isStatic=(s===void 0||s.isStatic)&&Ze(t),this.componentId=n,this.baseHash=M(Ke,n),this.baseStyle=s,ke.registerId(n)}return e.prototype.generateAndInjectStyles=function(t,n,s){var a=this.baseStyle?this.baseStyle.generateAndInjectStyles(t,n,s):"";if(this.isStatic&&!s.hash)if(this.staticRulesId&&n.hasNameForId(this.componentId,this.staticRulesId))a=ie(a,this.staticRulesId);else{var l=ae(Xe(this.rules,t,n,s)),de=x(M(this.baseHash,l)>>>0);if(!n.hasNameForId(this.componentId,de)){var pe=s(l,".".concat(de),void 0,this.componentId);n.insertRules(this.componentId,de,pe)}a=ie(a,de),this.staticRulesId=de}else{for(var me=M(this.baseHash,s.hash),Be="",Le=0;Le<this.rules.length;Le++){var Ye=this.rules[Le];if(typeof Ye=="string")Be+=Ye;else if(Ye){var tt=ae(Xe(Ye,t,n,s));me=M(me,tt+Le),Be+=tt}}if(Be){var ot=x(me>>>0);n.hasNameForId(this.componentId,ot)||n.insertRules(this.componentId,ot,s(Be,".".concat(ot),void 0,this.componentId)),a=ie(a,ot)}}return a},e}(),et=o.createContext(void 0);et.Consumer;var rt={};function it(e,t,n){var s=se(e),a=e,l=!L(e),de=t.attrs,pe=de===void 0?_:de,me=t.componentId,Be=me===void 0?function(Rt,Bt){var $t=typeof Rt!="string"?"sc":R(Rt);rt[$t]=(rt[$t]||0)+1;var Ct="".concat($t,"-").concat($(v+$t+rt[$t]));return Bt?"".concat(Bt,"-").concat(Ct):Ct}(t.displayName,t.parentComponentId):me,Le=t.displayName,Ye=Le===void 0?function(Rt){return L(Rt)?"styled.".concat(Rt):"Styled(".concat(B(Rt),")")}(e):Le,tt=t.displayName&&t.componentId?"".concat(R(t.displayName),"-").concat(t.componentId):t.componentId||Be,ot=s&&a.attrs?a.attrs.concat(pe).filter(Boolean):pe,yt=t.shouldForwardProp;if(s&&a.shouldForwardProp){var nt=a.shouldForwardProp;if(t.shouldForwardProp){var st=t.shouldForwardProp;yt=function(Rt,Bt){return nt(Rt,Bt)&&st(Rt,Bt)}}else yt=nt}var gt=new Qe(n,tt,s?a.componentStyle:void 0);function wt(Rt,Bt){return function($t,Ct,kt){var Lt=$t.attrs,Pt=$t.componentStyle,mt=$t.defaultProps,_t=$t.foldedComponentIds,Tt=$t.styledComponentId,xt=$t.target,ht=o.useContext(et),ft=Ge(),Et=$t.shouldForwardProp||ft.shouldForwardProp,St=I(Ct,ht,mt)||C,At=function(Ut,Ot,Ht){for(var Vt,Dt=__assign(__assign({},Ot),{className:void 0,theme:Ht}),qt=0;qt<Ut.length;qt+=1){var Wt=re(Vt=Ut[qt])?Vt(Dt):Vt;for(var zt in Wt)Dt[zt]=zt==="className"?ie(Dt[zt],Wt[zt]):zt==="style"?__assign(__assign({},Dt[zt]),Wt[zt]):Wt[zt]}return Ot.className&&(Dt.className=ie(Dt.className,Ot.className)),Dt}(Lt,Ct,St),Nt=At.as||xt,It={};for(var Mt in At)At[Mt]===void 0||Mt[0]==="$"||Mt==="as"||Mt==="theme"&&At.theme===St||(Mt==="forwardedAs"?It.as=At.forwardedAs:Et&&!Et(Mt,Nt)||(It[Mt]=At[Mt]));var jt=function(Ut,Ot){var Ht=Ge(),Vt=Ut.generateAndInjectStyles(Ot,Ht.styleSheet,Ht.stylis);return Vt}(Pt,At),Ft=ie(_t,Tt);return jt&&(Ft+=" "+jt),At.className&&(Ft+=" "+At.className),It[L(Nt)&&!A.has(Nt)?"class":"className"]=Ft,It.ref=kt,reactExports.createElement(Nt,It)}(vt,Rt,Bt)}wt.displayName=Ye;var vt=o.forwardRef(wt);return vt.attrs=ot,vt.componentStyle=gt,vt.displayName=Ye,vt.shouldForwardProp=yt,vt.foldedComponentIds=s?ie(a.foldedComponentIds,a.styledComponentId):"",vt.styledComponentId=tt,vt.target=s?a.target:e,Object.defineProperty(vt,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(Rt){this._foldedDefaultProps=s?function(Bt){for(var $t=[],Ct=1;Ct<arguments.length;Ct++)$t[Ct-1]=arguments[Ct];for(var kt=0,Lt=$t;kt<Lt.length;kt++)le(Bt,Lt[kt],!0);return Bt}({},a.defaultProps,Rt):Rt}}),ue(vt,function(){return".".concat(vt.styledComponentId)}),l&&oe(vt,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),vt}function at(e,t){for(var n=[e[0]],s=0,a=t.length;s<a;s+=1)n.push(t[s],e[s+1]);return n}var ct=function(e){return Object.assign(e,{isCss:!0})};function lt(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(re(e)||ce(e))return ct(Xe(at(_,__spreadArray$2([e],t,!0))));var s=e;return t.length===0&&s.length===1&&typeof s[0]=="string"?Xe(s):ct(Xe(at(s,t)))}function ut$1(e,t,n){if(n===void 0&&(n=C),!t)throw he(1,t);var s=function(a){for(var l=[],de=1;de<arguments.length;de++)l[de-1]=arguments[de];return e(t,n,lt.apply(void 0,__spreadArray$2([a],l,!1)))};return s.attrs=function(a){return ut$1(e,t,__assign(__assign({},n),{attrs:Array.prototype.concat(n.attrs,a).filter(Boolean)}))},s.withConfig=function(a){return ut$1(e,t,__assign(__assign({},n),a))},s}var pt=function(e){return ut$1(it,e)},dt=pt;A.forEach(function(e){dt[e]=pt(e)});const size={mobile:"425px",tablet:"900px"},tablet=e=>lt`
  @media (max-width: ${size.tablet}) {
    ${e};
  }
`,Divider=dt.hr`
    display: block;
    width: 100%;
    color: #3b3b3b;
    border: 0.5px solid;
`,AbsoluteFull=lt`
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
`,Pointer=dt.span`
  cursor: pointer;
`,HelperText=dt.small`
  display: inline-block;
  width: 100%;
  margin-top: 10px;
  text-align: center;
  min-height: 17px;
  color: #ffffff80;
  transform: translateX(-10%);
  -webkit-transform: translateX(-10%);
  font-weight: bold;

  ${tablet(`
    transform: unset;
    -webkit-transform: unset;
  `)}
`,ErrorText=dt(HelperText)`
  color: #f87171;
`,CanvasContainer=dt.div`
  flex: 1;
  height: 100%;

  display: flex;
  justify-content: center;
  align-items: center;
  user-select: none;
  -webkit-user-select: none;

  ${tablet(`
    transform: scale(0.5);
    -webkit-transform: scale(0.5);
  `)}
`,CardWrapper=dt.div`
  position: relative;
  // width: 800px;
  // height: 460px;
`,ResizeKnobs=dt.div`
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: 10;
  top: 0;
  left: 0;
`;var ResizeKnobPosition=(e=>(e[e.left=0]="left",e[e.bottom=1]="bottom",e[e.right=2]="right",e))(ResizeKnobPosition||{});const ResizeKnobContainer=dt.div`
    touch-action: none;
    -webkit-touch-callout: none;
    display: flex;
    justify-content: center;
    align-items: center;
    width: 2em;
    height: 2em;

    ${e=>e.$position===0?`
            top: 50%;
            left: 0;
            transform: translateX(-50%) translateY(-50%);
            -webkit-transform: translateX(-50%) translateY(-50%);
            cursor: ew-resize;
        `:""}

    ${e=>e.$position===2?`
            top: 50%;
            right: 0;
            transform: translateX(50%) translateY(-50%);
            -webkit-transform: translateX(50%) translateY(-50%);
            cursor: ew-resize;
        `:""}

    ${e=>e.$position===1?`
            bottom: 0;
            left: 50%;
            transform: translateX(-50%) translateY(50%);
            -webkit-transform: translateX(-50%) translateY(50%);
            cursor: ns-resize;
        `:""}

    position: absolute;
    pointer-events: auto;

    &:hover div {
      transform: scale(2.5);
      -webkit-transform: scale(2.5);
    }
`,ResizeKnob=dt.div`
    transition-property: -webkit-transform, transform;
    transition-timing-function: cubic-bezier(.4,0,.2,1);
    transition-duration: .15s;
    -webkit-transition-property: -webkit-transform, transform;
    -webkit-transition-timing-function: cubic-bezier(.4,0,.2,1);
    -webkit-transition-duration: .15s;
    box-shadow: 0 0 #0000,0 0 #0000,0 4px 6px -1px rgba(0, 0, 0, .1), 0 2px 4px -1px rgba(0, 0, 0, .06);
    background-color: #FFF;
    border-radius: 50%;
    width: .375rem;
    height: .375rem;
`,CardContainer=dt.div`
  box-shadow: 0 90px 150px -80px #0e0f1180, 0 40px 120px #000000b3;
  border-radius: 0.5rem;
  overflow: hidden;
  width: 100%;
  height: 100%;
  position: relative;
  pointer-events: none;
`,CardContent=dt.div`
  padding: 50px;
  font-size: 16px;
  perspective: 1000px;
  transition: background-color 0.15s cubic-bezier(.4,0,.2,1), 
              border-color 0.15s cubic-bezier(.4,0,.2,1), 
              color 0.15s cubic-bezier(.4,0,.2,1), 
              fill 0.15s cubic-bezier(.4,0,.2,1), 
              stroke 0.15s cubic-bezier(.4,0,.2,1);
  -webkit-transition: background-color 0.15s cubic-bezier(.4,0,.2,1), 
              border-color 0.15s cubic-bezier(.4,0,.2,1), 
              color 0.15s cubic-bezier(.4,0,.2,1), 
              fill 0.15s cubic-bezier(.4,0,.2,1), 
              stroke 0.15s cubic-bezier(.4,0,.2,1);
  display: grid;
  place-items: center;
  width: 100%;
  height: 100%;
`,BackgroundGradient=dt.div`
  ${AbsoluteFull}
  background-image: ${e=>e.$gradient};
  background-repeat: no-repeat;
`,CardBlurShadow=dt.div`
  ${AbsoluteFull}
  background-image: ${e=>e.$gradient};
  background-size: ${e=>`${e.width}px ${e.height}px`};
  border-radius: 1em;
  z-index: 0;

  ${isSafari()?"":`
      &:before {
        position: absolute;
        content: "";
        left: 0;
        top: 3em;
        width: 100%;
        height: 100%;
        border-radius: 1em;
        background-color: #0000002e;
        transform: translateZ(-1px);
        -webkit-transform: translateZ(-1px);
        filter: blur(60px);
        -webkit-filter: blur(10px);
        z-index: -1;
      }

      &:after {
        position: absolute;
        content: "";
        left: 0;
        top: 3em;
        width: 100%;
        height: 100%;
        border-radius: 1em;
        background-color: #0000002e;
        transform: translateZ(-1px);
        -webkit-transform: translateZ(-1px);
        filter: blur(60px);
        -webkit-filter: blur(10px);: blur(60px);
        z-index: -1;
        filter: blur(20px);
        -webkit-filter: blur(10px);: blur(20px);
        left: 3%;
        right: 3%;
        width: initial;
        top: 1em;
      }
    `}
`,CardContentContainer=dt.div`
  position: relative;
  padding: 2em 2em 1.5em;
  width: 100%;
  height: 100%;
  border-radius: 1em;
  border: 1px solid;
  backdrop-filter: blur(18px) saturate(177%);
  -webkit-backdrop-filter: blur(18px) saturate(177%);
  transition: all 0.15s cubic-bezier(.4,0,.2,1);
  -webkit-transition: all 0.15s cubic-bezier(.4,0,.2,1);
`,InnerGradient=dt.div`
  ${AbsoluteFull}
  background-image: linear-gradient(-50deg, rgba(255, 255, 255, 0.5), rgba(255, 255, 255, 0.95) 80%);
  box-shadow: inset 0 0 0 2px #ffffff26;
  border-radius: 1em;
  z-index: -1;
`,CardHeader=dt.div`
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding-bottom: 0.75rem;
`,AuthorInfo=dt.div`
  display: flex;
  align-items: center;
`,AuthorImage=dt.img`
  width: 3em;
  height: 3em;
  margin-right: 0.75em;
  object-fit: cover;
  border-radius: 50%;
`,AuthorNameAndNip05Container=dt.div`
    display: flex;
    flex-direction: column;
    gap: 5px;
`,AuthorNameContainer=dt.div`
    display: flex;
    gap: 2px;
`,AuthorName=dt.div`
  font-weight: 600;
  color: #111;
  line-height: 1.2;
  display: flex;
  font-size: 18px;
  white-space: nowrap;
`,VerificationCheckContainer=dt.div`
    width: 20px;
    height: 20px;
`,VerificationIconContainer=dt.div`
    width: 20px;
    height: 20px;
    display: flex;
    justify-content: center;
    align-items: center;
    margin-inline: 4px;
`,AuthorNip05=dt.div`
  font-weight: 400;
  color: rgba(0, 0, 0, 0.5);
  line-height: 1.2;
  display: flex;
  font-size: 14px;
  white-space: nowrap;
`,NostrBrand=dt.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
`,NostrName=dt.span`
  font-weight: bold;
  font-size: 12px;
  color: ${e=>e.$color};
`,TweetContent=dt.div`
  font-size: 1.4em;
  color: #111;
  line-height: 1.5;
  margin-bottom: 1em;
  pointer-events: none;
  font-weight: 500;
  word-break: break-word;
`,TweetTimestamp=dt.div`
  color: rgba(0, 0, 0, 0.5);
  padding-bottom: 0.7em;
  font-weight: 500;
`,TweetStats=dt.div`
  display: flex;
`,StatItem=dt.div`
  color: rgba(0, 0, 0, 0.7);
  margin-right: 1em;

  span {
    color: #111;
    font-weight: 600;
  }
`,useResizable=({cardWrapperRef:e,leftResizeKnob:t,rightResizeKnob:n,bottomResizeKnob:s,initialWidth:a=300,initialHeight:l=200})=>{const[de,pe]=reactExports.useState(a),[me,Be]=reactExports.useState(l),Le=reactExports.useRef(!1),Ye=reactExports.useRef("left"),tt=reactExports.useRef(0),ot=reactExports.useRef(0),yt=reactExports.useRef(de),nt=reactExports.useRef(me),st=reactExports.useRef(de),gt=reactExports.useRef(me),wt=(Bt,$t)=>{var Lt,Pt;Le.current=!0,Ye.current=$t;const Ct="touches"in Bt?Bt.touches[0].clientX:Bt.clientX,kt="touches"in Bt?Bt.touches[0].clientY:Bt.clientY;($t==="left"||$t==="right")&&(tt.current=Ct,yt.current=((Lt=e.current)==null?void 0:Lt.offsetWidth)||0),$t==="bottom"&&(ot.current=kt,nt.current=((Pt=e.current)==null?void 0:Pt.offsetHeight)||0),document.body.style.userSelect="none"},vt=Bt=>{if(!Le.current)return;const $t="touches"in Bt?Bt.touches[0].clientX:Bt.clientX,Ct="touches"in Bt?Bt.touches[0].clientY:Bt.clientY;if(Ye.current==="left"){const kt=yt.current-($t-tt.current);st.current=Math.max(kt,400)}else if(Ye.current==="right"){const kt=yt.current+($t-tt.current);st.current=Math.max(kt,400)}else if(Ye.current==="bottom"){const kt=nt.current+(Ct-ot.current);gt.current=Math.max(kt,380)}e.current&&(Ye.current==="left"||Ye.current==="right"?e.current.style.width=Math.max(st.current,50)+"px":Ye.current==="bottom"&&(e.current.style.height=Math.max(gt.current,50)+"px"))},Rt=()=>{Le.current=!1,document.body.style.userSelect="",pe(st.current),Be(gt.current)};return reactExports.useEffect(()=>{const Bt=(Lt,Pt)=>{if(Lt&&Lt.current){const mt=_t=>wt(_t,Pt);return Lt.current.addEventListener("mousedown",mt),Lt.current.addEventListener("touchstart",mt,{passive:!1}),()=>{Lt.current&&(Lt.current.removeEventListener("mousedown",mt),Lt.current.removeEventListener("touchstart",mt))}}},$t=Bt(t,"left"),Ct=Bt(n,"right"),kt=Bt(s,"bottom");return document.addEventListener("mousemove",vt),document.addEventListener("mouseup",Rt),document.addEventListener("touchmove",vt,{passive:!1}),document.addEventListener("touchend",Rt),()=>{$t&&$t(),Ct&&Ct(),kt&&kt(),document.removeEventListener("mousemove",vt),document.removeEventListener("mouseup",Rt),document.removeEventListener("touchmove",vt),document.removeEventListener("touchend",Rt)}},[t,n,s,e]),{width:de,height:me,setWidth:pe,setHeight:Be}},Canvas=reactExports.forwardRef(({noteHTML:e,note:t,showResponse:n,gradient:s,nostrBrandingColor:a},l)=>{var tt,ot,yt;const de=reactExports.useRef(null),pe=reactExports.useRef(null),me=reactExports.useRef(null),Be=reactExports.useRef(null),{width:Le,height:Ye}=useResizable({cardWrapperRef:de,leftResizeKnob:pe,rightResizeKnob:me,bottomResizeKnob:Be,initialWidth:650,initialHeight:325});return jsxRuntimeExports.jsx(CanvasContainer,{children:jsxRuntimeExports.jsxs(CardWrapper,{ref:de,style:{width:Le},children:[jsxRuntimeExports.jsxs(ResizeKnobs,{children:[jsxRuntimeExports.jsx(ResizeKnobContainer,{ref:pe,$position:ResizeKnobPosition.left,children:jsxRuntimeExports.jsx(ResizeKnob,{})}),jsxRuntimeExports.jsx(ResizeKnobContainer,{ref:me,$position:ResizeKnobPosition.right,children:jsxRuntimeExports.jsx(ResizeKnob,{})}),jsxRuntimeExports.jsx(ResizeKnobContainer,{ref:Be,$position:ResizeKnobPosition.bottom,children:jsxRuntimeExports.jsx(ResizeKnob,{})})]}),jsxRuntimeExports.jsx(CardContainer,{ref:l,children:jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsx(BackgroundGradient,{$gradient:s}),jsxRuntimeExports.jsxs("div",{style:{width:"100%",position:"relative"},children:[jsxRuntimeExports.jsx(CardBlurShadow,{width:Le,height:Ye,$gradient:s}),jsxRuntimeExports.jsxs(CardContentContainer,{children:[jsxRuntimeExports.jsx(InnerGradient,{}),jsxRuntimeExports.jsxs(CardHeader,{children:[jsxRuntimeExports.jsxs(AuthorInfo,{children:[jsxRuntimeExports.jsx(AuthorImage,{src:proxyImg(((tt=t.author)==null?void 0:tt.image)||"",defaultImgProxy),alt:"Image of the Nostr note author"}),jsxRuntimeExports.jsxs(AuthorNameAndNip05Container,{children:[jsxRuntimeExports.jsxs(AuthorNameContainer,{children:[jsxRuntimeExports.jsx(AuthorName,{children:(ot=t.author)==null?void 0:ot.name}),jsxRuntimeExports.jsx(VerificationCheckContainer,{children:jsxRuntimeExports.jsx(VerificationIconContainer,{children:jsxRuntimeExports.jsx(VerificationCheck,{})})})]}),jsxRuntimeExports.jsx(AuthorNip05,{children:(yt=t.author)==null?void 0:yt.nip05})]})]}),jsxRuntimeExports.jsxs(NostrBrand,{children:[jsxRuntimeExports.jsx(NostrichHead,{fill:a}),jsxRuntimeExports.jsx(NostrName,{$color:a,children:"Nostr"})]})]}),jsxRuntimeExports.jsx(TweetContent,{dangerouslySetInnerHTML:{__html:e}}),jsxRuntimeExports.jsxs(TweetTimestamp,{children:[dayjs(t.createdAt*1e3).format("hh:mm A"),"  ",dayjs(t.createdAt*1e3).format("DD MMM, YYYY")]}),n?jsxRuntimeExports.jsxs(TweetStats,{children:[jsxRuntimeExports.jsxs(StatItem,{children:[jsxRuntimeExports.jsx("span",{children:toReadableStatsFormat(t.replies)})," replies"]}),jsxRuntimeExports.jsxs(StatItem,{children:[jsxRuntimeExports.jsx("span",{children:toReadableStatsFormat(t.zaps)})," zaps"]}),jsxRuntimeExports.jsxs(StatItem,{children:[jsxRuntimeExports.jsx("span",{children:toReadableStatsFormat(t.likes)})," likes"]}),jsxRuntimeExports.jsxs(StatItem,{children:[jsxRuntimeExports.jsx("span",{children:toReadableStatsFormat(t.reposts)})," reposts"]})]}):null]})]})]})})]})})}),HelpButtonContainer=dt.div`
    position: relative;
`,StyledHelpButton=dt.button`
    border: none;
    background-color: transparent;
    cursor: pointer;
    font-size: 36px;
    color: #FFF;
    width: 65px;
    height: 65px;
    border-radius: 5px;

    display: flex;
    justify-content: center;
    align-items: center;

    &:hover {
        background-color: rgba(39,39,40,1);
    }

    &:focus {
        outline: #CE66FF solid 2px;
    }

    ${tablet(`
        width: 36px;
        height: 36px;
        font-size: 24px;
    `)}
`,HelpContainer=dt.ul`
    list-style-type: none;
    background-color: #272727;
    border: 1px solid #71717187;
    border-radius: 8px;
    box-shadow: 0 25px 40px 11px #00000040;
    padding: 10px;

    width: max-content;
    display: flex;
    flex-direction: column;
    gap: 8px;

    position: absolute;
    right: 0px;
    top: 60px;

    transform: translateY(-5%);
    opacity: 0;
    z-index: -1;

    transition: transform 0.2s, opacity 0.4s, z-index 0.2s;
`,HelpItem=dt.li`
    padding: 10px;
    color: #FFF;
    transition: background-color 0.2s;
    border-radius: 8px;
    cursor: pointer;

    font-size: 14px;

    min-height: 45px;
    min-width: 200px;

    svg {
        width: 20px;
        height: 20px;
    }

    &:hover {
        background-color: #222222;
    }

    &:hover svg {
        width: 25px;
        height: 25px;
    }
`,HelpAnchor=dt.a`
    display: flex;
    gap: 12px;
    align-items: center;
    text-decoration: none;
    color: inherit;
`,HELP_ITEMS=[{text:"What's this?",icon:jsxRuntimeExports.jsx(QuestionMark,{}),link:"/about"},{text:"What's Nostr?",icon:jsxRuntimeExports.jsx(QuestionMark,{}),link:"https://nostr.com"},{text:"Not working?",icon:jsxRuntimeExports.jsx(QuestionMark,{}),link:"/not-working"},{text:"Credits",icon:jsxRuntimeExports.jsx(HeartIcon2,{}),link:"/credits"},{text:"Feedback",icon:jsxRuntimeExports.jsx(Mail,{}),link:"/feedback"},{text:"Donate",icon:jsxRuntimeExports.jsx(Bitcoin,{}),link:"/donate"},{text:"Github",icon:jsxRuntimeExports.jsx(Github,{}),link:"https://github.com/djhemath/snap-nostr"}];function HelpButton(){const[e,t]=reactExports.useState(!1),n=reactExports.useRef(null),s=reactExports.useRef(null);reactExports.useEffect(()=>{function l(de){n.current&&!n.current.contains(de.target)&&s.current&&!s.current.contains(de.target)&&t(!1)}return document.addEventListener("click",de=>l(de)),()=>{document.removeEventListener("click",l)}},[]);const a=()=>{t(!1)};return jsxRuntimeExports.jsxs(HelpButtonContainer,{children:[jsxRuntimeExports.jsx(StyledHelpButton,{"aria-label":"Help button",ref:s,onClick:()=>t(l=>!l),className:"rammetto-one-regular",children:"?"}),jsxRuntimeExports.jsx(HelpContainer,{ref:n,style:{transform:e?"translateY(0)":"",opacity:e?1:0,zIndex:e?1:-1},children:HELP_ITEMS.map(l=>jsxRuntimeExports.jsx(HelpItem,{onClick:()=>a(),children:jsxRuntimeExports.jsxs(HelpAnchor,{href:l.link,target:"_blank",children:[l.icon,jsxRuntimeExports.jsx("span",{children:l.text})]})},l.text))})]})}const LogoContainer=dt.div`
    position: relative;
`,StyledLogo=dt.h1`
    color: #FFF;
    font-size: 40px;
    margin: 0px;
    background: linear-gradient(90deg, #CE66FF, #FE983B);
    background-clip: text;
    -webkit-text-fill-color: transparent;
    user-select: none;
    -webkit-user-select: none;
`;dt.small`
    color: #FFF;
    font-size: 12px;
    font-weight: bold;
    background: linear-gradient(90deg, #CE66FF, #FE983B);
    background-clip: text;
    -webkit-text-fill-color: transparent;
    user-select: none;
    -webkit-user-select: none;

    position: absolute;
    right: 0;
    bottom: 0;
`;function Logo(){return jsxRuntimeExports.jsx(LogoContainer,{children:jsxRuntimeExports.jsx(StyledLogo,{className:"rammetto-one-regular",children:"SnapNostr"})})}const SearchBarWrapper=dt.div`
    display: flex;
    flex-direction: column;
    position: relative;
    top: 17px;

    ${tablet(`
        width: 100%;
    `)}
`,SearchBarContainer=dt.label`
    background-color: #272727;
    border: 1px solid #71717187;
    border-radius: 8px;
    padding: 10px 40px;
    width: 550px;
    height: 50px;
    box-shadow: 0 25px 40px 11px #00000040;
    transform: translateX(-10%);
    -webkit-transform: translateX(-10%);

    display: flex;
    align-items: center;
    gap: 10px;

    transition: all 0.2s;
    -webkit-transition: all 0.2s;

    cursor: text;

    &:hover {
        border: 1px solid #717171;
    }

    &:has(input:focus) {
        outline: #CE66FF solid 2px;
    }

    &:focus-within, &:has(input:not(:placeholder-shown)) {
        padding-left: 10px;
    }

    position: relative;

    ${tablet(`
        width: 100%;
        transform: unset;
        -webkit-transform: unset;
        padding: 10px 10px;
    `)}
`,SearchBarForm=dt.form`
    height: 100%;
    width: 100%;
`,SearchInput=dt.input`
    border: none;
    background-color: transparent !important;
    height: 100%;
    width: 100%;
    font-size: 16px;
    outline: none;
    color: #FFF;
`,SearchBarProgressContainer=dt.div`
    position: absolute;
    inset: 3px 3px 1px;
    border-radius: .5rem;
    overflow: hidden;
    pointer-events: none;
    width: 100.5%;
    left: -2px;
    bottom: 0px;
`,SearchBarProgress=dt.div`
    background: #27c4f5 linear-gradient(to right,#CE66FF,#FE983B);
    -webkit-animation: 3s linear infinite rainbow,.5s ease-out enter;
    animation: 3s linear infinite rainbow,.5s ease-out enter;
    transition: opacity .3s ease-in-out;
    -webkit-transition: opacity .3s ease-in-out;
    transform-origin: left;
    -webkit-transform-origin: left;
    background-size: 500%;
    z-index: 999999;
    position: absolute;
    display: block;
    width: 100%;
    opacity: 1;
    left: 0;
    bottom: 0;
    height: 2px;
`;function number$2(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function bytes$2(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function hash$1(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");number$2(e.outputLen),number$2(e.blockLen)}function exists$1(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function output$1(e,t){bytes$2(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const crypto$2=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const u8a$2=e=>e instanceof Uint8Array,createView$1=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),rotr$1=(e,t)=>e<<32-t|e>>>t,isLE$2=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!isLE$2)throw new Error("Non little-endian hardware is not supported");function utf8ToBytes$2(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function toBytes$1(e){if(typeof e=="string"&&(e=utf8ToBytes$2(e)),!u8a$2(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}function concatBytes$2(...e){const t=new Uint8Array(e.reduce((s,a)=>s+a.length,0));let n=0;return e.forEach(s=>{if(!u8a$2(s))throw new Error("Uint8Array expected");t.set(s,n),n+=s.length}),t}let Hash$1=class{clone(){return this._cloneInto()}};function wrapConstructor$1(e){const t=s=>e().update(toBytes$1(s)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function randomBytes$1(e=32){if(crypto$2&&typeof crypto$2.getRandomValues=="function")return crypto$2.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}function setBigUint64$1(e,t,n,s){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,s);const a=BigInt(32),l=BigInt(4294967295),de=Number(n>>a&l),pe=Number(n&l),me=s?4:0,Be=s?0:4;e.setUint32(t+me,de,s),e.setUint32(t+Be,pe,s)}let SHA2$1=class extends Hash$1{constructor(t,n,s,a){super(),this.blockLen=t,this.outputLen=n,this.padOffset=s,this.isLE=a,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=createView$1(this.buffer)}update(t){exists$1(this);const{view:n,buffer:s,blockLen:a}=this;t=toBytes$1(t);const l=t.length;for(let de=0;de<l;){const pe=Math.min(a-this.pos,l-de);if(pe===a){const me=createView$1(t);for(;a<=l-de;de+=a)this.process(me,de);continue}s.set(t.subarray(de,de+pe),this.pos),this.pos+=pe,de+=pe,this.pos===a&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){exists$1(this),output$1(t,this),this.finished=!0;const{buffer:n,view:s,blockLen:a,isLE:l}=this;let{pos:de}=this;n[de++]=128,this.buffer.subarray(de).fill(0),this.padOffset>a-de&&(this.process(s,0),de=0);for(let Ye=de;Ye<a;Ye++)n[Ye]=0;setBigUint64$1(s,a-8,BigInt(this.length*8),l),this.process(s,0);const pe=createView$1(t),me=this.outputLen;if(me%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const Be=me/4,Le=this.get();if(Be>Le.length)throw new Error("_sha2: outputLen bigger than state");for(let Ye=0;Ye<Be;Ye++)pe.setUint32(4*Ye,Le[Ye],l)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const s=t.slice(0,n);return this.destroy(),s}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:s,length:a,finished:l,destroyed:de,pos:pe}=this;return t.length=a,t.pos=pe,t.finished=l,t.destroyed=de,a%n&&t.buffer.set(s),t}};const Chi$1=(e,t,n)=>e&t^~e&n,Maj$1=(e,t,n)=>e&t^e&n^t&n,SHA256_K$1=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),IV$1=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_W$1=new Uint32Array(64);let SHA256$1=class extends SHA2$1{constructor(){super(64,32,8,!1),this.A=IV$1[0]|0,this.B=IV$1[1]|0,this.C=IV$1[2]|0,this.D=IV$1[3]|0,this.E=IV$1[4]|0,this.F=IV$1[5]|0,this.G=IV$1[6]|0,this.H=IV$1[7]|0}get(){const{A:t,B:n,C:s,D:a,E:l,F:de,G:pe,H:me}=this;return[t,n,s,a,l,de,pe,me]}set(t,n,s,a,l,de,pe,me){this.A=t|0,this.B=n|0,this.C=s|0,this.D=a|0,this.E=l|0,this.F=de|0,this.G=pe|0,this.H=me|0}process(t,n){for(let Ye=0;Ye<16;Ye++,n+=4)SHA256_W$1[Ye]=t.getUint32(n,!1);for(let Ye=16;Ye<64;Ye++){const tt=SHA256_W$1[Ye-15],ot=SHA256_W$1[Ye-2],yt=rotr$1(tt,7)^rotr$1(tt,18)^tt>>>3,nt=rotr$1(ot,17)^rotr$1(ot,19)^ot>>>10;SHA256_W$1[Ye]=nt+SHA256_W$1[Ye-7]+yt+SHA256_W$1[Ye-16]|0}let{A:s,B:a,C:l,D:de,E:pe,F:me,G:Be,H:Le}=this;for(let Ye=0;Ye<64;Ye++){const tt=rotr$1(pe,6)^rotr$1(pe,11)^rotr$1(pe,25),ot=Le+tt+Chi$1(pe,me,Be)+SHA256_K$1[Ye]+SHA256_W$1[Ye]|0,nt=(rotr$1(s,2)^rotr$1(s,13)^rotr$1(s,22))+Maj$1(s,a,l)|0;Le=Be,Be=me,me=pe,pe=de+ot|0,de=l,l=a,a=s,s=ot+nt|0}s=s+this.A|0,a=a+this.B|0,l=l+this.C|0,de=de+this.D|0,pe=pe+this.E|0,me=me+this.F|0,Be=Be+this.G|0,Le=Le+this.H|0,this.set(s,a,l,de,pe,me,Be,Le)}roundClean(){SHA256_W$1.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const sha256$1=wrapConstructor$1(()=>new SHA256$1);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$8=BigInt(0),_1n$8=BigInt(1),_2n$4=BigInt(2),u8a$1=e=>e instanceof Uint8Array,hexes$1=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function bytesToHex$1(e){if(!u8a$1(e))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=hexes$1[e[n]];return t}function numberToHexUnpadded(e){const t=e.toString(16);return t.length&1?`0${t}`:t}function hexToNumber(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}function hexToBytes$1(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);const t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(t/2);for(let s=0;s<n.length;s++){const a=s*2,l=e.slice(a,a+2),de=Number.parseInt(l,16);if(Number.isNaN(de)||de<0)throw new Error("Invalid byte sequence");n[s]=de}return n}function bytesToNumberBE(e){return hexToNumber(bytesToHex$1(e))}function bytesToNumberLE(e){if(!u8a$1(e))throw new Error("Uint8Array expected");return hexToNumber(bytesToHex$1(Uint8Array.from(e).reverse()))}function numberToBytesBE(e,t){return hexToBytes$1(e.toString(16).padStart(t*2,"0"))}function numberToBytesLE(e,t){return numberToBytesBE(e,t).reverse()}function numberToVarBytesBE(e){return hexToBytes$1(numberToHexUnpadded(e))}function ensureBytes(e,t,n){let s;if(typeof t=="string")try{s=hexToBytes$1(t)}catch(l){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${l}`)}else if(u8a$1(t))s=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);const a=s.length;if(typeof n=="number"&&a!==n)throw new Error(`${e} expected ${n} bytes, got ${a}`);return s}function concatBytes$1(...e){const t=new Uint8Array(e.reduce((s,a)=>s+a.length,0));let n=0;return e.forEach(s=>{if(!u8a$1(s))throw new Error("Uint8Array expected");t.set(s,n),n+=s.length}),t}function equalBytes$1(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function utf8ToBytes$1(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function bitLen(e){let t;for(t=0;e>_0n$8;e>>=_1n$8,t+=1);return t}function bitGet(e,t){return e>>BigInt(t)&_1n$8}const bitSet=(e,t,n)=>e|(n?_1n$8:_0n$8)<<BigInt(t),bitMask=e=>(_2n$4<<BigInt(e-1))-_1n$8,u8n=e=>new Uint8Array(e),u8fr=e=>Uint8Array.from(e);function createHmacDrbg(e,t,n){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let s=u8n(e),a=u8n(e),l=0;const de=()=>{s.fill(1),a.fill(0),l=0},pe=(...Ye)=>n(a,s,...Ye),me=(Ye=u8n())=>{a=pe(u8fr([0]),Ye),s=pe(),Ye.length!==0&&(a=pe(u8fr([1]),Ye),s=pe())},Be=()=>{if(l++>=1e3)throw new Error("drbg: tried 1000 values");let Ye=0;const tt=[];for(;Ye<t;){s=pe();const ot=s.slice();tt.push(ot),Ye+=s.length}return concatBytes$1(...tt)};return(Ye,tt)=>{de(),me(Ye);let ot;for(;!(ot=tt(Be()));)me();return de(),ot}}const validatorFns={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||e instanceof Uint8Array,isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function validateObject(e,t,n={}){const s=(a,l,de)=>{const pe=validatorFns[l];if(typeof pe!="function")throw new Error(`Invalid validator "${l}", expected function`);const me=e[a];if(!(de&&me===void 0)&&!pe(me,e))throw new Error(`Invalid param ${String(a)}=${me} (${typeof me}), expected ${l}`)};for(const[a,l]of Object.entries(t))s(a,l,!1);for(const[a,l]of Object.entries(n))s(a,l,!0);return e}const ut=Object.freeze(Object.defineProperty({__proto__:null,bitGet,bitLen,bitMask,bitSet,bytesToHex:bytesToHex$1,bytesToNumberBE,bytesToNumberLE,concatBytes:concatBytes$1,createHmacDrbg,ensureBytes,equalBytes:equalBytes$1,hexToBytes:hexToBytes$1,hexToNumber,numberToBytesBE,numberToBytesLE,numberToHexUnpadded,numberToVarBytesBE,utf8ToBytes:utf8ToBytes$1,validateObject},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$7=BigInt(0),_1n$7=BigInt(1),_2n$3=BigInt(2),_3n$3=BigInt(3),_4n$1=BigInt(4),_5n$1=BigInt(5),_8n$1=BigInt(8);BigInt(9);BigInt(16);function mod$1(e,t){const n=e%t;return n>=_0n$7?n:t+n}function pow$1(e,t,n){if(n<=_0n$7||t<_0n$7)throw new Error("Expected power/modulo > 0");if(n===_1n$7)return _0n$7;let s=_1n$7;for(;t>_0n$7;)t&_1n$7&&(s=s*e%n),e=e*e%n,t>>=_1n$7;return s}function pow2$1(e,t,n){let s=e;for(;t-- >_0n$7;)s*=s,s%=n;return s}function invert$1(e,t){if(e===_0n$7||t<=_0n$7)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=mod$1(e,t),s=t,a=_0n$7,l=_1n$7;for(;n!==_0n$7;){const pe=s/n,me=s%n,Be=a-l*pe;s=n,n=me,a=l,l=Be}if(s!==_1n$7)throw new Error("invert: does not exist");return mod$1(a,t)}function tonelliShanks$1(e){const t=(e-_1n$7)/_2n$3;let n,s,a;for(n=e-_1n$7,s=0;n%_2n$3===_0n$7;n/=_2n$3,s++);for(a=_2n$3;a<e&&pow$1(a,t,e)!==e-_1n$7;a++);if(s===1){const de=(e+_1n$7)/_4n$1;return function(me,Be){const Le=me.pow(Be,de);if(!me.eql(me.sqr(Le),Be))throw new Error("Cannot find square root");return Le}}const l=(n+_1n$7)/_2n$3;return function(pe,me){if(pe.pow(me,t)===pe.neg(pe.ONE))throw new Error("Cannot find square root");let Be=s,Le=pe.pow(pe.mul(pe.ONE,a),n),Ye=pe.pow(me,l),tt=pe.pow(me,n);for(;!pe.eql(tt,pe.ONE);){if(pe.eql(tt,pe.ZERO))return pe.ZERO;let ot=1;for(let nt=pe.sqr(tt);ot<Be&&!pe.eql(nt,pe.ONE);ot++)nt=pe.sqr(nt);const yt=pe.pow(Le,_1n$7<<BigInt(Be-ot-1));Le=pe.sqr(yt),Ye=pe.mul(Ye,yt),tt=pe.mul(tt,Le),Be=ot}return Ye}}function FpSqrt$1(e){if(e%_4n$1===_3n$3){const t=(e+_1n$7)/_4n$1;return function(s,a){const l=s.pow(a,t);if(!s.eql(s.sqr(l),a))throw new Error("Cannot find square root");return l}}if(e%_8n$1===_5n$1){const t=(e-_5n$1)/_8n$1;return function(s,a){const l=s.mul(a,_2n$3),de=s.pow(l,t),pe=s.mul(a,de),me=s.mul(s.mul(pe,_2n$3),de),Be=s.mul(pe,s.sub(me,s.ONE));if(!s.eql(s.sqr(Be),a))throw new Error("Cannot find square root");return Be}}return tonelliShanks$1(e)}const FIELD_FIELDS$1=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function validateField$1(e){const t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=FIELD_FIELDS$1.reduce((s,a)=>(s[a]="function",s),t);return validateObject(e,n)}function FpPow$1(e,t,n){if(n<_0n$7)throw new Error("Expected power > 0");if(n===_0n$7)return e.ONE;if(n===_1n$7)return t;let s=e.ONE,a=t;for(;n>_0n$7;)n&_1n$7&&(s=e.mul(s,a)),a=e.sqr(a),n>>=_1n$7;return s}function FpInvertBatch$1(e,t){const n=new Array(t.length),s=t.reduce((l,de,pe)=>e.is0(de)?l:(n[pe]=l,e.mul(l,de)),e.ONE),a=e.inv(s);return t.reduceRight((l,de,pe)=>e.is0(de)?l:(n[pe]=e.mul(l,n[pe]),e.mul(l,de)),a),n}function nLength$1(e,t){const n=t!==void 0?t:e.toString(2).length,s=Math.ceil(n/8);return{nBitLength:n,nByteLength:s}}function Field$1(e,t,n=!1,s={}){if(e<=_0n$7)throw new Error(`Expected Field ORDER > 0, got ${e}`);const{nBitLength:a,nByteLength:l}=nLength$1(e,t);if(l>2048)throw new Error("Field lengths over 2048 bytes are not supported");const de=FpSqrt$1(e),pe=Object.freeze({ORDER:e,BITS:a,BYTES:l,MASK:bitMask(a),ZERO:_0n$7,ONE:_1n$7,create:me=>mod$1(me,e),isValid:me=>{if(typeof me!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof me}`);return _0n$7<=me&&me<e},is0:me=>me===_0n$7,isOdd:me=>(me&_1n$7)===_1n$7,neg:me=>mod$1(-me,e),eql:(me,Be)=>me===Be,sqr:me=>mod$1(me*me,e),add:(me,Be)=>mod$1(me+Be,e),sub:(me,Be)=>mod$1(me-Be,e),mul:(me,Be)=>mod$1(me*Be,e),pow:(me,Be)=>FpPow$1(pe,me,Be),div:(me,Be)=>mod$1(me*invert$1(Be,e),e),sqrN:me=>me*me,addN:(me,Be)=>me+Be,subN:(me,Be)=>me-Be,mulN:(me,Be)=>me*Be,inv:me=>invert$1(me,e),sqrt:s.sqrt||(me=>de(pe,me)),invertBatch:me=>FpInvertBatch$1(pe,me),cmov:(me,Be,Le)=>Le?Be:me,toBytes:me=>n?numberToBytesLE(me,l):numberToBytesBE(me,l),fromBytes:me=>{if(me.length!==l)throw new Error(`Fp.fromBytes: expected ${l}, got ${me.length}`);return n?bytesToNumberLE(me):bytesToNumberBE(me)}});return Object.freeze(pe)}function getFieldBytesLength$1(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function getMinHashLength$1(e){const t=getFieldBytesLength$1(e);return t+Math.ceil(t/2)}function mapHashToField$1(e,t,n=!1){const s=e.length,a=getFieldBytesLength$1(t),l=getMinHashLength$1(t);if(s<16||s<l||s>1024)throw new Error(`expected ${l}-1024 bytes of input, got ${s}`);const de=n?bytesToNumberBE(e):bytesToNumberLE(e),pe=mod$1(de,t-_1n$7)+_1n$7;return n?numberToBytesLE(pe,a):numberToBytesBE(pe,a)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$6=BigInt(0),_1n$6=BigInt(1);function wNAF$1(e,t){const n=(a,l)=>{const de=l.negate();return a?de:l},s=a=>{const l=Math.ceil(t/a)+1,de=2**(a-1);return{windows:l,windowSize:de}};return{constTimeNegate:n,unsafeLadder(a,l){let de=e.ZERO,pe=a;for(;l>_0n$6;)l&_1n$6&&(de=de.add(pe)),pe=pe.double(),l>>=_1n$6;return de},precomputeWindow(a,l){const{windows:de,windowSize:pe}=s(l),me=[];let Be=a,Le=Be;for(let Ye=0;Ye<de;Ye++){Le=Be,me.push(Le);for(let tt=1;tt<pe;tt++)Le=Le.add(Be),me.push(Le);Be=Le.double()}return me},wNAF(a,l,de){const{windows:pe,windowSize:me}=s(a);let Be=e.ZERO,Le=e.BASE;const Ye=BigInt(2**a-1),tt=2**a,ot=BigInt(a);for(let yt=0;yt<pe;yt++){const nt=yt*me;let st=Number(de&Ye);de>>=ot,st>me&&(st-=tt,de+=_1n$6);const gt=nt,wt=nt+Math.abs(st)-1,vt=yt%2!==0,Rt=st<0;st===0?Le=Le.add(n(vt,l[gt])):Be=Be.add(n(Rt,l[wt]))}return{p:Be,f:Le}},wNAFCached(a,l,de,pe){const me=a._WINDOW_SIZE||1;let Be=l.get(a);return Be||(Be=this.precomputeWindow(a,me),me!==1&&l.set(a,pe(Be))),this.wNAF(me,Be,de)}}}function validateBasic$1(e){return validateField$1(e.Fp),validateObject(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...nLength$1(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function validatePointOpts$1(e){const t=validateBasic$1(e);validateObject(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:s,a}=t;if(n){if(!s.eql(a,s.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}const{bytesToNumberBE:b2n$1,hexToBytes:h2b$1}=ut,DER$1={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(e){const{Err:t}=DER$1;if(e.length<2||e[0]!==2)throw new t("Invalid signature integer tag");const n=e[1],s=e.subarray(2,n+2);if(!n||s.length!==n)throw new t("Invalid signature integer: wrong length");if(s[0]&128)throw new t("Invalid signature integer: negative");if(s[0]===0&&!(s[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return{d:b2n$1(s),l:e.subarray(n+2)}},toSig(e){const{Err:t}=DER$1,n=typeof e=="string"?h2b$1(e):e;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");let s=n.length;if(s<2||n[0]!=48)throw new t("Invalid signature tag");if(n[1]!==s-2)throw new t("Invalid signature: incorrect length");const{d:a,l}=DER$1._parseInt(n.subarray(2)),{d:de,l:pe}=DER$1._parseInt(l);if(pe.length)throw new t("Invalid signature: left bytes after parsing");return{r:a,s:de}},hexFromSig(e){const t=Be=>Number.parseInt(Be[0],16)&8?"00"+Be:Be,n=Be=>{const Le=Be.toString(16);return Le.length&1?`0${Le}`:Le},s=t(n(e.s)),a=t(n(e.r)),l=s.length/2,de=a.length/2,pe=n(l),me=n(de);return`30${n(de+l+4)}02${me}${a}02${pe}${s}`}},_0n$5=BigInt(0),_1n$5=BigInt(1);BigInt(2);const _3n$2=BigInt(3);BigInt(4);function weierstrassPoints$1(e){const t=validatePointOpts$1(e),{Fp:n}=t,s=t.toBytes||((yt,nt,st)=>{const gt=nt.toAffine();return concatBytes$1(Uint8Array.from([4]),n.toBytes(gt.x),n.toBytes(gt.y))}),a=t.fromBytes||(yt=>{const nt=yt.subarray(1),st=n.fromBytes(nt.subarray(0,n.BYTES)),gt=n.fromBytes(nt.subarray(n.BYTES,2*n.BYTES));return{x:st,y:gt}});function l(yt){const{a:nt,b:st}=t,gt=n.sqr(yt),wt=n.mul(gt,yt);return n.add(n.add(wt,n.mul(yt,nt)),st)}if(!n.eql(n.sqr(t.Gy),l(t.Gx)))throw new Error("bad generator point: equation left != right");function de(yt){return typeof yt=="bigint"&&_0n$5<yt&&yt<t.n}function pe(yt){if(!de(yt))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function me(yt){const{allowedPrivateKeyLengths:nt,nByteLength:st,wrapPrivateKey:gt,n:wt}=t;if(nt&&typeof yt!="bigint"){if(yt instanceof Uint8Array&&(yt=bytesToHex$1(yt)),typeof yt!="string"||!nt.includes(yt.length))throw new Error("Invalid key");yt=yt.padStart(st*2,"0")}let vt;try{vt=typeof yt=="bigint"?yt:bytesToNumberBE(ensureBytes("private key",yt,st))}catch{throw new Error(`private key must be ${st} bytes, hex or bigint, not ${typeof yt}`)}return gt&&(vt=mod$1(vt,wt)),pe(vt),vt}const Be=new Map;function Le(yt){if(!(yt instanceof Ye))throw new Error("ProjectivePoint expected")}class Ye{constructor(nt,st,gt){if(this.px=nt,this.py=st,this.pz=gt,nt==null||!n.isValid(nt))throw new Error("x required");if(st==null||!n.isValid(st))throw new Error("y required");if(gt==null||!n.isValid(gt))throw new Error("z required")}static fromAffine(nt){const{x:st,y:gt}=nt||{};if(!nt||!n.isValid(st)||!n.isValid(gt))throw new Error("invalid affine point");if(nt instanceof Ye)throw new Error("projective point not allowed");const wt=vt=>n.eql(vt,n.ZERO);return wt(st)&&wt(gt)?Ye.ZERO:new Ye(st,gt,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(nt){const st=n.invertBatch(nt.map(gt=>gt.pz));return nt.map((gt,wt)=>gt.toAffine(st[wt])).map(Ye.fromAffine)}static fromHex(nt){const st=Ye.fromAffine(a(ensureBytes("pointHex",nt)));return st.assertValidity(),st}static fromPrivateKey(nt){return Ye.BASE.multiply(me(nt))}_setWindowSize(nt){this._WINDOW_SIZE=nt,Be.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:nt,y:st}=this.toAffine();if(!n.isValid(nt)||!n.isValid(st))throw new Error("bad point: x or y not FE");const gt=n.sqr(st),wt=l(nt);if(!n.eql(gt,wt))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:nt}=this.toAffine();if(n.isOdd)return!n.isOdd(nt);throw new Error("Field doesn't support isOdd")}equals(nt){Le(nt);const{px:st,py:gt,pz:wt}=this,{px:vt,py:Rt,pz:Bt}=nt,$t=n.eql(n.mul(st,Bt),n.mul(vt,wt)),Ct=n.eql(n.mul(gt,Bt),n.mul(Rt,wt));return $t&&Ct}negate(){return new Ye(this.px,n.neg(this.py),this.pz)}double(){const{a:nt,b:st}=t,gt=n.mul(st,_3n$2),{px:wt,py:vt,pz:Rt}=this;let Bt=n.ZERO,$t=n.ZERO,Ct=n.ZERO,kt=n.mul(wt,wt),Lt=n.mul(vt,vt),Pt=n.mul(Rt,Rt),mt=n.mul(wt,vt);return mt=n.add(mt,mt),Ct=n.mul(wt,Rt),Ct=n.add(Ct,Ct),Bt=n.mul(nt,Ct),$t=n.mul(gt,Pt),$t=n.add(Bt,$t),Bt=n.sub(Lt,$t),$t=n.add(Lt,$t),$t=n.mul(Bt,$t),Bt=n.mul(mt,Bt),Ct=n.mul(gt,Ct),Pt=n.mul(nt,Pt),mt=n.sub(kt,Pt),mt=n.mul(nt,mt),mt=n.add(mt,Ct),Ct=n.add(kt,kt),kt=n.add(Ct,kt),kt=n.add(kt,Pt),kt=n.mul(kt,mt),$t=n.add($t,kt),Pt=n.mul(vt,Rt),Pt=n.add(Pt,Pt),kt=n.mul(Pt,mt),Bt=n.sub(Bt,kt),Ct=n.mul(Pt,Lt),Ct=n.add(Ct,Ct),Ct=n.add(Ct,Ct),new Ye(Bt,$t,Ct)}add(nt){Le(nt);const{px:st,py:gt,pz:wt}=this,{px:vt,py:Rt,pz:Bt}=nt;let $t=n.ZERO,Ct=n.ZERO,kt=n.ZERO;const Lt=t.a,Pt=n.mul(t.b,_3n$2);let mt=n.mul(st,vt),_t=n.mul(gt,Rt),Tt=n.mul(wt,Bt),xt=n.add(st,gt),ht=n.add(vt,Rt);xt=n.mul(xt,ht),ht=n.add(mt,_t),xt=n.sub(xt,ht),ht=n.add(st,wt);let ft=n.add(vt,Bt);return ht=n.mul(ht,ft),ft=n.add(mt,Tt),ht=n.sub(ht,ft),ft=n.add(gt,wt),$t=n.add(Rt,Bt),ft=n.mul(ft,$t),$t=n.add(_t,Tt),ft=n.sub(ft,$t),kt=n.mul(Lt,ht),$t=n.mul(Pt,Tt),kt=n.add($t,kt),$t=n.sub(_t,kt),kt=n.add(_t,kt),Ct=n.mul($t,kt),_t=n.add(mt,mt),_t=n.add(_t,mt),Tt=n.mul(Lt,Tt),ht=n.mul(Pt,ht),_t=n.add(_t,Tt),Tt=n.sub(mt,Tt),Tt=n.mul(Lt,Tt),ht=n.add(ht,Tt),mt=n.mul(_t,ht),Ct=n.add(Ct,mt),mt=n.mul(ft,ht),$t=n.mul(xt,$t),$t=n.sub($t,mt),mt=n.mul(xt,_t),kt=n.mul(ft,kt),kt=n.add(kt,mt),new Ye($t,Ct,kt)}subtract(nt){return this.add(nt.negate())}is0(){return this.equals(Ye.ZERO)}wNAF(nt){return ot.wNAFCached(this,Be,nt,st=>{const gt=n.invertBatch(st.map(wt=>wt.pz));return st.map((wt,vt)=>wt.toAffine(gt[vt])).map(Ye.fromAffine)})}multiplyUnsafe(nt){const st=Ye.ZERO;if(nt===_0n$5)return st;if(pe(nt),nt===_1n$5)return this;const{endo:gt}=t;if(!gt)return ot.unsafeLadder(this,nt);let{k1neg:wt,k1:vt,k2neg:Rt,k2:Bt}=gt.splitScalar(nt),$t=st,Ct=st,kt=this;for(;vt>_0n$5||Bt>_0n$5;)vt&_1n$5&&($t=$t.add(kt)),Bt&_1n$5&&(Ct=Ct.add(kt)),kt=kt.double(),vt>>=_1n$5,Bt>>=_1n$5;return wt&&($t=$t.negate()),Rt&&(Ct=Ct.negate()),Ct=new Ye(n.mul(Ct.px,gt.beta),Ct.py,Ct.pz),$t.add(Ct)}multiply(nt){pe(nt);let st=nt,gt,wt;const{endo:vt}=t;if(vt){const{k1neg:Rt,k1:Bt,k2neg:$t,k2:Ct}=vt.splitScalar(st);let{p:kt,f:Lt}=this.wNAF(Bt),{p:Pt,f:mt}=this.wNAF(Ct);kt=ot.constTimeNegate(Rt,kt),Pt=ot.constTimeNegate($t,Pt),Pt=new Ye(n.mul(Pt.px,vt.beta),Pt.py,Pt.pz),gt=kt.add(Pt),wt=Lt.add(mt)}else{const{p:Rt,f:Bt}=this.wNAF(st);gt=Rt,wt=Bt}return Ye.normalizeZ([gt,wt])[0]}multiplyAndAddUnsafe(nt,st,gt){const wt=Ye.BASE,vt=(Bt,$t)=>$t===_0n$5||$t===_1n$5||!Bt.equals(wt)?Bt.multiplyUnsafe($t):Bt.multiply($t),Rt=vt(this,st).add(vt(nt,gt));return Rt.is0()?void 0:Rt}toAffine(nt){const{px:st,py:gt,pz:wt}=this,vt=this.is0();nt==null&&(nt=vt?n.ONE:n.inv(wt));const Rt=n.mul(st,nt),Bt=n.mul(gt,nt),$t=n.mul(wt,nt);if(vt)return{x:n.ZERO,y:n.ZERO};if(!n.eql($t,n.ONE))throw new Error("invZ was invalid");return{x:Rt,y:Bt}}isTorsionFree(){const{h:nt,isTorsionFree:st}=t;if(nt===_1n$5)return!0;if(st)return st(Ye,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:nt,clearCofactor:st}=t;return nt===_1n$5?this:st?st(Ye,this):this.multiplyUnsafe(t.h)}toRawBytes(nt=!0){return this.assertValidity(),s(Ye,this,nt)}toHex(nt=!0){return bytesToHex$1(this.toRawBytes(nt))}}Ye.BASE=new Ye(t.Gx,t.Gy,n.ONE),Ye.ZERO=new Ye(n.ZERO,n.ONE,n.ZERO);const tt=t.nBitLength,ot=wNAF$1(Ye,t.endo?Math.ceil(tt/2):tt);return{CURVE:t,ProjectivePoint:Ye,normPrivateKeyToScalar:me,weierstrassEquation:l,isWithinCurveOrder:de}}function validateOpts$1(e){const t=validateBasic$1(e);return validateObject(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function weierstrass$1(e){const t=validateOpts$1(e),{Fp:n,n:s}=t,a=n.BYTES+1,l=2*n.BYTES+1;function de(ht){return _0n$5<ht&&ht<n.ORDER}function pe(ht){return mod$1(ht,s)}function me(ht){return invert$1(ht,s)}const{ProjectivePoint:Be,normPrivateKeyToScalar:Le,weierstrassEquation:Ye,isWithinCurveOrder:tt}=weierstrassPoints$1({...t,toBytes(ht,ft,Et){const St=ft.toAffine(),At=n.toBytes(St.x),Nt=concatBytes$1;return Et?Nt(Uint8Array.from([ft.hasEvenY()?2:3]),At):Nt(Uint8Array.from([4]),At,n.toBytes(St.y))},fromBytes(ht){const ft=ht.length,Et=ht[0],St=ht.subarray(1);if(ft===a&&(Et===2||Et===3)){const At=bytesToNumberBE(St);if(!de(At))throw new Error("Point is not on curve");const Nt=Ye(At);let It=n.sqrt(Nt);const Mt=(It&_1n$5)===_1n$5;return(Et&1)===1!==Mt&&(It=n.neg(It)),{x:At,y:It}}else if(ft===l&&Et===4){const At=n.fromBytes(St.subarray(0,n.BYTES)),Nt=n.fromBytes(St.subarray(n.BYTES,2*n.BYTES));return{x:At,y:Nt}}else throw new Error(`Point of length ${ft} was invalid. Expected ${a} compressed bytes or ${l} uncompressed bytes`)}}),ot=ht=>bytesToHex$1(numberToBytesBE(ht,t.nByteLength));function yt(ht){const ft=s>>_1n$5;return ht>ft}function nt(ht){return yt(ht)?pe(-ht):ht}const st=(ht,ft,Et)=>bytesToNumberBE(ht.slice(ft,Et));class gt{constructor(ft,Et,St){this.r=ft,this.s=Et,this.recovery=St,this.assertValidity()}static fromCompact(ft){const Et=t.nByteLength;return ft=ensureBytes("compactSignature",ft,Et*2),new gt(st(ft,0,Et),st(ft,Et,2*Et))}static fromDER(ft){const{r:Et,s:St}=DER$1.toSig(ensureBytes("DER",ft));return new gt(Et,St)}assertValidity(){if(!tt(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!tt(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(ft){return new gt(this.r,this.s,ft)}recoverPublicKey(ft){const{r:Et,s:St,recovery:At}=this,Nt=Ct(ensureBytes("msgHash",ft));if(At==null||![0,1,2,3].includes(At))throw new Error("recovery id invalid");const It=At===2||At===3?Et+t.n:Et;if(It>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const Mt=At&1?"03":"02",jt=Be.fromHex(Mt+ot(It)),Ft=me(It),Ut=pe(-Nt*Ft),Ot=pe(St*Ft),Ht=Be.BASE.multiplyAndAddUnsafe(jt,Ut,Ot);if(!Ht)throw new Error("point at infinify");return Ht.assertValidity(),Ht}hasHighS(){return yt(this.s)}normalizeS(){return this.hasHighS()?new gt(this.r,pe(-this.s),this.recovery):this}toDERRawBytes(){return hexToBytes$1(this.toDERHex())}toDERHex(){return DER$1.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return hexToBytes$1(this.toCompactHex())}toCompactHex(){return ot(this.r)+ot(this.s)}}const wt={isValidPrivateKey(ht){try{return Le(ht),!0}catch{return!1}},normPrivateKeyToScalar:Le,randomPrivateKey:()=>{const ht=getMinHashLength$1(t.n);return mapHashToField$1(t.randomBytes(ht),t.n)},precompute(ht=8,ft=Be.BASE){return ft._setWindowSize(ht),ft.multiply(BigInt(3)),ft}};function vt(ht,ft=!0){return Be.fromPrivateKey(ht).toRawBytes(ft)}function Rt(ht){const ft=ht instanceof Uint8Array,Et=typeof ht=="string",St=(ft||Et)&&ht.length;return ft?St===a||St===l:Et?St===2*a||St===2*l:ht instanceof Be}function Bt(ht,ft,Et=!0){if(Rt(ht))throw new Error("first arg must be private key");if(!Rt(ft))throw new Error("second arg must be public key");return Be.fromHex(ft).multiply(Le(ht)).toRawBytes(Et)}const $t=t.bits2int||function(ht){const ft=bytesToNumberBE(ht),Et=ht.length*8-t.nBitLength;return Et>0?ft>>BigInt(Et):ft},Ct=t.bits2int_modN||function(ht){return pe($t(ht))},kt=bitMask(t.nBitLength);function Lt(ht){if(typeof ht!="bigint")throw new Error("bigint expected");if(!(_0n$5<=ht&&ht<kt))throw new Error(`bigint expected < 2^${t.nBitLength}`);return numberToBytesBE(ht,t.nByteLength)}function Pt(ht,ft,Et=mt){if(["recovered","canonical"].some(Dt=>Dt in Et))throw new Error("sign() legacy options not supported");const{hash:St,randomBytes:At}=t;let{lowS:Nt,prehash:It,extraEntropy:Mt}=Et;Nt==null&&(Nt=!0),ht=ensureBytes("msgHash",ht),It&&(ht=ensureBytes("prehashed msgHash",St(ht)));const jt=Ct(ht),Ft=Le(ft),Ut=[Lt(Ft),Lt(jt)];if(Mt!=null){const Dt=Mt===!0?At(n.BYTES):Mt;Ut.push(ensureBytes("extraEntropy",Dt))}const Ot=concatBytes$1(...Ut),Ht=jt;function Vt(Dt){const qt=$t(Dt);if(!tt(qt))return;const Wt=me(qt),zt=Be.BASE.multiply(qt).toAffine(),Gt=pe(zt.x);if(Gt===_0n$5)return;const Zt=pe(Wt*pe(Ht+Gt*Ft));if(Zt===_0n$5)return;let Kt=(zt.x===Gt?0:2)|Number(zt.y&_1n$5),en=Zt;return Nt&&yt(Zt)&&(en=nt(Zt),Kt^=1),new gt(Gt,en,Kt)}return{seed:Ot,k2sig:Vt}}const mt={lowS:t.lowS,prehash:!1},_t={lowS:t.lowS,prehash:!1};function Tt(ht,ft,Et=mt){const{seed:St,k2sig:At}=Pt(ht,ft,Et),Nt=t;return createHmacDrbg(Nt.hash.outputLen,Nt.nByteLength,Nt.hmac)(St,At)}Be.BASE._setWindowSize(8);function xt(ht,ft,Et,St=_t){var zt;const At=ht;if(ft=ensureBytes("msgHash",ft),Et=ensureBytes("publicKey",Et),"strict"in St)throw new Error("options.strict was renamed to lowS");const{lowS:Nt,prehash:It}=St;let Mt,jt;try{if(typeof At=="string"||At instanceof Uint8Array)try{Mt=gt.fromDER(At)}catch(Gt){if(!(Gt instanceof DER$1.Err))throw Gt;Mt=gt.fromCompact(At)}else if(typeof At=="object"&&typeof At.r=="bigint"&&typeof At.s=="bigint"){const{r:Gt,s:Zt}=At;Mt=new gt(Gt,Zt)}else throw new Error("PARSE");jt=Be.fromHex(Et)}catch(Gt){if(Gt.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(Nt&&Mt.hasHighS())return!1;It&&(ft=t.hash(ft));const{r:Ft,s:Ut}=Mt,Ot=Ct(ft),Ht=me(Ut),Vt=pe(Ot*Ht),Dt=pe(Ft*Ht),qt=(zt=Be.BASE.multiplyAndAddUnsafe(jt,Vt,Dt))==null?void 0:zt.toAffine();return qt?pe(qt.x)===Ft:!1}return{CURVE:t,getPublicKey:vt,getSharedSecret:Bt,sign:Tt,verify:xt,ProjectivePoint:Be,Signature:gt,utils:wt}}let HMAC$1=class extends Hash$1{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,hash$1(t);const s=toBytes$1(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const a=this.blockLen,l=new Uint8Array(a);l.set(s.length>a?t.create().update(s).digest():s);for(let de=0;de<l.length;de++)l[de]^=54;this.iHash.update(l),this.oHash=t.create();for(let de=0;de<l.length;de++)l[de]^=106;this.oHash.update(l),l.fill(0)}update(t){return exists$1(this),this.iHash.update(t),this}digestInto(t){exists$1(this),bytes$2(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:s,finished:a,destroyed:l,blockLen:de,outputLen:pe}=this;return t=t,t.finished=a,t.destroyed=l,t.blockLen=de,t.outputLen=pe,t.oHash=n._cloneInto(t.oHash),t.iHash=s._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const hmac$1=(e,t,n)=>new HMAC$1(e,t).update(n).digest();hmac$1.create=(e,t)=>new HMAC$1(e,t);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function getHash$1(e){return{hash:e,hmac:(t,...n)=>hmac$1(e,t,concatBytes$2(...n)),randomBytes:randomBytes$1}}function createCurve$1(e,t){const n=s=>weierstrass$1({...e,...getHash$1(s)});return Object.freeze({...n(t),create:n})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const secp256k1P$1=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),secp256k1N$1=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),_1n$4=BigInt(1),_2n$2=BigInt(2),divNearest$1=(e,t)=>(e+t/_2n$2)/t;function sqrtMod$1(e){const t=secp256k1P$1,n=BigInt(3),s=BigInt(6),a=BigInt(11),l=BigInt(22),de=BigInt(23),pe=BigInt(44),me=BigInt(88),Be=e*e*e%t,Le=Be*Be*e%t,Ye=pow2$1(Le,n,t)*Le%t,tt=pow2$1(Ye,n,t)*Le%t,ot=pow2$1(tt,_2n$2,t)*Be%t,yt=pow2$1(ot,a,t)*ot%t,nt=pow2$1(yt,l,t)*yt%t,st=pow2$1(nt,pe,t)*nt%t,gt=pow2$1(st,me,t)*st%t,wt=pow2$1(gt,pe,t)*nt%t,vt=pow2$1(wt,n,t)*Le%t,Rt=pow2$1(vt,de,t)*yt%t,Bt=pow2$1(Rt,s,t)*Be%t,$t=pow2$1(Bt,_2n$2,t);if(!Fp$1.eql(Fp$1.sqr($t),e))throw new Error("Cannot find square root");return $t}const Fp$1=Field$1(secp256k1P$1,void 0,void 0,{sqrt:sqrtMod$1}),secp256k1$1=createCurve$1({a:BigInt(0),b:BigInt(7),Fp:Fp$1,n:secp256k1N$1,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=secp256k1N$1,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),s=-_1n$4*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),a=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),l=n,de=BigInt("0x100000000000000000000000000000000"),pe=divNearest$1(l*e,t),me=divNearest$1(-s*e,t);let Be=mod$1(e-pe*n-me*a,t),Le=mod$1(-pe*s-me*l,t);const Ye=Be>de,tt=Le>de;if(Ye&&(Be=t-Be),tt&&(Le=t-Le),Be>de||Le>de)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:Ye,k1:Be,k2neg:tt,k2:Le}}}},sha256$1),_0n$4=BigInt(0),fe=e=>typeof e=="bigint"&&_0n$4<e&&e<secp256k1P$1,ge=e=>typeof e=="bigint"&&_0n$4<e&&e<secp256k1N$1,TAGGED_HASH_PREFIXES$1={};function taggedHash$1(e,...t){let n=TAGGED_HASH_PREFIXES$1[e];if(n===void 0){const s=sha256$1(Uint8Array.from(e,a=>a.charCodeAt(0)));n=concatBytes$1(s,s),TAGGED_HASH_PREFIXES$1[e]=n}return sha256$1(concatBytes$1(n,...t))}const pointToBytes$1=e=>e.toRawBytes(!0).slice(1),numTo32b$1=e=>numberToBytesBE(e,32),modP$1=e=>mod$1(e,secp256k1P$1),modN$1=e=>mod$1(e,secp256k1N$1),Point$1=secp256k1$1.ProjectivePoint,GmulAdd$1=(e,t,n)=>Point$1.BASE.multiplyAndAddUnsafe(e,t,n);function schnorrGetExtPubKey$1(e){let t=secp256k1$1.utils.normPrivateKeyToScalar(e),n=Point$1.fromPrivateKey(t);return{scalar:n.hasEvenY()?t:modN$1(-t),bytes:pointToBytes$1(n)}}function lift_x$1(e){if(!fe(e))throw new Error("bad x: need 0 < x < p");const t=modP$1(e*e),n=modP$1(t*e+BigInt(7));let s=sqrtMod$1(n);s%_2n$2!==_0n$4&&(s=modP$1(-s));const a=new Point$1(e,s,_1n$4);return a.assertValidity(),a}function challenge$1(...e){return modN$1(bytesToNumberBE(taggedHash$1("BIP0340/challenge",...e)))}function schnorrGetPublicKey$1(e){return schnorrGetExtPubKey$1(e).bytes}function schnorrSign$1(e,t,n=randomBytes$1(32)){const s=ensureBytes("message",e),{bytes:a,scalar:l}=schnorrGetExtPubKey$1(t),de=ensureBytes("auxRand",n,32),pe=numTo32b$1(l^bytesToNumberBE(taggedHash$1("BIP0340/aux",de))),me=taggedHash$1("BIP0340/nonce",pe,a,s),Be=modN$1(bytesToNumberBE(me));if(Be===_0n$4)throw new Error("sign failed: k is zero");const{bytes:Le,scalar:Ye}=schnorrGetExtPubKey$1(Be),tt=challenge$1(Le,a,s),ot=new Uint8Array(64);if(ot.set(Le,0),ot.set(numTo32b$1(modN$1(Ye+tt*l)),32),!schnorrVerify$1(ot,s,a))throw new Error("sign: Invalid signature produced");return ot}function schnorrVerify$1(e,t,n){const s=ensureBytes("signature",e,64),a=ensureBytes("message",t),l=ensureBytes("publicKey",n,32);try{const de=lift_x$1(bytesToNumberBE(l)),pe=bytesToNumberBE(s.subarray(0,32));if(!fe(pe))return!1;const me=bytesToNumberBE(s.subarray(32,64));if(!ge(me))return!1;const Be=challenge$1(numTo32b$1(pe),pointToBytes$1(de),a),Le=GmulAdd$1(de,me,modN$1(-Be));return!(!Le||!Le.hasEvenY()||Le.toAffine().x!==pe)}catch{return!1}}const schnorr$1={getPublicKey:schnorrGetPublicKey$1,sign:schnorrSign$1,verify:schnorrVerify$1,utils:{randomPrivateKey:secp256k1$1.utils.randomPrivateKey,lift_x:lift_x$1,pointToBytes:pointToBytes$1,numberToBytesBE,bytesToNumberBE,taggedHash:taggedHash$1,mod:mod$1}},crypto$1=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const u8a=e=>e instanceof Uint8Array,createView=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),rotr=(e,t)=>e<<32-t|e>>>t,isLE$1=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!isLE$1)throw new Error("Non little-endian hardware is not supported");const hexes=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function bytesToHex(e){if(!u8a(e))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=hexes[e[n]];return t}function hexToBytes(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);const t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(t/2);for(let s=0;s<n.length;s++){const a=s*2,l=e.slice(a,a+2),de=Number.parseInt(l,16);if(Number.isNaN(de)||de<0)throw new Error("Invalid byte sequence");n[s]=de}return n}function utf8ToBytes(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function toBytes(e){if(typeof e=="string"&&(e=utf8ToBytes(e)),!u8a(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}function concatBytes(...e){const t=new Uint8Array(e.reduce((s,a)=>s+a.length,0));let n=0;return e.forEach(s=>{if(!u8a(s))throw new Error("Uint8Array expected");t.set(s,n),n+=s.length}),t}class Hash{clone(){return this._cloneInto()}}function wrapConstructor(e){const t=s=>e().update(toBytes(s)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function randomBytes(e=32){if(crypto$1&&typeof crypto$1.getRandomValues=="function")return crypto$1.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}function number$1(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function bool$1(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}function bytes$1(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function hash(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");number$1(e.outputLen),number$1(e.blockLen)}function exists(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function output(e,t){bytes$1(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const assert={number:number$1,bool:bool$1,bytes:bytes$1,hash,exists,output};function setBigUint64(e,t,n,s){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,s);const a=BigInt(32),l=BigInt(4294967295),de=Number(n>>a&l),pe=Number(n&l),me=s?4:0,Be=s?0:4;e.setUint32(t+me,de,s),e.setUint32(t+Be,pe,s)}class SHA2 extends Hash{constructor(t,n,s,a){super(),this.blockLen=t,this.outputLen=n,this.padOffset=s,this.isLE=a,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=createView(this.buffer)}update(t){assert.exists(this);const{view:n,buffer:s,blockLen:a}=this;t=toBytes(t);const l=t.length;for(let de=0;de<l;){const pe=Math.min(a-this.pos,l-de);if(pe===a){const me=createView(t);for(;a<=l-de;de+=a)this.process(me,de);continue}s.set(t.subarray(de,de+pe),this.pos),this.pos+=pe,de+=pe,this.pos===a&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){assert.exists(this),assert.output(t,this),this.finished=!0;const{buffer:n,view:s,blockLen:a,isLE:l}=this;let{pos:de}=this;n[de++]=128,this.buffer.subarray(de).fill(0),this.padOffset>a-de&&(this.process(s,0),de=0);for(let Ye=de;Ye<a;Ye++)n[Ye]=0;setBigUint64(s,a-8,BigInt(this.length*8),l),this.process(s,0);const pe=createView(t),me=this.outputLen;if(me%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const Be=me/4,Le=this.get();if(Be>Le.length)throw new Error("_sha2: outputLen bigger than state");for(let Ye=0;Ye<Be;Ye++)pe.setUint32(4*Ye,Le[Ye],l)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const s=t.slice(0,n);return this.destroy(),s}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:s,length:a,finished:l,destroyed:de,pos:pe}=this;return t.length=a,t.pos=pe,t.finished=l,t.destroyed=de,a%n&&t.buffer.set(s),t}}const Chi=(e,t,n)=>e&t^~e&n,Maj=(e,t,n)=>e&t^e&n^t&n,SHA256_K=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),IV=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_W=new Uint32Array(64);class SHA256 extends SHA2{constructor(){super(64,32,8,!1),this.A=IV[0]|0,this.B=IV[1]|0,this.C=IV[2]|0,this.D=IV[3]|0,this.E=IV[4]|0,this.F=IV[5]|0,this.G=IV[6]|0,this.H=IV[7]|0}get(){const{A:t,B:n,C:s,D:a,E:l,F:de,G:pe,H:me}=this;return[t,n,s,a,l,de,pe,me]}set(t,n,s,a,l,de,pe,me){this.A=t|0,this.B=n|0,this.C=s|0,this.D=a|0,this.E=l|0,this.F=de|0,this.G=pe|0,this.H=me|0}process(t,n){for(let Ye=0;Ye<16;Ye++,n+=4)SHA256_W[Ye]=t.getUint32(n,!1);for(let Ye=16;Ye<64;Ye++){const tt=SHA256_W[Ye-15],ot=SHA256_W[Ye-2],yt=rotr(tt,7)^rotr(tt,18)^tt>>>3,nt=rotr(ot,17)^rotr(ot,19)^ot>>>10;SHA256_W[Ye]=nt+SHA256_W[Ye-7]+yt+SHA256_W[Ye-16]|0}let{A:s,B:a,C:l,D:de,E:pe,F:me,G:Be,H:Le}=this;for(let Ye=0;Ye<64;Ye++){const tt=rotr(pe,6)^rotr(pe,11)^rotr(pe,25),ot=Le+tt+Chi(pe,me,Be)+SHA256_K[Ye]+SHA256_W[Ye]|0,nt=(rotr(s,2)^rotr(s,13)^rotr(s,22))+Maj(s,a,l)|0;Le=Be,Be=me,me=pe,pe=de+ot|0,de=l,l=a,a=s,s=ot+nt|0}s=s+this.A|0,a=a+this.B|0,l=l+this.C|0,de=de+this.D|0,pe=pe+this.E|0,me=me+this.F|0,Be=Be+this.G|0,Le=Le+this.H|0,this.set(s,a,l,de,pe,me,Be,Le)}roundClean(){SHA256_W.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class SHA224 extends SHA256{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const sha256=wrapConstructor(()=>new SHA256);wrapConstructor(()=>new SHA224);/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function assertNumber(e){if(!Number.isSafeInteger(e))throw new Error(`Wrong integer: ${e}`)}function chain(...e){const t=(a,l)=>de=>a(l(de)),n=Array.from(e).reverse().reduce((a,l)=>a?t(a,l.encode):l.encode,void 0),s=e.reduce((a,l)=>a?t(a,l.decode):l.decode,void 0);return{encode:n,decode:s}}function alphabet(e){return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return t.map(n=>{if(assertNumber(n),n<0||n>=e.length)throw new Error(`Digit index outside alphabet: ${n} (alphabet: ${e.length})`);return e[n]})},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("alphabet.decode input should be array of strings");return t.map(n=>{if(typeof n!="string")throw new Error(`alphabet.decode: not string element=${n}`);const s=e.indexOf(n);if(s===-1)throw new Error(`Unknown letter: "${n}". Allowed: ${e}`);return s})}}}function join(e=""){if(typeof e!="string")throw new Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("join.encode input should be array of strings");for(let n of t)if(typeof n!="string")throw new Error(`join.encode: non-string input=${n}`);return t.join(e)},decode:t=>{if(typeof t!="string")throw new Error("join.decode input should be string");return t.split(e)}}}function padding(e,t="="){if(assertNumber(e),typeof t!="string")throw new Error("padding chr should be string");return{encode(n){if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("padding.encode input should be array of strings");for(let s of n)if(typeof s!="string")throw new Error(`padding.encode: non-string input=${s}`);for(;n.length*e%8;)n.push(t);return n},decode(n){if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("padding.encode input should be array of strings");for(let a of n)if(typeof a!="string")throw new Error(`padding.decode: non-string input=${a}`);let s=n.length;if(s*e%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;s>0&&n[s-1]===t;s--)if(!((s-1)*e%8))throw new Error("Invalid padding: string has too much padding");return n.slice(0,s)}}}function normalize$1(e){if(typeof e!="function")throw new Error("normalize fn should be function");return{encode:t=>t,decode:t=>e(t)}}function convertRadix(e,t,n){if(t<2)throw new Error(`convertRadix: wrong from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: wrong to=${n}, base cannot be less than 2`);if(!Array.isArray(e))throw new Error("convertRadix: data should be array");if(!e.length)return[];let s=0;const a=[],l=Array.from(e);for(l.forEach(de=>{if(assertNumber(de),de<0||de>=t)throw new Error(`Wrong integer: ${de}`)});;){let de=0,pe=!0;for(let me=s;me<l.length;me++){const Be=l[me],Le=t*de+Be;if(!Number.isSafeInteger(Le)||t*de/t!==de||Le-Be!==t*de)throw new Error("convertRadix: carry overflow");if(de=Le%n,l[me]=Math.floor(Le/n),!Number.isSafeInteger(l[me])||l[me]*n+de!==Le)throw new Error("convertRadix: carry overflow");if(pe)l[me]?pe=!1:s=me;else continue}if(a.push(de),pe)break}for(let de=0;de<e.length-1&&e[de]===0;de++)a.push(0);return a.reverse()}const gcd=(e,t)=>t?gcd(t,e%t):e,radix2carry=(e,t)=>e+(t-gcd(e,t));function convertRadix2(e,t,n,s){if(!Array.isArray(e))throw new Error("convertRadix2: data should be array");if(t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(radix2carry(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${radix2carry(t,n)}`);let a=0,l=0;const de=2**n-1,pe=[];for(const me of e){if(assertNumber(me),me>=2**t)throw new Error(`convertRadix2: invalid data word=${me} from=${t}`);if(a=a<<t|me,l+t>32)throw new Error(`convertRadix2: carry overflow pos=${l} from=${t}`);for(l+=t;l>=n;l-=n)pe.push((a>>l-n&de)>>>0);a&=2**l-1}if(a=a<<n-l&de,!s&&l>=t)throw new Error("Excess padding");if(!s&&a)throw new Error(`Non-zero padding: ${a}`);return s&&l>0&&pe.push(a>>>0),pe}function radix(e){return assertNumber(e),{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return convertRadix(Array.from(t),2**8,e)},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(convertRadix(t,e,2**8))}}}function radix2(e,t=!1){if(assertNumber(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(radix2carry(8,e)>32||radix2carry(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!(n instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return convertRadix2(Array.from(n),8,e,!t)},decode:n=>{if(!Array.isArray(n)||n.length&&typeof n[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(convertRadix2(n,e,8,t))}}}function unsafeWrapper(e){if(typeof e!="function")throw new Error("unsafeWrapper fn should be function");return function(...t){try{return e.apply(null,t)}catch{}}}const base16=chain(radix2(4),alphabet("0123456789ABCDEF"),join("")),base32=chain(radix2(5),alphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),padding(5),join(""));chain(radix2(5),alphabet("0123456789ABCDEFGHIJKLMNOPQRSTUV"),padding(5),join(""));chain(radix2(5),alphabet("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),join(""),normalize$1(e=>e.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")));const base64=chain(radix2(6),alphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),padding(6),join("")),base64url=chain(radix2(6),alphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),padding(6),join("")),genBase58=e=>chain(radix(58),alphabet(e),join("")),base58=genBase58("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");genBase58("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ");genBase58("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const XMR_BLOCK_LEN=[0,2,3,5,6,7,9,10,11],base58xmr={encode(e){let t="";for(let n=0;n<e.length;n+=8){const s=e.subarray(n,n+8);t+=base58.encode(s).padStart(XMR_BLOCK_LEN[s.length],"1")}return t},decode(e){let t=[];for(let n=0;n<e.length;n+=11){const s=e.slice(n,n+11),a=XMR_BLOCK_LEN.indexOf(s.length),l=base58.decode(s);for(let de=0;de<l.length-a;de++)if(l[de]!==0)throw new Error("base58xmr: wrong padding");t=t.concat(Array.from(l.slice(l.length-a)))}return Uint8Array.from(t)}},BECH_ALPHABET=chain(alphabet("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),join("")),POLYMOD_GENERATORS=[996825010,642813549,513874426,1027748829,705979059];function bech32Polymod(e){const t=e>>25;let n=(e&33554431)<<5;for(let s=0;s<POLYMOD_GENERATORS.length;s++)(t>>s&1)===1&&(n^=POLYMOD_GENERATORS[s]);return n}function bechChecksum(e,t,n=1){const s=e.length;let a=1;for(let l=0;l<s;l++){const de=e.charCodeAt(l);if(de<33||de>126)throw new Error(`Invalid prefix (${e})`);a=bech32Polymod(a)^de>>5}a=bech32Polymod(a);for(let l=0;l<s;l++)a=bech32Polymod(a)^e.charCodeAt(l)&31;for(let l of t)a=bech32Polymod(a)^l;for(let l=0;l<6;l++)a=bech32Polymod(a);return a^=n,BECH_ALPHABET.encode(convertRadix2([a%2**30],30,5,!1))}function genBech32(e){const t=e==="bech32"?1:734539939,n=radix2(5),s=n.decode,a=n.encode,l=unsafeWrapper(s);function de(Le,Ye,tt=90){if(typeof Le!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof Le}`);if(!Array.isArray(Ye)||Ye.length&&typeof Ye[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof Ye}`);const ot=Le.length+7+Ye.length;if(tt!==!1&&ot>tt)throw new TypeError(`Length ${ot} exceeds limit ${tt}`);return Le=Le.toLowerCase(),`${Le}1${BECH_ALPHABET.encode(Ye)}${bechChecksum(Le,Ye,t)}`}function pe(Le,Ye=90){if(typeof Le!="string")throw new Error(`bech32.decode input should be string, not ${typeof Le}`);if(Le.length<8||Ye!==!1&&Le.length>Ye)throw new TypeError(`Wrong string length: ${Le.length} (${Le}). Expected (8..${Ye})`);const tt=Le.toLowerCase();if(Le!==tt&&Le!==Le.toUpperCase())throw new Error("String must be lowercase or uppercase");Le=tt;const ot=Le.lastIndexOf("1");if(ot===0||ot===-1)throw new Error('Letter "1" must be present between prefix and data only');const yt=Le.slice(0,ot),nt=Le.slice(ot+1);if(nt.length<6)throw new Error("Data must be at least 6 characters long");const st=BECH_ALPHABET.decode(nt).slice(0,-6),gt=bechChecksum(yt,st,t);if(!nt.endsWith(gt))throw new Error(`Invalid checksum in ${Le}: expected "${gt}"`);return{prefix:yt,words:st}}const me=unsafeWrapper(pe);function Be(Le){const{prefix:Ye,words:tt}=pe(Le,!1);return{prefix:Ye,words:tt,bytes:s(tt)}}return{encode:de,decode:pe,decodeToBytes:Be,decodeUnsafe:me,fromWords:s,fromWordsUnsafe:l,toWords:a}}const bech32$1=genBech32("bech32");genBech32("bech32m");const utf8$1={encode:e=>new TextDecoder().decode(e),decode:e=>new TextEncoder().encode(e)},hex$1=chain(radix2(4),alphabet("0123456789abcdef"),join(""),normalize$1(e=>{if(typeof e!="string"||e.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()})),CODERS={utf8:utf8$1,hex:hex$1,base16,base32,base64,base64url,base58,base58xmr};`${Object.keys(CODERS).join(", ")}`;function number(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`positive integer expected, not ${e}`)}function bool(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}function isBytes(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function bytes(e,...t){if(!isBytes(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */const u32=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!isLE)throw new Error("Non little-endian hardware is not supported");function checkOpts(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}function equalBytes(e,t){if(e.length!==t.length)return!1;let n=0;for(let s=0;s<e.length;s++)n|=e[s]^t[s];return n===0}const wrapCipher=(e,t)=>(Object.assign(t,e),t),BLOCK_SIZE=16,POLY=283;function mul2(e){return e<<1^POLY&-(e>>7)}function mul(e,t){let n=0;for(;t>0;t>>=1)n^=e&-(t&1),e=mul2(e);return n}const sbox=(()=>{let e=new Uint8Array(256);for(let n=0,s=1;n<256;n++,s^=mul2(s))e[n]=s;const t=new Uint8Array(256);t[0]=99;for(let n=0;n<255;n++){let s=e[255-n];s|=s<<8,t[e[n]]=(s^s>>4^s>>5^s>>6^s>>7^99)&255}return t})(),invSbox=sbox.map((e,t)=>sbox.indexOf(t)),rotr32_8=e=>e<<24|e>>>8,rotl32_8=e=>e<<8|e>>>24;function genTtable(e,t){if(e.length!==256)throw new Error("Wrong sbox length");const n=new Uint32Array(256).map((Be,Le)=>t(e[Le])),s=n.map(rotl32_8),a=s.map(rotl32_8),l=a.map(rotl32_8),de=new Uint32Array(256*256),pe=new Uint32Array(256*256),me=new Uint16Array(256*256);for(let Be=0;Be<256;Be++)for(let Le=0;Le<256;Le++){const Ye=Be*256+Le;de[Ye]=n[Be]^s[Le],pe[Ye]=a[Be]^l[Le],me[Ye]=e[Be]<<8|e[Le]}return{sbox:e,sbox2:me,T0:n,T1:s,T2:a,T3:l,T01:de,T23:pe}}const tableEncoding=genTtable(sbox,e=>mul(e,3)<<24|e<<16|e<<8|mul(e,2)),tableDecoding=genTtable(invSbox,e=>mul(e,11)<<24|mul(e,13)<<16|mul(e,9)<<8|mul(e,14)),xPowers=(()=>{const e=new Uint8Array(16);for(let t=0,n=1;t<16;t++,n=mul2(n))e[t]=n;return e})();function expandKeyLE(e){bytes(e);const t=e.length;if(![16,24,32].includes(t))throw new Error(`aes: wrong key size: should be 16, 24 or 32, got: ${t}`);const{sbox2:n}=tableEncoding,s=u32(e),a=s.length,l=pe=>applySbox(n,pe,pe,pe,pe),de=new Uint32Array(t+28);de.set(s);for(let pe=a;pe<de.length;pe++){let me=de[pe-1];pe%a===0?me=l(rotr32_8(me))^xPowers[pe/a-1]:a>6&&pe%a===4&&(me=l(me)),de[pe]=de[pe-a]^me}return de}function expandKeyDecLE(e){const t=expandKeyLE(e),n=t.slice(),s=t.length,{sbox2:a}=tableEncoding,{T0:l,T1:de,T2:pe,T3:me}=tableDecoding;for(let Be=0;Be<s;Be+=4)for(let Le=0;Le<4;Le++)n[Be+Le]=t[s-Be-4+Le];t.fill(0);for(let Be=4;Be<s-4;Be++){const Le=n[Be],Ye=applySbox(a,Le,Le,Le,Le);n[Be]=l[Ye&255]^de[Ye>>>8&255]^pe[Ye>>>16&255]^me[Ye>>>24]}return n}function apply0123(e,t,n,s,a,l){return e[n<<8&65280|s>>>8&255]^t[a>>>8&65280|l>>>24&255]}function applySbox(e,t,n,s,a){return e[t&255|n&65280]|e[s>>>16&255|a>>>16&65280]<<16}function encrypt$2(e,t,n,s,a){const{sbox2:l,T01:de,T23:pe}=tableEncoding;let me=0;t^=e[me++],n^=e[me++],s^=e[me++],a^=e[me++];const Be=e.length/4-2;for(let yt=0;yt<Be;yt++){const nt=e[me++]^apply0123(de,pe,t,n,s,a),st=e[me++]^apply0123(de,pe,n,s,a,t),gt=e[me++]^apply0123(de,pe,s,a,t,n),wt=e[me++]^apply0123(de,pe,a,t,n,s);t=nt,n=st,s=gt,a=wt}const Le=e[me++]^applySbox(l,t,n,s,a),Ye=e[me++]^applySbox(l,n,s,a,t),tt=e[me++]^applySbox(l,s,a,t,n),ot=e[me++]^applySbox(l,a,t,n,s);return{s0:Le,s1:Ye,s2:tt,s3:ot}}function decrypt$2(e,t,n,s,a){const{sbox2:l,T01:de,T23:pe}=tableDecoding;let me=0;t^=e[me++],n^=e[me++],s^=e[me++],a^=e[me++];const Be=e.length/4-2;for(let yt=0;yt<Be;yt++){const nt=e[me++]^apply0123(de,pe,t,a,s,n),st=e[me++]^apply0123(de,pe,n,t,a,s),gt=e[me++]^apply0123(de,pe,s,n,t,a),wt=e[me++]^apply0123(de,pe,a,s,n,t);t=nt,n=st,s=gt,a=wt}const Le=e[me++]^applySbox(l,t,a,s,n),Ye=e[me++]^applySbox(l,n,t,a,s),tt=e[me++]^applySbox(l,s,n,t,a),ot=e[me++]^applySbox(l,a,s,n,t);return{s0:Le,s1:Ye,s2:tt,s3:ot}}function getDst(e,t){if(!t)return new Uint8Array(e);if(bytes(t),t.length<e)throw new Error(`aes: wrong destination length, expected at least ${e}, got: ${t.length}`);return t}function validateBlockDecrypt(e){if(bytes(e),e.length%BLOCK_SIZE!==0)throw new Error(`aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size ${BLOCK_SIZE}`)}function validateBlockEncrypt(e,t,n){let s=e.length;const a=s%BLOCK_SIZE;if(!t&&a!==0)throw new Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");const l=u32(e);if(t){let me=BLOCK_SIZE-a;me||(me=BLOCK_SIZE),s=s+me}const de=getDst(s,n),pe=u32(de);return{b:l,o:pe,out:de}}function validatePCKS(e,t){if(!t)return e;const n=e.length;if(!n)throw new Error("aes/pcks5: empty ciphertext not allowed");const s=e[n-1];if(s<=0||s>16)throw new Error(`aes/pcks5: wrong padding byte: ${s}`);const a=e.subarray(0,-s);for(let l=0;l<s;l++)if(e[n-l-1]!==s)throw new Error("aes/pcks5: wrong padding");return a}function padPCKS(e){const t=new Uint8Array(16),n=u32(t);t.set(e);const s=BLOCK_SIZE-e.length;for(let a=BLOCK_SIZE-s;a<BLOCK_SIZE;a++)t[a]=s;return n}const cbc=wrapCipher({blockSize:16,nonceLength:16},function(t,n,s={}){bytes(t),bytes(n,16);const a=!s.disablePadding;return{encrypt:(l,de)=>{const pe=expandKeyLE(t),{b:me,o:Be,out:Le}=validateBlockEncrypt(l,a,de),Ye=u32(n);let tt=Ye[0],ot=Ye[1],yt=Ye[2],nt=Ye[3],st=0;for(;st+4<=me.length;)tt^=me[st+0],ot^=me[st+1],yt^=me[st+2],nt^=me[st+3],{s0:tt,s1:ot,s2:yt,s3:nt}=encrypt$2(pe,tt,ot,yt,nt),Be[st++]=tt,Be[st++]=ot,Be[st++]=yt,Be[st++]=nt;if(a){const gt=padPCKS(l.subarray(st*4));tt^=gt[0],ot^=gt[1],yt^=gt[2],nt^=gt[3],{s0:tt,s1:ot,s2:yt,s3:nt}=encrypt$2(pe,tt,ot,yt,nt),Be[st++]=tt,Be[st++]=ot,Be[st++]=yt,Be[st++]=nt}return pe.fill(0),Le},decrypt:(l,de)=>{validateBlockDecrypt(l);const pe=expandKeyDecLE(t),me=u32(n),Be=getDst(l.length,de),Le=u32(l),Ye=u32(Be);let tt=me[0],ot=me[1],yt=me[2],nt=me[3];for(let st=0;st+4<=Le.length;){const gt=tt,wt=ot,vt=yt,Rt=nt;tt=Le[st+0],ot=Le[st+1],yt=Le[st+2],nt=Le[st+3];const{s0:Bt,s1:$t,s2:Ct,s3:kt}=decrypt$2(pe,tt,ot,yt,nt);Ye[st++]=Bt^gt,Ye[st++]=$t^wt,Ye[st++]=Ct^vt,Ye[st++]=kt^Rt}return pe.fill(0),validatePCKS(Be,a)}}}),_utf8ToBytes=e=>Uint8Array.from(e.split("").map(t=>t.charCodeAt(0))),sigma16=_utf8ToBytes("expand 16-byte k"),sigma32=_utf8ToBytes("expand 32-byte k"),sigma16_32=u32(sigma16),sigma32_32=u32(sigma32);sigma32_32.slice();function rotl(e,t){return e<<t|e>>>32-t}function isAligned32(e){return e.byteOffset%4===0}const BLOCK_LEN=64,BLOCK_LEN32=16,MAX_COUNTER=2**32-1,U32_EMPTY=new Uint32Array;function runCipher(e,t,n,s,a,l,de,pe){const me=a.length,Be=new Uint8Array(BLOCK_LEN),Le=u32(Be),Ye=isAligned32(a)&&isAligned32(l),tt=Ye?u32(a):U32_EMPTY,ot=Ye?u32(l):U32_EMPTY;for(let yt=0;yt<me;de++){if(e(t,n,s,Le,de,pe),de>=MAX_COUNTER)throw new Error("arx: counter overflow");const nt=Math.min(BLOCK_LEN,me-yt);if(Ye&&nt===BLOCK_LEN){const st=yt/4;if(yt%4!==0)throw new Error("arx: invalid block position");for(let gt=0,wt;gt<BLOCK_LEN32;gt++)wt=st+gt,ot[wt]=tt[wt]^Le[gt];yt+=BLOCK_LEN;continue}for(let st=0,gt;st<nt;st++)gt=yt+st,l[gt]=a[gt]^Be[st];yt+=nt}}function createCipher(e,t){const{allowShortKeys:n,extendNonceFn:s,counterLength:a,counterRight:l,rounds:de}=checkOpts({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return number(a),number(de),bool(l),bool(n),(pe,me,Be,Le,Ye=0)=>{bytes(pe),bytes(me),bytes(Be);const tt=Be.length;if(Le||(Le=new Uint8Array(tt)),bytes(Le),number(Ye),Ye<0||Ye>=MAX_COUNTER)throw new Error("arx: counter overflow");if(Le.length<tt)throw new Error(`arx: output (${Le.length}) is shorter than data (${tt})`);const ot=[];let yt=pe.length,nt,st;if(yt===32)nt=pe.slice(),ot.push(nt),st=sigma32_32;else if(yt===16&&n)nt=new Uint8Array(32),nt.set(pe),nt.set(pe,16),st=sigma16_32,ot.push(nt);else throw new Error(`arx: invalid 32-byte key, got length=${yt}`);isAligned32(me)||(me=me.slice(),ot.push(me));const gt=u32(nt);if(s){if(me.length!==24)throw new Error("arx: extended nonce must be 24 bytes");s(st,gt,u32(me.subarray(0,16)),gt),me=me.subarray(16)}const wt=16-a;if(wt!==me.length)throw new Error(`arx: nonce must be ${wt} or 16 bytes`);if(wt!==12){const Rt=new Uint8Array(12);Rt.set(me,l?0:12-me.length),me=Rt,ot.push(me)}const vt=u32(me);for(runCipher(e,st,gt,vt,Be,Le,Ye,de);ot.length>0;)ot.pop().fill(0);return Le}}function chachaCore(e,t,n,s,a,l=20){let de=e[0],pe=e[1],me=e[2],Be=e[3],Le=t[0],Ye=t[1],tt=t[2],ot=t[3],yt=t[4],nt=t[5],st=t[6],gt=t[7],wt=a,vt=n[0],Rt=n[1],Bt=n[2],$t=de,Ct=pe,kt=me,Lt=Be,Pt=Le,mt=Ye,_t=tt,Tt=ot,xt=yt,ht=nt,ft=st,Et=gt,St=wt,At=vt,Nt=Rt,It=Bt;for(let jt=0;jt<l;jt+=2)$t=$t+Pt|0,St=rotl(St^$t,16),xt=xt+St|0,Pt=rotl(Pt^xt,12),$t=$t+Pt|0,St=rotl(St^$t,8),xt=xt+St|0,Pt=rotl(Pt^xt,7),Ct=Ct+mt|0,At=rotl(At^Ct,16),ht=ht+At|0,mt=rotl(mt^ht,12),Ct=Ct+mt|0,At=rotl(At^Ct,8),ht=ht+At|0,mt=rotl(mt^ht,7),kt=kt+_t|0,Nt=rotl(Nt^kt,16),ft=ft+Nt|0,_t=rotl(_t^ft,12),kt=kt+_t|0,Nt=rotl(Nt^kt,8),ft=ft+Nt|0,_t=rotl(_t^ft,7),Lt=Lt+Tt|0,It=rotl(It^Lt,16),Et=Et+It|0,Tt=rotl(Tt^Et,12),Lt=Lt+Tt|0,It=rotl(It^Lt,8),Et=Et+It|0,Tt=rotl(Tt^Et,7),$t=$t+mt|0,It=rotl(It^$t,16),ft=ft+It|0,mt=rotl(mt^ft,12),$t=$t+mt|0,It=rotl(It^$t,8),ft=ft+It|0,mt=rotl(mt^ft,7),Ct=Ct+_t|0,St=rotl(St^Ct,16),Et=Et+St|0,_t=rotl(_t^Et,12),Ct=Ct+_t|0,St=rotl(St^Ct,8),Et=Et+St|0,_t=rotl(_t^Et,7),kt=kt+Tt|0,At=rotl(At^kt,16),xt=xt+At|0,Tt=rotl(Tt^xt,12),kt=kt+Tt|0,At=rotl(At^kt,8),xt=xt+At|0,Tt=rotl(Tt^xt,7),Lt=Lt+Pt|0,Nt=rotl(Nt^Lt,16),ht=ht+Nt|0,Pt=rotl(Pt^ht,12),Lt=Lt+Pt|0,Nt=rotl(Nt^Lt,8),ht=ht+Nt|0,Pt=rotl(Pt^ht,7);let Mt=0;s[Mt++]=de+$t|0,s[Mt++]=pe+Ct|0,s[Mt++]=me+kt|0,s[Mt++]=Be+Lt|0,s[Mt++]=Le+Pt|0,s[Mt++]=Ye+mt|0,s[Mt++]=tt+_t|0,s[Mt++]=ot+Tt|0,s[Mt++]=yt+xt|0,s[Mt++]=nt+ht|0,s[Mt++]=st+ft|0,s[Mt++]=gt+Et|0,s[Mt++]=wt+St|0,s[Mt++]=vt+At|0,s[Mt++]=Rt+Nt|0,s[Mt++]=Bt+It|0}const chacha20=createCipher(chachaCore,{counterRight:!1,counterLength:4,allowShortKeys:!1});class HMAC extends Hash{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,assert.hash(t);const s=toBytes(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const a=this.blockLen,l=new Uint8Array(a);l.set(s.length>a?t.create().update(s).digest():s);for(let de=0;de<l.length;de++)l[de]^=54;this.iHash.update(l),this.oHash=t.create();for(let de=0;de<l.length;de++)l[de]^=106;this.oHash.update(l),l.fill(0)}update(t){return assert.exists(this),this.iHash.update(t),this}digestInto(t){assert.exists(this),assert.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:s,finished:a,destroyed:l,blockLen:de,outputLen:pe}=this;return t=t,t.finished=a,t.destroyed=l,t.blockLen=de,t.outputLen=pe,t.oHash=n._cloneInto(t.oHash),t.iHash=s._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const hmac=(e,t,n)=>new HMAC(e,t).update(n).digest();hmac.create=(e,t)=>new HMAC(e,t);function extract(e,t,n){return assert.hash(e),hmac(e,toBytes(n),toBytes(t))}const HKDF_COUNTER=new Uint8Array([0]),EMPTY_BUFFER=new Uint8Array;function expand(e,t,n,s=32){if(assert.hash(e),assert.number(s),s>255*e.outputLen)throw new Error("Length should be <= 255*HashLen");const a=Math.ceil(s/e.outputLen);n===void 0&&(n=EMPTY_BUFFER);const l=new Uint8Array(a*e.outputLen),de=hmac.create(e,t),pe=de._cloneInto(),me=new Uint8Array(de.outputLen);for(let Be=0;Be<a;Be++)HKDF_COUNTER[0]=Be+1,pe.update(Be===0?EMPTY_BUFFER:me).update(n).update(HKDF_COUNTER).digestInto(me),l.set(me,e.outputLen*Be),de._cloneInto(pe);return de.destroy(),pe.destroy(),me.fill(0),HKDF_COUNTER.fill(0),l.slice(0,s)}var __defProp=Object.defineProperty,__export=(e,t)=>{for(var n in t)__defProp(e,n,{get:t[n],enumerable:!0})},verifiedSymbol=Symbol("verified"),isRecord=e=>e instanceof Object;function validateEvent(e){if(!isRecord(e)||typeof e.kind!="number"||typeof e.content!="string"||typeof e.created_at!="number"||typeof e.pubkey!="string"||!e.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(e.tags))return!1;for(let t=0;t<e.tags.length;t++){let n=e.tags[t];if(!Array.isArray(n))return!1;for(let s=0;s<n.length;s++)if(typeof n[s]=="object")return!1}return!0}var utils_exports={};__export(utils_exports,{Queue:()=>Queue$1,QueueNode:()=>QueueNode,binarySearch:()=>binarySearch,insertEventIntoAscendingList:()=>insertEventIntoAscendingList,insertEventIntoDescendingList:()=>insertEventIntoDescendingList,normalizeURL:()=>normalizeURL,utf8Decoder:()=>utf8Decoder,utf8Encoder:()=>utf8Encoder});var utf8Decoder=new TextDecoder("utf-8"),utf8Encoder=new TextEncoder;function normalizeURL(e){e.indexOf("://")===-1&&(e="wss://"+e);let t=new URL(e);return t.pathname=t.pathname.replace(/\/+/g,"/"),t.pathname.endsWith("/")&&(t.pathname=t.pathname.slice(0,-1)),(t.port==="80"&&t.protocol==="ws:"||t.port==="443"&&t.protocol==="wss:")&&(t.port=""),t.searchParams.sort(),t.hash="",t.toString()}function insertEventIntoDescendingList(e,t){const[n,s]=binarySearch(e,a=>t.id===a.id?0:t.created_at===a.created_at?-1:a.created_at-t.created_at);return s||e.splice(n,0,t),e}function insertEventIntoAscendingList(e,t){const[n,s]=binarySearch(e,a=>t.id===a.id?0:t.created_at===a.created_at?-1:t.created_at-a.created_at);return s||e.splice(n,0,t),e}function binarySearch(e,t){let n=0,s=e.length-1;for(;n<=s;){const a=Math.floor((n+s)/2),l=t(e[a]);if(l===0)return[a,!0];l<0?s=a-1:n=a+1}return[n,!1]}var QueueNode=class{constructor(e){bt(this,"value");bt(this,"next",null);bt(this,"prev",null);this.value=e}},Queue$1=class{constructor(){bt(this,"first");bt(this,"last");this.first=null,this.last=null}enqueue(t){const n=new QueueNode(t);return this.last?this.last===this.first?(this.last=n,this.last.prev=this.first,this.first.next=n):(n.prev=this.last,this.last.next=n,this.last=n):(this.first=n,this.last=n),!0}dequeue(){if(!this.first)return null;if(this.first===this.last){const n=this.first;return this.first=null,this.last=null,n.value}const t=this.first;return this.first=t.next,t.value}},JS=class{generateSecretKey(){return schnorr$1.utils.randomPrivateKey()}getPublicKey(e){return bytesToHex(schnorr$1.getPublicKey(e))}finalizeEvent(e,t){const n=e;return n.pubkey=bytesToHex(schnorr$1.getPublicKey(t)),n.id=getEventHash$1(n),n.sig=bytesToHex(schnorr$1.sign(getEventHash$1(n),t)),n[verifiedSymbol]=!0,n}verifyEvent(e){if(typeof e[verifiedSymbol]=="boolean")return e[verifiedSymbol];const t=getEventHash$1(e);if(t!==e.id)return e[verifiedSymbol]=!1,!1;try{const n=schnorr$1.verify(e.sig,t,e.pubkey);return e[verifiedSymbol]=n,n}catch{return e[verifiedSymbol]=!1,!1}}};function serializeEvent(e){if(!validateEvent(e))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,e.pubkey,e.created_at,e.kind,e.tags,e.content])}function getEventHash$1(e){let t=sha256(utf8Encoder.encode(serializeEvent(e)));return bytesToHex(t)}var i=new JS,generateSecretKey=i.generateSecretKey,getPublicKey=i.getPublicKey,finalizeEvent=i.finalizeEvent,verifyEvent=i.verifyEvent,kinds_exports={};__export(kinds_exports,{Application:()=>Application,BadgeAward:()=>BadgeAward,BadgeDefinition:()=>BadgeDefinition,BlockedRelaysList:()=>BlockedRelaysList,BookmarkList:()=>BookmarkList,Bookmarksets:()=>Bookmarksets,Calendar:()=>Calendar,CalendarEventRSVP:()=>CalendarEventRSVP,ChannelCreation:()=>ChannelCreation,ChannelHideMessage:()=>ChannelHideMessage,ChannelMessage:()=>ChannelMessage,ChannelMetadata:()=>ChannelMetadata,ChannelMuteUser:()=>ChannelMuteUser,ClassifiedListing:()=>ClassifiedListing,ClientAuth:()=>ClientAuth,CommunitiesList:()=>CommunitiesList,CommunityDefinition:()=>CommunityDefinition,CommunityPostApproval:()=>CommunityPostApproval,Contacts:()=>Contacts,CreateOrUpdateProduct:()=>CreateOrUpdateProduct,CreateOrUpdateStall:()=>CreateOrUpdateStall,Curationsets:()=>Curationsets,Date:()=>Date2,DraftClassifiedListing:()=>DraftClassifiedListing,DraftLong:()=>DraftLong,Emojisets:()=>Emojisets,EncryptedDirectMessage:()=>EncryptedDirectMessage,EncryptedDirectMessages:()=>EncryptedDirectMessages,EventDeletion:()=>EventDeletion,FileMetadata:()=>FileMetadata,FileServerPreference:()=>FileServerPreference,Followsets:()=>Followsets,GenericRepost:()=>GenericRepost,Genericlists:()=>Genericlists,HTTPAuth:()=>HTTPAuth,Handlerinformation:()=>Handlerinformation,Handlerrecommendation:()=>Handlerrecommendation,Highlights:()=>Highlights,InterestsList:()=>InterestsList,Interestsets:()=>Interestsets,JobFeedback:()=>JobFeedback,JobRequest:()=>JobRequest,JobResult:()=>JobResult,Label:()=>Label,LightningPubRPC:()=>LightningPubRPC,LiveChatMessage:()=>LiveChatMessage,LiveEvent:()=>LiveEvent,LongFormArticle:()=>LongFormArticle,Metadata:()=>Metadata,Mutelist:()=>Mutelist,NWCWalletInfo:()=>NWCWalletInfo,NWCWalletRequest:()=>NWCWalletRequest,NWCWalletResponse:()=>NWCWalletResponse,NostrConnect:()=>NostrConnect,OpenTimestamps:()=>OpenTimestamps,Pinlist:()=>Pinlist,ProblemTracker:()=>ProblemTracker,ProfileBadges:()=>ProfileBadges,PublicChatsList:()=>PublicChatsList,Reaction:()=>Reaction,RecommendRelay:()=>RecommendRelay,RelayList:()=>RelayList$1,Relaysets:()=>Relaysets,Report:()=>Report,Reporting:()=>Reporting,Repost:()=>Repost,SearchRelaysList:()=>SearchRelaysList,ShortTextNote:()=>ShortTextNote,Time:()=>Time,UserEmojiList:()=>UserEmojiList,UserStatuses:()=>UserStatuses,Zap:()=>Zap,ZapGoal:()=>ZapGoal,ZapRequest:()=>ZapRequest,classifyKind:()=>classifyKind,isEphemeralKind:()=>isEphemeralKind,isParameterizedReplaceableKind:()=>isParameterizedReplaceableKind,isRegularKind:()=>isRegularKind,isReplaceableKind:()=>isReplaceableKind});function isRegularKind(e){return 1e3<=e&&e<1e4||[1,2,4,5,6,7,8,16,40,41,42,43,44].includes(e)}function isReplaceableKind(e){return[0,3].includes(e)||1e4<=e&&e<2e4}function isEphemeralKind(e){return 2e4<=e&&e<3e4}function isParameterizedReplaceableKind(e){return 3e4<=e&&e<4e4}function classifyKind(e){return isRegularKind(e)?"regular":isReplaceableKind(e)?"replaceable":isEphemeralKind(e)?"ephemeral":isParameterizedReplaceableKind(e)?"parameterized":"unknown"}var Metadata=0,ShortTextNote=1,RecommendRelay=2,Contacts=3,EncryptedDirectMessage=4,EncryptedDirectMessages=4,EventDeletion=5,Repost=6,Reaction=7,BadgeAward=8,GenericRepost=16,ChannelCreation=40,ChannelMetadata=41,ChannelMessage=42,ChannelHideMessage=43,ChannelMuteUser=44,OpenTimestamps=1040,FileMetadata=1063,LiveChatMessage=1311,ProblemTracker=1971,Report=1984,Reporting=1984,Label=1985,CommunityPostApproval=4550,JobRequest=5999,JobResult=6999,JobFeedback=7e3,ZapGoal=9041,ZapRequest=9734,Zap=9735,Highlights=9802,Mutelist=1e4,Pinlist=10001,RelayList$1=10002,BookmarkList=10003,CommunitiesList=10004,PublicChatsList=10005,BlockedRelaysList=10006,SearchRelaysList=10007,InterestsList=10015,UserEmojiList=10030,FileServerPreference=10096,NWCWalletInfo=13194,LightningPubRPC=21e3,ClientAuth=22242,NWCWalletRequest=23194,NWCWalletResponse=23195,NostrConnect=24133,HTTPAuth=27235,Followsets=3e4,Genericlists=30001,Relaysets=30002,Bookmarksets=30003,Curationsets=30004,ProfileBadges=30008,BadgeDefinition=30009,Interestsets=30015,CreateOrUpdateStall=30017,CreateOrUpdateProduct=30018,LongFormArticle=30023,DraftLong=30024,Emojisets=30030,Application=30078,LiveEvent=30311,UserStatuses=30315,ClassifiedListing=30402,DraftClassifiedListing=30403,Date2=31922,Time=31923,Calendar=31924,CalendarEventRSVP=31925,Handlerrecommendation=31989,Handlerinformation=31990,CommunityDefinition=34550;function matchFilter(e,t){if(e.ids&&e.ids.indexOf(t.id)===-1||e.kinds&&e.kinds.indexOf(t.kind)===-1||e.authors&&e.authors.indexOf(t.pubkey)===-1)return!1;for(let n in e)if(n[0]==="#"){let s=n.slice(1),a=e[`#${s}`];if(a&&!t.tags.find(([l,de])=>l===n.slice(1)&&a.indexOf(de)!==-1))return!1}return!(e.since&&t.created_at<e.since||e.until&&t.created_at>e.until)}function matchFilters(e,t){for(let n=0;n<e.length;n++)if(matchFilter(e[n],t))return!0;return!1}var fakejson_exports={};__export(fakejson_exports,{getHex64:()=>getHex64,getInt:()=>getInt,getSubscriptionId:()=>getSubscriptionId,matchEventId:()=>matchEventId,matchEventKind:()=>matchEventKind,matchEventPubkey:()=>matchEventPubkey});function getHex64(e,t){let n=t.length+3,s=e.indexOf(`"${t}":`)+n,a=e.slice(s).indexOf('"')+s+1;return e.slice(a,a+64)}function getInt(e,t){let n=t.length,s=e.indexOf(`"${t}":`)+n+3,a=e.slice(s),l=Math.min(a.indexOf(","),a.indexOf("}"));return parseInt(a.slice(0,l),10)}function getSubscriptionId(e){let t=e.slice(0,22).indexOf('"EVENT"');if(t===-1)return null;let n=e.slice(t+7+1).indexOf('"');if(n===-1)return null;let s=t+7+1+n,a=e.slice(s+1,80).indexOf('"');if(a===-1)return null;let l=s+1+a;return e.slice(s+1,l)}function matchEventId(e,t){return t===getHex64(e,"id")}function matchEventPubkey(e,t){return t===getHex64(e,"pubkey")}function matchEventKind(e,t){return t===getInt(e,"kind")}var nip42_exports={};__export(nip42_exports,{makeAuthEvent:()=>makeAuthEvent});function makeAuthEvent(e,t){return{kind:ClientAuth,created_at:Math.floor(Date.now()/1e3),tags:[["relay",e],["challenge",t]],content:""}}var _WebSocket;try{_WebSocket=WebSocket}catch{}var _WebSocket2;try{_WebSocket2=WebSocket}catch{}var nip19_exports={};__export(nip19_exports,{BECH32_REGEX:()=>BECH32_REGEX$1,Bech32MaxSize:()=>Bech32MaxSize,decode:()=>decode$1,encodeBytes:()=>encodeBytes,naddrEncode:()=>naddrEncode,neventEncode:()=>neventEncode,noteEncode:()=>noteEncode,nprofileEncode:()=>nprofileEncode,npubEncode:()=>npubEncode,nrelayEncode:()=>nrelayEncode,nsecEncode:()=>nsecEncode});var Bech32MaxSize=5e3,BECH32_REGEX$1=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function integerToUint8Array(e){const t=new Uint8Array(4);return t[0]=e>>24&255,t[1]=e>>16&255,t[2]=e>>8&255,t[3]=e&255,t}function decode$1(e){var a,l,de,pe,me,Be,Le,Ye;let{prefix:t,words:n}=bech32$1.decode(e,Bech32MaxSize),s=new Uint8Array(bech32$1.fromWords(n));switch(t){case"nprofile":{let tt=parseTLV(s);if(!((a=tt[0])!=null&&a[0]))throw new Error("missing TLV 0 for nprofile");if(tt[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:bytesToHex(tt[0][0]),relays:tt[1]?tt[1].map(ot=>utf8Decoder.decode(ot)):[]}}}case"nevent":{let tt=parseTLV(s);if(!((l=tt[0])!=null&&l[0]))throw new Error("missing TLV 0 for nevent");if(tt[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");if(tt[2]&&tt[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(tt[3]&&tt[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:bytesToHex(tt[0][0]),relays:tt[1]?tt[1].map(ot=>utf8Decoder.decode(ot)):[],author:(de=tt[2])!=null&&de[0]?bytesToHex(tt[2][0]):void 0,kind:(pe=tt[3])!=null&&pe[0]?parseInt(bytesToHex(tt[3][0]),16):void 0}}}case"naddr":{let tt=parseTLV(s);if(!((me=tt[0])!=null&&me[0]))throw new Error("missing TLV 0 for naddr");if(!((Be=tt[2])!=null&&Be[0]))throw new Error("missing TLV 2 for naddr");if(tt[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(!((Le=tt[3])!=null&&Le[0]))throw new Error("missing TLV 3 for naddr");if(tt[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:utf8Decoder.decode(tt[0][0]),pubkey:bytesToHex(tt[2][0]),kind:parseInt(bytesToHex(tt[3][0]),16),relays:tt[1]?tt[1].map(ot=>utf8Decoder.decode(ot)):[]}}}case"nrelay":{let tt=parseTLV(s);if(!((Ye=tt[0])!=null&&Ye[0]))throw new Error("missing TLV 0 for nrelay");return{type:"nrelay",data:utf8Decoder.decode(tt[0][0])}}case"nsec":return{type:t,data:s};case"npub":case"note":return{type:t,data:bytesToHex(s)};default:throw new Error(`unknown prefix ${t}`)}}function parseTLV(e){let t={},n=e;for(;n.length>0;){let s=n[0],a=n[1],l=n.slice(2,2+a);if(n=n.slice(2+a),l.length<a)throw new Error(`not enough data to read on TLV ${s}`);t[s]=t[s]||[],t[s].push(l)}return t}function nsecEncode(e){return encodeBytes("nsec",e)}function npubEncode(e){return encodeBytes("npub",hexToBytes(e))}function noteEncode(e){return encodeBytes("note",hexToBytes(e))}function encodeBech32(e,t){let n=bech32$1.toWords(t);return bech32$1.encode(e,n,Bech32MaxSize)}function encodeBytes(e,t){return encodeBech32(e,t)}function nprofileEncode(e){let t=encodeTLV({0:[hexToBytes(e.pubkey)],1:(e.relays||[]).map(n=>utf8Encoder.encode(n))});return encodeBech32("nprofile",t)}function neventEncode(e){let t;e.kind!==void 0&&(t=integerToUint8Array(e.kind));let n=encodeTLV({0:[hexToBytes(e.id)],1:(e.relays||[]).map(s=>utf8Encoder.encode(s)),2:e.author?[hexToBytes(e.author)]:[],3:t?[new Uint8Array(t)]:[]});return encodeBech32("nevent",n)}function naddrEncode(e){let t=new ArrayBuffer(4);new DataView(t).setUint32(0,e.kind,!1);let n=encodeTLV({0:[utf8Encoder.encode(e.identifier)],1:(e.relays||[]).map(s=>utf8Encoder.encode(s)),2:[hexToBytes(e.pubkey)],3:[new Uint8Array(t)]});return encodeBech32("naddr",n)}function nrelayEncode(e){let t=encodeTLV({0:[utf8Encoder.encode(e)]});return encodeBech32("nrelay",t)}function encodeTLV(e){let t=[];return Object.entries(e).reverse().forEach(([n,s])=>{s.forEach(a=>{let l=new Uint8Array(a.length+2);l.set([parseInt(n)],0),l.set([a.length],1),l.set(a,2),t.push(l)})}),concatBytes(...t)}var nip04_exports={};__export(nip04_exports,{decrypt:()=>decrypt$1,encrypt:()=>encrypt$1});async function encrypt$1(e,t,n){const s=e instanceof Uint8Array?bytesToHex(e):e,a=secp256k1$1.getSharedSecret(s,"02"+t),l=getNormalizedX(a);let de=Uint8Array.from(randomBytes(16)),pe=utf8Encoder.encode(n),me=cbc(l,de).encrypt(pe),Be=base64.encode(new Uint8Array(me)),Le=base64.encode(new Uint8Array(de.buffer));return`${Be}?iv=${Le}`}async function decrypt$1(e,t,n){const s=e instanceof Uint8Array?bytesToHex(e):e;let[a,l]=n.split("?iv="),de=secp256k1$1.getSharedSecret(s,"02"+t),pe=getNormalizedX(de),me=base64.decode(l),Be=base64.decode(a),Le=cbc(pe,me).decrypt(Be);return utf8Decoder.decode(Le)}function getNormalizedX(e){return e.slice(1,33)}var nip05_exports={};__export(nip05_exports,{NIP05_REGEX:()=>NIP05_REGEX$1,isValid:()=>isValid,queryProfile:()=>queryProfile,searchDomain:()=>searchDomain,useFetchImplementation:()=>useFetchImplementation});var NIP05_REGEX$1=/^(?:([\w.+-]+)@)?([\w_-]+(\.[\w_-]+)+)$/,_fetch;try{_fetch=fetch}catch{}function useFetchImplementation(e){_fetch=e}async function searchDomain(e,t=""){try{const n=`https://${e}/.well-known/nostr.json?name=${t}`;return(await(await _fetch(n,{redirect:"error"})).json()).names}catch{return{}}}async function queryProfile(e){var l;const t=e.match(NIP05_REGEX$1);if(!t)return null;const[n,s="_",a]=t;try{const de=`https://${a}/.well-known/nostr.json?name=${s}`,pe=await(await _fetch(de,{redirect:"error"})).json();let me=pe.names[s];return me?{pubkey:me,relays:(l=pe.relays)==null?void 0:l[me]}:null}catch{return null}}async function isValid(e,t){let n=await queryProfile(t);return n?n.pubkey===e:!1}var nip10_exports={};__export(nip10_exports,{parse:()=>parse});function parse(e){const t={reply:void 0,root:void 0,mentions:[],profiles:[]},n=[];for(const s of e.tags)s[0]==="e"&&s[1]&&n.push(s),s[0]==="p"&&s[1]&&t.profiles.push({pubkey:s[1],relays:s[2]?[s[2]]:[]});for(let s=0;s<n.length;s++){const a=n[s],[l,de,pe,me]=a,Be={id:de,relays:pe?[pe]:[]},Le=s===0,Ye=s===n.length-1;if(me==="root"){t.root=Be;continue}if(me==="reply"){t.reply=Be;continue}if(me==="mention"){t.mentions.push(Be);continue}if(Le){t.root=Be;continue}if(Ye){t.reply=Be;continue}t.mentions.push(Be)}return t}var nip11_exports={};__export(nip11_exports,{fetchRelayInformation:()=>fetchRelayInformation,useFetchImplementation:()=>useFetchImplementation2});var _fetch2;try{_fetch2=fetch}catch{}function useFetchImplementation2(e){_fetch2=e}async function fetchRelayInformation(e){return await(await fetch(e.replace("ws://","http://").replace("wss://","https://"),{headers:{Accept:"application/nostr+json"}})).json()}var nip13_exports={};__export(nip13_exports,{getPow:()=>getPow,minePow:()=>minePow});function getPow(e){let t=0;for(let n=0;n<e.length;n++){const s=parseInt(e[n],16);if(s===0)t+=4;else{t+=Math.clz32(s)-28;break}}return t}function minePow(e,t){let n=0;const s=e,a=["nonce",n.toString(),t.toString()];for(s.tags.push(a);;){const l=Math.floor(new Date().getTime()/1e3);if(l!==s.created_at&&(n=0,s.created_at=l),a[1]=(++n).toString(),s.id=getEventHash$1(s),getPow(s.id)>=t)break}return s}var nip18_exports={};__export(nip18_exports,{finishRepostEvent:()=>finishRepostEvent,getRepostedEvent:()=>getRepostedEvent,getRepostedEventPointer:()=>getRepostedEventPointer});function finishRepostEvent(e,t,n,s){return finalizeEvent({kind:Repost,tags:[...e.tags??[],["e",t.id,n],["p",t.pubkey]],content:e.content===""?"":JSON.stringify(t),created_at:e.created_at},s)}function getRepostedEventPointer(e){if(e.kind!==Repost)return;let t,n;for(let s=e.tags.length-1;s>=0&&(t===void 0||n===void 0);s--){const a=e.tags[s];a.length>=2&&(a[0]==="e"&&t===void 0?t=a:a[0]==="p"&&n===void 0&&(n=a))}if(t!==void 0)return{id:t[1],relays:[t[2],n==null?void 0:n[2]].filter(s=>typeof s=="string"),author:n==null?void 0:n[1]}}function getRepostedEvent(e,{skipVerification:t}={}){const n=getRepostedEventPointer(e);if(n===void 0||e.content==="")return;let s;try{s=JSON.parse(e.content)}catch{return}if(s.id===n.id&&!(!t&&!verifyEvent(s)))return s}var nip21_exports={};__export(nip21_exports,{NOSTR_URI_REGEX:()=>NOSTR_URI_REGEX,parse:()=>parse2,test:()=>test});var NOSTR_URI_REGEX=new RegExp(`nostr:(${BECH32_REGEX$1.source})`);function test(e){return typeof e=="string"&&new RegExp(`^${NOSTR_URI_REGEX.source}$`).test(e)}function parse2(e){const t=e.match(new RegExp(`^${NOSTR_URI_REGEX.source}$`));if(!t)throw new Error(`Invalid Nostr URI: ${e}`);return{uri:t[0],value:t[1],decoded:decode$1(t[1])}}var nip25_exports={};__export(nip25_exports,{finishReactionEvent:()=>finishReactionEvent,getReactedEventPointer:()=>getReactedEventPointer});function finishReactionEvent(e,t,n){const s=t.tags.filter(a=>a.length>=2&&(a[0]==="e"||a[0]==="p"));return finalizeEvent({...e,kind:Reaction,tags:[...e.tags??[],...s,["e",t.id],["p",t.pubkey]],content:e.content??"+"},n)}function getReactedEventPointer(e){if(e.kind!==Reaction)return;let t,n;for(let s=e.tags.length-1;s>=0&&(t===void 0||n===void 0);s--){const a=e.tags[s];a.length>=2&&(a[0]==="e"&&t===void 0?t=a:a[0]==="p"&&n===void 0&&(n=a))}if(!(t===void 0||n===void 0))return{id:t[1],relays:[t[2],n[2]].filter(s=>s!==void 0),author:n[1]}}var nip27_exports={};__export(nip27_exports,{matchAll:()=>matchAll,regex:()=>regex,replaceAll:()=>replaceAll});var regex=()=>new RegExp(`\\b${NOSTR_URI_REGEX.source}\\b`,"g");function*matchAll(e){const t=e.matchAll(regex());for(const n of t)try{const[s,a]=n;yield{uri:s,value:a,decoded:decode$1(a),start:n.index,end:n.index+s.length}}catch{}}function replaceAll(e,t){return e.replaceAll(regex(),(n,s)=>t({uri:n,value:s,decoded:decode$1(s)}))}var nip28_exports={};__export(nip28_exports,{channelCreateEvent:()=>channelCreateEvent,channelHideMessageEvent:()=>channelHideMessageEvent,channelMessageEvent:()=>channelMessageEvent,channelMetadataEvent:()=>channelMetadataEvent,channelMuteUserEvent:()=>channelMuteUserEvent});var channelCreateEvent=(e,t)=>{let n;if(typeof e.content=="object")n=JSON.stringify(e.content);else if(typeof e.content=="string")n=e.content;else return;return finalizeEvent({kind:ChannelCreation,tags:[...e.tags??[]],content:n,created_at:e.created_at},t)},channelMetadataEvent=(e,t)=>{let n;if(typeof e.content=="object")n=JSON.stringify(e.content);else if(typeof e.content=="string")n=e.content;else return;return finalizeEvent({kind:ChannelMetadata,tags:[["e",e.channel_create_event_id],...e.tags??[]],content:n,created_at:e.created_at},t)},channelMessageEvent=(e,t)=>{const n=[["e",e.channel_create_event_id,e.relay_url,"root"]];return e.reply_to_channel_message_event_id&&n.push(["e",e.reply_to_channel_message_event_id,e.relay_url,"reply"]),finalizeEvent({kind:ChannelMessage,tags:[...n,...e.tags??[]],content:e.content,created_at:e.created_at},t)},channelHideMessageEvent=(e,t)=>{let n;if(typeof e.content=="object")n=JSON.stringify(e.content);else if(typeof e.content=="string")n=e.content;else return;return finalizeEvent({kind:ChannelHideMessage,tags:[["e",e.channel_message_event_id],...e.tags??[]],content:n,created_at:e.created_at},t)},channelMuteUserEvent=(e,t)=>{let n;if(typeof e.content=="object")n=JSON.stringify(e.content);else if(typeof e.content=="string")n=e.content;else return;return finalizeEvent({kind:ChannelMuteUser,tags:[["p",e.pubkey_to_mute],...e.tags??[]],content:n,created_at:e.created_at},t)},nip30_exports={};__export(nip30_exports,{EMOJI_SHORTCODE_REGEX:()=>EMOJI_SHORTCODE_REGEX,matchAll:()=>matchAll2,regex:()=>regex2,replaceAll:()=>replaceAll2});var EMOJI_SHORTCODE_REGEX=/:(\w+):/,regex2=()=>new RegExp(`\\B${EMOJI_SHORTCODE_REGEX.source}\\B`,"g");function*matchAll2(e){const t=e.matchAll(regex2());for(const n of t)try{const[s,a]=n;yield{shortcode:s,name:a,start:n.index,end:n.index+s.length}}catch{}}function replaceAll2(e,t){return e.replaceAll(regex2(),(n,s)=>t({shortcode:n,name:s}))}var nip39_exports={};__export(nip39_exports,{useFetchImplementation:()=>useFetchImplementation3,validateGithub:()=>validateGithub});var _fetch3;try{_fetch3=fetch}catch{}function useFetchImplementation3(e){_fetch3=e}async function validateGithub(e,t,n){try{return await(await _fetch3(`https://gist.github.com/${t}/${n}/raw`)).text()===`Verifying that I control the following Nostr public key: ${e}`}catch{return!1}}var nip44_exports={};__export(nip44_exports,{decrypt:()=>decrypt2,encrypt:()=>encrypt2,getConversationKey:()=>getConversationKey,v2:()=>v2});var minPlaintextSize=1,maxPlaintextSize=65535;function getConversationKey(e,t){const n=secp256k1$1.getSharedSecret(e,"02"+t).subarray(1,33);return extract(sha256,n,"nip44-v2")}function getMessageKeys(e,t){const n=expand(sha256,e,t,76);return{chacha_key:n.subarray(0,32),chacha_nonce:n.subarray(32,44),hmac_key:n.subarray(44,76)}}function calcPaddedLen(e){if(!Number.isSafeInteger(e)||e<1)throw new Error("expected positive integer");if(e<=32)return 32;const t=1<<Math.floor(Math.log2(e-1))+1,n=t<=256?32:t/8;return n*(Math.floor((e-1)/n)+1)}function writeU16BE(e){if(!Number.isSafeInteger(e)||e<minPlaintextSize||e>maxPlaintextSize)throw new Error("invalid plaintext size: must be between 1 and 65535 bytes");const t=new Uint8Array(2);return new DataView(t.buffer).setUint16(0,e,!1),t}function pad(e){const t=utf8Encoder.encode(e),n=t.length,s=writeU16BE(n),a=new Uint8Array(calcPaddedLen(n)-n);return concatBytes(s,t,a)}function unpad(e){const t=new DataView(e.buffer).getUint16(0),n=e.subarray(2,2+t);if(t<minPlaintextSize||t>maxPlaintextSize||n.length!==t||e.length!==2+calcPaddedLen(t))throw new Error("invalid padding");return utf8Decoder.decode(n)}function hmacAad(e,t,n){if(n.length!==32)throw new Error("AAD associated data must be 32 bytes");const s=concatBytes(n,t);return hmac(sha256,e,s)}function decodePayload(e){if(typeof e!="string")throw new Error("payload must be a valid string");const t=e.length;if(t<132||t>87472)throw new Error("invalid payload length: "+t);if(e[0]==="#")throw new Error("unknown encryption version");let n;try{n=base64.decode(e)}catch(l){throw new Error("invalid base64: "+l.message)}const s=n.length;if(s<99||s>65603)throw new Error("invalid data length: "+s);const a=n[0];if(a!==2)throw new Error("unknown encryption version "+a);return{nonce:n.subarray(1,33),ciphertext:n.subarray(33,-32),mac:n.subarray(-32)}}function encrypt2(e,t,n=randomBytes(32)){const{chacha_key:s,chacha_nonce:a,hmac_key:l}=getMessageKeys(t,n),de=pad(e),pe=chacha20(s,a,de),me=hmacAad(l,pe,n);return base64.encode(concatBytes(new Uint8Array([2]),n,pe,me))}function decrypt2(e,t){const{nonce:n,ciphertext:s,mac:a}=decodePayload(e),{chacha_key:l,chacha_nonce:de,hmac_key:pe}=getMessageKeys(t,n),me=hmacAad(pe,s,n);if(!equalBytes(me,a))throw new Error("invalid MAC");const Be=chacha20(l,de,s);return unpad(Be)}var v2={utils:{getConversationKey,calcPaddedLen},encrypt:encrypt2,decrypt:decrypt2},nip47_exports={};__export(nip47_exports,{makeNwcRequestEvent:()=>makeNwcRequestEvent,parseConnectionString:()=>parseConnectionString});function parseConnectionString(e){const{pathname:t,searchParams:n}=new URL(e),s=t,a=n.get("relay"),l=n.get("secret");if(!s||!a||!l)throw new Error("invalid connection string");return{pubkey:s,relay:a,secret:l}}async function makeNwcRequestEvent(e,t,n){const a=await encrypt$1(t,e,JSON.stringify({method:"pay_invoice",params:{invoice:n}})),l={kind:NWCWalletRequest,created_at:Math.round(Date.now()/1e3),content:a,tags:[["p",e]]};return finalizeEvent(l,t)}var nip57_exports={};__export(nip57_exports,{getZapEndpoint:()=>getZapEndpoint,makeZapReceipt:()=>makeZapReceipt,makeZapRequest:()=>makeZapRequest,useFetchImplementation:()=>useFetchImplementation4,validateZapRequest:()=>validateZapRequest});var _fetch4;try{_fetch4=fetch}catch{}function useFetchImplementation4(e){_fetch4=e}async function getZapEndpoint(e){try{let t="",{lud06:n,lud16:s}=JSON.parse(e.content);if(n){let{words:de}=bech32$1.decode(n,1e3),pe=bech32$1.fromWords(de);t=utf8Decoder.decode(pe)}else if(s){let[de,pe]=s.split("@");t=new URL(`/.well-known/lnurlp/${de}`,`https://${pe}`).toString()}else return null;let l=await(await _fetch4(t)).json();if(l.allowsNostr&&l.nostrPubkey)return l.callback}catch{}return null}function makeZapRequest({profile:e,event:t,amount:n,relays:s,comment:a=""}){if(!n)throw new Error("amount not given");if(!e)throw new Error("profile not given");let l={kind:9734,created_at:Math.round(Date.now()/1e3),content:a,tags:[["p",e],["amount",n.toString()],["relays",...s]]};return t&&l.tags.push(["e",t]),l}function validateZapRequest(e){let t;try{t=JSON.parse(e)}catch{return"Invalid zap request JSON."}if(!validateEvent(t))return"Zap request is not a valid Nostr event.";if(!verifyEvent(t))return"Invalid signature on zap request.";let n=t.tags.find(([l,de])=>l==="p"&&de);if(!n)return"Zap request doesn't have a 'p' tag.";if(!n[1].match(/^[a-f0-9]{64}$/))return"Zap request 'p' tag is not valid hex.";let s=t.tags.find(([l,de])=>l==="e"&&de);return s&&!s[1].match(/^[a-f0-9]{64}$/)?"Zap request 'e' tag is not valid hex.":t.tags.find(([l,de])=>l==="relays"&&de)?null:"Zap request doesn't have a 'relays' tag."}function makeZapReceipt({zapRequest:e,preimage:t,bolt11:n,paidAt:s}){let a=JSON.parse(e),l=a.tags.filter(([pe])=>pe==="e"||pe==="p"||pe==="a"),de={kind:9735,created_at:Math.round(s.getTime()/1e3),content:"",tags:[...l,["P",a.pubkey],["bolt11",n],["description",e]]};return t&&de.tags.push(["preimage",t]),de}var nip98_exports={};__export(nip98_exports,{getToken:()=>getToken,hashPayload:()=>hashPayload,unpackEventFromToken:()=>unpackEventFromToken,validateEvent:()=>validateEvent2,validateEventKind:()=>validateEventKind,validateEventMethodTag:()=>validateEventMethodTag,validateEventPayloadTag:()=>validateEventPayloadTag,validateEventTimestamp:()=>validateEventTimestamp,validateEventUrlTag:()=>validateEventUrlTag,validateToken:()=>validateToken});var _authorizationScheme="Nostr ";async function getToken(e,t,n,s=!1,a){const l={kind:HTTPAuth,tags:[["u",e],["method",t]],created_at:Math.round(new Date().getTime()/1e3),content:""};a&&l.tags.push(["payload",hashPayload(a)]);const de=await n(l);return(s?_authorizationScheme:"")+base64.encode(utf8Encoder.encode(JSON.stringify(de)))}async function validateToken(e,t,n){const s=await unpackEventFromToken(e).catch(l=>{throw l});return await validateEvent2(s,t,n).catch(l=>{throw l})}async function unpackEventFromToken(e){if(!e)throw new Error("Missing token");e=e.replace(_authorizationScheme,"");const t=utf8Decoder.decode(base64.decode(e));if(!t||t.length===0||!t.startsWith("{"))throw new Error("Invalid token");return JSON.parse(t)}function validateEventTimestamp(e){return e.created_at?Math.round(new Date().getTime()/1e3)-e.created_at<60:!1}function validateEventKind(e){return e.kind===HTTPAuth}function validateEventUrlTag(e,t){const n=e.tags.find(s=>s[0]==="u");return n?n.length>0&&n[1]===t:!1}function validateEventMethodTag(e,t){const n=e.tags.find(s=>s[0]==="method");return n?n.length>0&&n[1].toLowerCase()===t.toLowerCase():!1}function hashPayload(e){const t=sha256(utf8Encoder.encode(JSON.stringify(e)));return bytesToHex(t)}function validateEventPayloadTag(e,t){const n=e.tags.find(a=>a[0]==="payload");if(!n)return!1;const s=hashPayload(t);return n.length>0&&n[1]===s}async function validateEvent2(e,t,n,s){if(!verifyEvent(e))throw new Error("Invalid nostr event, signature invalid");if(!validateEventKind(e))throw new Error("Invalid nostr event, kind invalid");if(!validateEventTimestamp(e))throw new Error("Invalid nostr event, created_at timestamp invalid");if(!validateEventUrlTag(e,t))throw new Error("Invalid nostr event, url tag invalid");if(!validateEventMethodTag(e,n))throw new Error("Invalid nostr event, method tag invalid");if(s&&typeof s=="object"&&Object.keys(s).length>0&&!validateEventPayloadTag(e,s))throw new Error("Invalid nostr event, payload tag does not match request body hash");return!0}var lib$1={},types={};Object.defineProperty(types,"__esModule",{value:!0});var ee={},taskCollection$1={},taskCollection={},bakeCollection={};(function(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.bakeCollectionVariadic=exports.bakeCollectionAwait=exports.bakeCollection=exports.BAKED_EMPTY_FUNC=void 0,exports.BAKED_EMPTY_FUNC=function(){};var FORLOOP_FALLBACK=1500;function generateArgsDefCode(e){var t="";if(e===0)return t;for(var n=0;n<e-1;++n)t+="arg"+String(n)+", ";return t+="arg"+String(e-1),t}function generateBodyPartsCode(e,t){for(var n="",s="",a=0;a<t;++a)n+="var f".concat(a," = collection[").concat(a,`];
`),s+="f".concat(a,"(").concat(e,`)
`);return{funcDefCode:n,funcCallCode:s}}function generateBodyPartsVariadicCode(e){for(var t="",n="",s=0;s<e;++s)t+="var f".concat(s," = collection[").concat(s,`];
`),n+="f".concat(s,`.apply(undefined, arguments)
`);return{funcDefCode:t,funcCallCode:n}}function bakeCollection(collection,fixedArgsNum){if(collection.length===0)return exports.BAKED_EMPTY_FUNC;if(collection.length===1)return collection[0];var funcFactoryCode;if(collection.length<FORLOOP_FALLBACK){var argsDefCode=generateArgsDefCode(fixedArgsNum),_a=generateBodyPartsCode(argsDefCode,collection.length),funcDefCode=_a.funcDefCode,funcCallCode=_a.funcCallCode;funcFactoryCode=`(function(collection) {
            `.concat(funcDefCode,`
            collection = undefined;
            return (function(`).concat(argsDefCode,`) {
                `).concat(funcCallCode,`
            });
        })`)}else{var argsDefCode=generateArgsDefCode(fixedArgsNum);collection.length%10===0?funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; i += 10) {
                        collection[i](`).concat(argsDefCode,`);
                        collection[i+1](`).concat(argsDefCode,`);
                        collection[i+2](`).concat(argsDefCode,`);
                        collection[i+3](`).concat(argsDefCode,`);
                        collection[i+4](`).concat(argsDefCode,`);
                        collection[i+5](`).concat(argsDefCode,`);
                        collection[i+6](`).concat(argsDefCode,`);
                        collection[i+7](`).concat(argsDefCode,`);
                        collection[i+8](`).concat(argsDefCode,`);
                        collection[i+9](`).concat(argsDefCode,`);
                    }
                });
            })`):collection.length%4===0?funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; i += 4) {
                        collection[i](`).concat(argsDefCode,`);
                        collection[i+1](`).concat(argsDefCode,`);
                        collection[i+2](`).concat(argsDefCode,`);
                        collection[i+3](`).concat(argsDefCode,`);
                    }
                });
            })`):collection.length%3===0?funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; i += 3) {
                        collection[i](`).concat(argsDefCode,`);
                        collection[i+1](`).concat(argsDefCode,`);
                        collection[i+2](`).concat(argsDefCode,`);
                    }
                });
            })`):funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; ++i) {
                        collection[i](`).concat(argsDefCode,`);
                    }
                });
            })`)}{var funcFactory=eval(funcFactoryCode);return funcFactory(collection)}}exports.bakeCollection=bakeCollection;function bakeCollectionAwait(collection,fixedArgsNum){if(collection.length===0)return exports.BAKED_EMPTY_FUNC;if(collection.length===1)return collection[0];var funcFactoryCode;if(collection.length<FORLOOP_FALLBACK){var argsDefCode=generateArgsDefCode(fixedArgsNum),_a=generateBodyPartsCode(argsDefCode,collection.length),funcDefCode=_a.funcDefCode,funcCallCode=_a.funcCallCode;funcFactoryCode=`(function(collection) {
            `.concat(funcDefCode,`
            collection = undefined;
            return (function(`).concat(argsDefCode,`) {
                return Promise.all([ `).concat(funcCallCode,` ]);
            });
        })`)}else{var argsDefCode=generateArgsDefCode(fixedArgsNum);funcFactoryCode=`(function(collection) {
            return (function(`.concat(argsDefCode,`) {
                var promises = Array(collection.length);
                for (var i = 0; i < collection.length; ++i) {
                    promises[i] = collection[i](`).concat(argsDefCode,`);
                }
                return Promise.all(promises);
            });
        })`)}{var funcFactory=eval(funcFactoryCode);return funcFactory(collection)}}exports.bakeCollectionAwait=bakeCollectionAwait;function bakeCollectionVariadic(collection){if(collection.length===0)return exports.BAKED_EMPTY_FUNC;if(collection.length===1)return collection[0];var funcFactoryCode;if(collection.length<FORLOOP_FALLBACK){var _a=generateBodyPartsVariadicCode(collection.length),funcDefCode=_a.funcDefCode,funcCallCode=_a.funcCallCode;funcFactoryCode=`(function(collection) {
            `.concat(funcDefCode,`
            collection = undefined;
            return (function() {
                `).concat(funcCallCode,`
            });
        })`)}else funcFactoryCode=`(function(collection) {
            return (function() {
                for (var i = 0; i < collection.length; ++i) {
                    collection[i].apply(undefined, arguments);
                }
            });
        })`;{var funcFactory=eval(funcFactoryCode);return funcFactory(collection)}}exports.bakeCollectionVariadic=bakeCollectionVariadic})(bakeCollection);var __spreadArray$1=commonjsGlobal&&commonjsGlobal.__spreadArray||function(e,t,n){if(n||arguments.length===2)for(var s=0,a=t.length,l;s<a;s++)(l||!(s in t))&&(l||(l=Array.prototype.slice.call(t,0,s)),l[s]=t[s]);return e.concat(l||Array.prototype.slice.call(t))};Object.defineProperty(taskCollection,"__esModule",{value:!0});taskCollection.TaskCollection=taskCollection._fast_remove_single=void 0;var bake_collection_1=bakeCollection;function push_norebuild(e,t){var n=this.length;if(n>1)if(t){var s;(s=this._tasks).push.apply(s,arguments),this.length+=arguments.length}else this._tasks.push(e),this.length++;else if(t){if(n===1){var a=Array(1+arguments.length);a.push(a),a.push.apply(a,arguments),this._tasks=a}else{var a=Array(arguments.length);a.push.apply(a,arguments),this._tasks=a}this.length+=arguments.length}else n===1?this._tasks=[this._tasks,e]:this._tasks=e,this.length++}function push_rebuild(e,t){var n=this.length;if(n>1)if(t){var s;(s=this._tasks).push.apply(s,arguments),this.length+=arguments.length}else this._tasks.push(e),this.length++;else if(t){if(n===1){var a=Array(1+arguments.length);a.push(a),a.push.apply(a,arguments),this._tasks=a}else{var a=Array(arguments.length);a.push.apply(a,arguments),this._tasks=a}this.length+=arguments.length}else n===1?this._tasks=[this._tasks,e]:this._tasks=e,this.length++;this.firstEmitBuildStrategy?this.call=rebuild_on_first_call:this.rebuild()}function _fast_remove_single(e,t){t!==-1&&(t===0?e.shift():t===e.length-1?e.length=e.length-1:e.splice(t,1))}taskCollection._fast_remove_single=_fast_remove_single;function removeLast_norebuild(e){this.length!==0&&(this.length===1?this._tasks===e&&(this.length=0):(_fast_remove_single(this._tasks,this._tasks.lastIndexOf(e)),this._tasks.length===1?(this._tasks=this._tasks[0],this.length=1):this.length=this._tasks.length))}function removeLast_rebuild(e){if(this.length!==0){if(this.length===1)if(this._tasks===e&&(this.length=0),this.firstEmitBuildStrategy){this.call=bake_collection_1.BAKED_EMPTY_FUNC;return}else{this.rebuild();return}else _fast_remove_single(this._tasks,this._tasks.lastIndexOf(e)),this._tasks.length===1?(this._tasks=this._tasks[0],this.length=1):this.length=this._tasks.length;this.firstEmitBuildStrategy?this.call=rebuild_on_first_call:this.rebuild()}}function insert_norebuild(e){for(var t,n=[],s=1;s<arguments.length;s++)n[s-1]=arguments[s];this.length===0?(this._tasks=n,this.length=1):this.length===1?(n.unshift(this._tasks),this._tasks=n,this.length=this._tasks.length):((t=this._tasks).splice.apply(t,__spreadArray$1([e,0],n,!1)),this.length=this._tasks.length)}function insert_rebuild(e){for(var t,n=[],s=1;s<arguments.length;s++)n[s-1]=arguments[s];this.length===0?(this._tasks=n,this.length=1):this.length===1?(n.unshift(this._tasks),this._tasks=n,this.length=this._tasks.length):((t=this._tasks).splice.apply(t,__spreadArray$1([e,0],n,!1)),this.length=this._tasks.length),this.firstEmitBuildStrategy?this.call=rebuild_on_first_call:this.rebuild()}function rebuild_noawait(){this.length===0?this.call=bake_collection_1.BAKED_EMPTY_FUNC:this.length===1?this.call=this._tasks:this.call=(0,bake_collection_1.bakeCollection)(this._tasks,this.argsNum)}function rebuild_await(){this.length===0?this.call=bake_collection_1.BAKED_EMPTY_FUNC:this.length===1?this.call=this._tasks:this.call=(0,bake_collection_1.bakeCollectionAwait)(this._tasks,this.argsNum)}function rebuild_on_first_call(){this.rebuild(),this.call.apply(void 0,arguments)}var TaskCollection=function(){function e(t,n,s,a){n===void 0&&(n=!0),s===void 0&&(s=null),a===void 0&&(a=!1),this.awaitTasks=a,this.call=bake_collection_1.BAKED_EMPTY_FUNC,this.argsNum=t,this.firstEmitBuildStrategy=!0,a?this.rebuild=rebuild_await.bind(this):this.rebuild=rebuild_noawait.bind(this),this.setAutoRebuild(n),s?typeof s=="function"?(this._tasks=s,this.length=1):(this._tasks=s,this.length=s.length):(this._tasks=null,this.length=0),n&&this.rebuild()}return e}();taskCollection.TaskCollection=TaskCollection;function fastClear(){this._tasks=null,this.length=0,this.call=bake_collection_1.BAKED_EMPTY_FUNC}function clear(){this._tasks=null,this.length=0,this.call=bake_collection_1.BAKED_EMPTY_FUNC}function growArgsNum(e){this.argsNum<e&&(this.argsNum=e,this.firstEmitBuildStrategy?this.call=rebuild_on_first_call:this.rebuild())}function setAutoRebuild(e){e?(this.push=push_rebuild.bind(this),this.insert=insert_rebuild.bind(this),this.removeLast=removeLast_rebuild.bind(this)):(this.push=push_norebuild.bind(this),this.insert=insert_norebuild.bind(this),this.removeLast=removeLast_norebuild.bind(this))}function tasksAsArray(){return this.length===0?[]:this.length===1?[this._tasks]:this._tasks}function setTasks(e){e.length===0?(this.length=0,this.call=bake_collection_1.BAKED_EMPTY_FUNC):e.length===1?(this.length=1,this.call=e[0],this._tasks=e[0]):(this.length=e.length,this._tasks=e,this.firstEmitBuildStrategy?this.call=rebuild_on_first_call:this.rebuild())}TaskCollection.prototype.fastClear=fastClear;TaskCollection.prototype.clear=clear;TaskCollection.prototype.growArgsNum=growArgsNum;TaskCollection.prototype.setAutoRebuild=setAutoRebuild;TaskCollection.prototype.tasksAsArray=tasksAsArray;TaskCollection.prototype.setTasks=setTasks;(function(e){var t=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(s,a,l,de){de===void 0&&(de=l);var pe=Object.getOwnPropertyDescriptor(a,l);(!pe||("get"in pe?!a.__esModule:pe.writable||pe.configurable))&&(pe={enumerable:!0,get:function(){return a[l]}}),Object.defineProperty(s,de,pe)}:function(s,a,l,de){de===void 0&&(de=l),s[de]=a[l]}),n=commonjsGlobal&&commonjsGlobal.__exportStar||function(s,a){for(var l in s)l!=="default"&&!Object.prototype.hasOwnProperty.call(a,l)&&t(a,s,l)};Object.defineProperty(e,"__esModule",{value:!0}),n(taskCollection,e)})(taskCollection$1);var utils={};Object.defineProperty(utils,"__esModule",{value:!0});utils.nullObj=void 0;function nullObj(){var e={};return e.__proto__=null,e.prototype=null,e}utils.nullObj=nullObj;var __spreadArray=commonjsGlobal&&commonjsGlobal.__spreadArray||function(e,t,n){if(n||arguments.length===2)for(var s=0,a=t.length,l;s<a;s++)(l||!(s in t))&&(l||(l=Array.prototype.slice.call(t,0,s)),l[s]=t[s]);return e.concat(l||Array.prototype.slice.call(t))};Object.defineProperty(ee,"__esModule",{value:!0});ee.EventEmitter=void 0;var task_collection_1=taskCollection$1,utils_1=utils;function emit(e,t,n,s,a,l){var de=this.events[e];return de?de.length===0?!1:(de.argsNum<6?de.call(t,n,s,a,l):de.call.apply(void 0,arguments),!0):!1}function emitHasOnce(e,t,n,s,a,l){var de=this.events[e];if(de){if(de.length===0)return!1;de.argsNum<6?de.call(t,n,s,a,l):de.call.apply(void 0,arguments)}var pe=this.onceEvents[e];if(pe){if(typeof pe=="function")this.onceEvents[e]=void 0,arguments.length<6?pe(t,n,s,a,l):pe.apply(void 0,arguments);else{var me=pe;if(this.onceEvents[e]=void 0,arguments.length<6)for(var Be=0;Be<me.length;++Be)me[Be](t,n,s,a,l);else for(var Be=0;Be<me.length;++Be)me[Be].apply(void 0,arguments)}return!0}return!!de}var EventEmitter=function(){function e(){this.events=(0,utils_1.nullObj)(),this.onceEvents=(0,utils_1.nullObj)(),this._symbolKeys=new Set,this.maxListeners=1/0}return Object.defineProperty(e.prototype,"_eventsCount",{get:function(){return this.eventNames().length},enumerable:!1,configurable:!0}),e}();ee.EventEmitter=EventEmitter;function once(e,t){switch(this.emit===emit&&(this.emit=emitHasOnce),typeof this.onceEvents[e]){case"undefined":this.onceEvents[e]=t,typeof e=="symbol"&&this._symbolKeys.add(e);break;case"function":this.onceEvents[e]=[this.onceEvents[e],t];break;case"object":this.onceEvents[e].push(t)}return this}function addListener(e,t,n){if(n===void 0&&(n=t.length),typeof t!="function")throw new TypeError("The listener must be a function");var s=this.events[e];return s?(s.push(t),s.growArgsNum(n),this.maxListeners!==1/0&&this.maxListeners<=s.length&&console.warn('Maximum event listeners for "'.concat(String(e),'" event!'))):(this.events[e]=new task_collection_1.TaskCollection(n,!0,t,!1),typeof e=="symbol"&&this._symbolKeys.add(e)),this}function removeListener(e,t){var n=this.events[e];n&&n.removeLast(t);var s=this.onceEvents[e];return s&&(typeof s=="function"?this.onceEvents[e]=void 0:typeof s=="object"&&(s.length===1&&s[0]===t?this.onceEvents[e]=void 0:(0,task_collection_1._fast_remove_single)(s,s.lastIndexOf(t)))),this}function addListenerBound(e,t,n,s){n===void 0&&(n=this),s===void 0&&(s=t.length),this.boundFuncs||(this.boundFuncs=new Map);var a=t.bind(n);return this.boundFuncs.set(t,a),this.addListener(e,a,s)}function removeListenerBound(e,t){var n,s,a=(n=this.boundFuncs)===null||n===void 0?void 0:n.get(t);return(s=this.boundFuncs)===null||s===void 0||s.delete(t),this.removeListener(e,a)}function hasListeners(e){return this.events[e]&&!!this.events[e].length}function prependListener(e,t,n){if(n===void 0&&(n=t.length),typeof t!="function")throw new TypeError("The listener must be a function");var s=this.events[e];return!s||!(s instanceof task_collection_1.TaskCollection)?(s=this.events[e]=new task_collection_1.TaskCollection(n,!0,t,!1),typeof e=="symbol"&&this._symbolKeys.add(e)):(s.insert(0,t),s.growArgsNum(n),this.maxListeners!==1/0&&this.maxListeners<=s.length&&console.warn('Maximum event listeners for "'.concat(String(e),'" event!'))),this}function prependOnceListener(e,t){this.emit===emit&&(this.emit=emitHasOnce);var n=this.onceEvents[e];return n?typeof n!="object"?(this.onceEvents[e]=[t,n],typeof e=="symbol"&&this._symbolKeys.add(e)):(n.unshift(t),this.maxListeners!==1/0&&this.maxListeners<=n.length&&console.warn('Maximum event listeners for "'.concat(String(e),'" once event!'))):(this.onceEvents[e]=[t],typeof e=="symbol"&&this._symbolKeys.add(e)),this}function removeAllListeners(e){return e===void 0?(this.events=(0,utils_1.nullObj)(),this.onceEvents=(0,utils_1.nullObj)(),this._symbolKeys=new Set):(this.events[e]=void 0,this.onceEvents[e]=void 0,typeof e=="symbol"&&this._symbolKeys.delete(e)),this}function setMaxListeners(e){return this.maxListeners=e,this}function getMaxListeners(){return this.maxListeners}function listeners(e){return this.emit===emit?this.events[e]?this.events[e].tasksAsArray().slice():[]:this.events[e]&&this.onceEvents[e]?__spreadArray(__spreadArray([],this.events[e].tasksAsArray(),!0),typeof this.onceEvents[e]=="function"?[this.onceEvents[e]]:this.onceEvents[e],!0):this.events[e]?this.events[e].tasksAsArray():this.onceEvents[e]?typeof this.onceEvents[e]=="function"?[this.onceEvents[e]]:this.onceEvents[e]:[]}function eventNames(){var e=this;if(this.emit===emit){var t=Object.keys(this.events);return __spreadArray(__spreadArray([],t,!0),Array.from(this._symbolKeys),!0).filter(function(s){return s in e.events&&e.events[s]&&e.events[s].length})}else{var t=Object.keys(this.events).filter(function(a){return e.events[a]&&e.events[a].length}),n=Object.keys(this.onceEvents).filter(function(a){return e.onceEvents[a]&&e.onceEvents[a].length});return __spreadArray(__spreadArray(__spreadArray([],t,!0),n,!0),Array.from(this._symbolKeys).filter(function(a){return a in e.events&&e.events[a]&&e.events[a].length||a in e.onceEvents&&e.onceEvents[a]&&e.onceEvents[a].length}),!0)}}function listenerCount(e){return this.emit===emit?this.events[e]&&this.events[e].length||0:(this.events[e]&&this.events[e].length||0)+(this.onceEvents[e]&&this.onceEvents[e].length||0)}EventEmitter.prototype.emit=emit;EventEmitter.prototype.on=addListener;EventEmitter.prototype.once=once;EventEmitter.prototype.addListener=addListener;EventEmitter.prototype.removeListener=removeListener;EventEmitter.prototype.addListenerBound=addListenerBound;EventEmitter.prototype.removeListenerBound=removeListenerBound;EventEmitter.prototype.hasListeners=hasListeners;EventEmitter.prototype.prependListener=prependListener;EventEmitter.prototype.prependOnceListener=prependOnceListener;EventEmitter.prototype.off=removeListener;EventEmitter.prototype.removeAllListeners=removeAllListeners;EventEmitter.prototype.setMaxListeners=setMaxListeners;EventEmitter.prototype.getMaxListeners=getMaxListeners;EventEmitter.prototype.listeners=listeners;EventEmitter.prototype.eventNames=eventNames;EventEmitter.prototype.listenerCount=listenerCount;(function(e){var t=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(s,a,l,de){de===void 0&&(de=l);var pe=Object.getOwnPropertyDescriptor(a,l);(!pe||("get"in pe?!a.__esModule:pe.writable||pe.configurable))&&(pe={enumerable:!0,get:function(){return a[l]}}),Object.defineProperty(s,de,pe)}:function(s,a,l,de){de===void 0&&(de=l),s[de]=a[l]}),n=commonjsGlobal&&commonjsGlobal.__exportStar||function(s,a){for(var l in s)l!=="default"&&!Object.prototype.hasOwnProperty.call(a,l)&&t(a,s,l)};Object.defineProperty(e,"__esModule",{value:!0}),n(types,e),n(ee,e)})(lib$1);var browser={exports:{}},ms,hasRequiredMs;function requireMs(){if(hasRequiredMs)return ms;hasRequiredMs=1;var e=1e3,t=e*60,n=t*60,s=n*24,a=s*7,l=s*365.25;ms=function(Le,Ye){Ye=Ye||{};var tt=typeof Le;if(tt==="string"&&Le.length>0)return de(Le);if(tt==="number"&&isFinite(Le))return Ye.long?me(Le):pe(Le);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(Le))};function de(Le){if(Le=String(Le),!(Le.length>100)){var Ye=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(Le);if(Ye){var tt=parseFloat(Ye[1]),ot=(Ye[2]||"ms").toLowerCase();switch(ot){case"years":case"year":case"yrs":case"yr":case"y":return tt*l;case"weeks":case"week":case"w":return tt*a;case"days":case"day":case"d":return tt*s;case"hours":case"hour":case"hrs":case"hr":case"h":return tt*n;case"minutes":case"minute":case"mins":case"min":case"m":return tt*t;case"seconds":case"second":case"secs":case"sec":case"s":return tt*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return tt;default:return}}}}function pe(Le){var Ye=Math.abs(Le);return Ye>=s?Math.round(Le/s)+"d":Ye>=n?Math.round(Le/n)+"h":Ye>=t?Math.round(Le/t)+"m":Ye>=e?Math.round(Le/e)+"s":Le+"ms"}function me(Le){var Ye=Math.abs(Le);return Ye>=s?Be(Le,Ye,s,"day"):Ye>=n?Be(Le,Ye,n,"hour"):Ye>=t?Be(Le,Ye,t,"minute"):Ye>=e?Be(Le,Ye,e,"second"):Le+" ms"}function Be(Le,Ye,tt,ot){var yt=Ye>=tt*1.5;return Math.round(Le/tt)+" "+ot+(yt?"s":"")}return ms}function setup(e){n.debug=n,n.default=n,n.coerce=me,n.disable=l,n.enable=a,n.enabled=de,n.humanize=requireMs(),n.destroy=Be,Object.keys(e).forEach(Le=>{n[Le]=e[Le]}),n.names=[],n.skips=[],n.formatters={};function t(Le){let Ye=0;for(let tt=0;tt<Le.length;tt++)Ye=(Ye<<5)-Ye+Le.charCodeAt(tt),Ye|=0;return n.colors[Math.abs(Ye)%n.colors.length]}n.selectColor=t;function n(Le){let Ye,tt=null,ot,yt;function nt(...st){if(!nt.enabled)return;const gt=nt,wt=Number(new Date),vt=wt-(Ye||wt);gt.diff=vt,gt.prev=Ye,gt.curr=wt,Ye=wt,st[0]=n.coerce(st[0]),typeof st[0]!="string"&&st.unshift("%O");let Rt=0;st[0]=st[0].replace(/%([a-zA-Z%])/g,($t,Ct)=>{if($t==="%%")return"%";Rt++;const kt=n.formatters[Ct];if(typeof kt=="function"){const Lt=st[Rt];$t=kt.call(gt,Lt),st.splice(Rt,1),Rt--}return $t}),n.formatArgs.call(gt,st),(gt.log||n.log).apply(gt,st)}return nt.namespace=Le,nt.useColors=n.useColors(),nt.color=n.selectColor(Le),nt.extend=s,nt.destroy=n.destroy,Object.defineProperty(nt,"enabled",{enumerable:!0,configurable:!1,get:()=>tt!==null?tt:(ot!==n.namespaces&&(ot=n.namespaces,yt=n.enabled(Le)),yt),set:st=>{tt=st}}),typeof n.init=="function"&&n.init(nt),nt}function s(Le,Ye){const tt=n(this.namespace+(typeof Ye>"u"?":":Ye)+Le);return tt.log=this.log,tt}function a(Le){n.save(Le),n.namespaces=Le,n.names=[],n.skips=[];let Ye;const tt=(typeof Le=="string"?Le:"").split(/[\s,]+/),ot=tt.length;for(Ye=0;Ye<ot;Ye++)tt[Ye]&&(Le=tt[Ye].replace(/\*/g,".*?"),Le[0]==="-"?n.skips.push(new RegExp("^"+Le.slice(1)+"$")):n.names.push(new RegExp("^"+Le+"$")))}function l(){const Le=[...n.names.map(pe),...n.skips.map(pe).map(Ye=>"-"+Ye)].join(",");return n.enable(""),Le}function de(Le){if(Le[Le.length-1]==="*")return!0;let Ye,tt;for(Ye=0,tt=n.skips.length;Ye<tt;Ye++)if(n.skips[Ye].test(Le))return!1;for(Ye=0,tt=n.names.length;Ye<tt;Ye++)if(n.names[Ye].test(Le))return!0;return!1}function pe(Le){return Le.toString().substring(2,Le.toString().length-2).replace(/\.\*\?$/,"*")}function me(Le){return Le instanceof Error?Le.stack||Le.message:Le}function Be(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}var common=setup;(function(e,t){var n={};t.formatArgs=a,t.save=l,t.load=de,t.useColors=s,t.storage=pe(),t.destroy=(()=>{let Be=!1;return()=>{Be||(Be=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function s(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let Be;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(Be=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(Be[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function a(Be){if(Be[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+Be[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const Le="color: "+this.color;Be.splice(1,0,Le,"color: inherit");let Ye=0,tt=0;Be[0].replace(/%[a-zA-Z%]/g,ot=>{ot!=="%%"&&(Ye++,ot==="%c"&&(tt=Ye))}),Be.splice(tt,0,Le)}t.log=console.debug||console.log||(()=>{});function l(Be){try{Be?t.storage.setItem("debug",Be):t.storage.removeItem("debug")}catch{}}function de(){let Be;try{Be=t.storage.getItem("debug")}catch{}return!Be&&typeof process<"u"&&"env"in process&&(Be=n.DEBUG),Be}function pe(){try{return localStorage}catch{}}e.exports=common(t);const{formatters:me}=e.exports;me.j=function(Be){try{return JSON.stringify(Be)}catch(Le){return"[UnexpectedJSONParseError]: "+Le.message}}})(browser,browser.exports);var browserExports=browser.exports;const debug7=getDefaultExportFromCjs(browserExports);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$3=BigInt(0),_1n$3=BigInt(1),_2n$1=BigInt(2),_3n$1=BigInt(3),_4n=BigInt(4),_5n=BigInt(5),_8n=BigInt(8);BigInt(9);BigInt(16);function mod(e,t){const n=e%t;return n>=_0n$3?n:t+n}function pow(e,t,n){if(n<=_0n$3||t<_0n$3)throw new Error("Expected power/modulo > 0");if(n===_1n$3)return _0n$3;let s=_1n$3;for(;t>_0n$3;)t&_1n$3&&(s=s*e%n),e=e*e%n,t>>=_1n$3;return s}function pow2(e,t,n){let s=e;for(;t-- >_0n$3;)s*=s,s%=n;return s}function invert(e,t){if(e===_0n$3||t<=_0n$3)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=mod(e,t),s=t,a=_0n$3,l=_1n$3;for(;n!==_0n$3;){const pe=s/n,me=s%n,Be=a-l*pe;s=n,n=me,a=l,l=Be}if(s!==_1n$3)throw new Error("invert: does not exist");return mod(a,t)}function tonelliShanks(e){const t=(e-_1n$3)/_2n$1;let n,s,a;for(n=e-_1n$3,s=0;n%_2n$1===_0n$3;n/=_2n$1,s++);for(a=_2n$1;a<e&&pow(a,t,e)!==e-_1n$3;a++);if(s===1){const de=(e+_1n$3)/_4n;return function(me,Be){const Le=me.pow(Be,de);if(!me.eql(me.sqr(Le),Be))throw new Error("Cannot find square root");return Le}}const l=(n+_1n$3)/_2n$1;return function(pe,me){if(pe.pow(me,t)===pe.neg(pe.ONE))throw new Error("Cannot find square root");let Be=s,Le=pe.pow(pe.mul(pe.ONE,a),n),Ye=pe.pow(me,l),tt=pe.pow(me,n);for(;!pe.eql(tt,pe.ONE);){if(pe.eql(tt,pe.ZERO))return pe.ZERO;let ot=1;for(let nt=pe.sqr(tt);ot<Be&&!pe.eql(nt,pe.ONE);ot++)nt=pe.sqr(nt);const yt=pe.pow(Le,_1n$3<<BigInt(Be-ot-1));Le=pe.sqr(yt),Ye=pe.mul(Ye,yt),tt=pe.mul(tt,Le),Be=ot}return Ye}}function FpSqrt(e){if(e%_4n===_3n$1){const t=(e+_1n$3)/_4n;return function(s,a){const l=s.pow(a,t);if(!s.eql(s.sqr(l),a))throw new Error("Cannot find square root");return l}}if(e%_8n===_5n){const t=(e-_5n)/_8n;return function(s,a){const l=s.mul(a,_2n$1),de=s.pow(l,t),pe=s.mul(a,de),me=s.mul(s.mul(pe,_2n$1),de),Be=s.mul(pe,s.sub(me,s.ONE));if(!s.eql(s.sqr(Be),a))throw new Error("Cannot find square root");return Be}}return tonelliShanks(e)}const FIELD_FIELDS=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function validateField(e){const t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=FIELD_FIELDS.reduce((s,a)=>(s[a]="function",s),t);return validateObject$1(e,n)}function FpPow(e,t,n){if(n<_0n$3)throw new Error("Expected power > 0");if(n===_0n$3)return e.ONE;if(n===_1n$3)return t;let s=e.ONE,a=t;for(;n>_0n$3;)n&_1n$3&&(s=e.mul(s,a)),a=e.sqr(a),n>>=_1n$3;return s}function FpInvertBatch(e,t){const n=new Array(t.length),s=t.reduce((l,de,pe)=>e.is0(de)?l:(n[pe]=l,e.mul(l,de)),e.ONE),a=e.inv(s);return t.reduceRight((l,de,pe)=>e.is0(de)?l:(n[pe]=e.mul(l,n[pe]),e.mul(l,de)),a),n}function nLength(e,t){const n=t!==void 0?t:e.toString(2).length,s=Math.ceil(n/8);return{nBitLength:n,nByteLength:s}}function Field(e,t,n=!1,s={}){if(e<=_0n$3)throw new Error(`Expected Field ORDER > 0, got ${e}`);const{nBitLength:a,nByteLength:l}=nLength(e,t);if(l>2048)throw new Error("Field lengths over 2048 bytes are not supported");const de=FpSqrt(e),pe=Object.freeze({ORDER:e,BITS:a,BYTES:l,MASK:bitMask$1(a),ZERO:_0n$3,ONE:_1n$3,create:me=>mod(me,e),isValid:me=>{if(typeof me!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof me}`);return _0n$3<=me&&me<e},is0:me=>me===_0n$3,isOdd:me=>(me&_1n$3)===_1n$3,neg:me=>mod(-me,e),eql:(me,Be)=>me===Be,sqr:me=>mod(me*me,e),add:(me,Be)=>mod(me+Be,e),sub:(me,Be)=>mod(me-Be,e),mul:(me,Be)=>mod(me*Be,e),pow:(me,Be)=>FpPow(pe,me,Be),div:(me,Be)=>mod(me*invert(Be,e),e),sqrN:me=>me*me,addN:(me,Be)=>me+Be,subN:(me,Be)=>me-Be,mulN:(me,Be)=>me*Be,inv:me=>invert(me,e),sqrt:s.sqrt||(me=>de(pe,me)),invertBatch:me=>FpInvertBatch(pe,me),cmov:(me,Be,Le)=>Le?Be:me,toBytes:me=>n?numberToBytesLE$1(me,l):numberToBytesBE$1(me,l),fromBytes:me=>{if(me.length!==l)throw new Error(`Fp.fromBytes: expected ${l}, got ${me.length}`);return n?bytesToNumberLE$1(me):bytesToNumberBE$1(me)}});return Object.freeze(pe)}function getFieldBytesLength(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function getMinHashLength(e){const t=getFieldBytesLength(e);return t+Math.ceil(t/2)}function mapHashToField(e,t,n=!1){const s=e.length,a=getFieldBytesLength(t),l=getMinHashLength(t);if(s<16||s<l||s>1024)throw new Error(`expected ${l}-1024 bytes of input, got ${s}`);const de=n?bytesToNumberBE$1(e):bytesToNumberLE$1(e),pe=mod(de,t-_1n$3)+_1n$3;return n?numberToBytesLE$1(pe,a):numberToBytesBE$1(pe,a)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$2=BigInt(0),_1n$2=BigInt(1),pointPrecomputes=new WeakMap,pointWindowSizes=new WeakMap;function wNAF(e,t){const n=(l,de)=>{const pe=de.negate();return l?pe:de},s=l=>{if(!Number.isSafeInteger(l)||l<=0||l>t)throw new Error(`Wrong window size=${l}, should be [1..${t}]`)},a=l=>{s(l);const de=Math.ceil(t/l)+1,pe=2**(l-1);return{windows:de,windowSize:pe}};return{constTimeNegate:n,unsafeLadder(l,de){let pe=e.ZERO,me=l;for(;de>_0n$2;)de&_1n$2&&(pe=pe.add(me)),me=me.double(),de>>=_1n$2;return pe},precomputeWindow(l,de){const{windows:pe,windowSize:me}=a(de),Be=[];let Le=l,Ye=Le;for(let tt=0;tt<pe;tt++){Ye=Le,Be.push(Ye);for(let ot=1;ot<me;ot++)Ye=Ye.add(Le),Be.push(Ye);Le=Ye.double()}return Be},wNAF(l,de,pe){const{windows:me,windowSize:Be}=a(l);let Le=e.ZERO,Ye=e.BASE;const tt=BigInt(2**l-1),ot=2**l,yt=BigInt(l);for(let nt=0;nt<me;nt++){const st=nt*Be;let gt=Number(pe&tt);pe>>=yt,gt>Be&&(gt-=ot,pe+=_1n$2);const wt=st,vt=st+Math.abs(gt)-1,Rt=nt%2!==0,Bt=gt<0;gt===0?Ye=Ye.add(n(Rt,de[wt])):Le=Le.add(n(Bt,de[vt]))}return{p:Le,f:Ye}},wNAFCached(l,de,pe){const me=pointWindowSizes.get(l)||1;let Be=pointPrecomputes.get(l);return Be||(Be=this.precomputeWindow(l,me),me!==1&&pointPrecomputes.set(l,pe(Be))),this.wNAF(me,Be,de)},setWindowSize(l,de){s(de),pointWindowSizes.set(l,de),pointPrecomputes.delete(l)}}}function pippenger(e,t,n,s){if(!Array.isArray(n)||!Array.isArray(s)||s.length!==n.length)throw new Error("arrays of points and scalars must have equal length");s.forEach((Le,Ye)=>{if(!t.isValid(Le))throw new Error(`wrong scalar at index ${Ye}`)}),n.forEach((Le,Ye)=>{if(!(Le instanceof e))throw new Error(`wrong point at index ${Ye}`)});const a=bitLen$1(BigInt(n.length)),l=a>12?a-3:a>4?a-2:a?2:1,de=(1<<l)-1,pe=new Array(de+1).fill(e.ZERO),me=Math.floor((t.BITS-1)/l)*l;let Be=e.ZERO;for(let Le=me;Le>=0;Le-=l){pe.fill(e.ZERO);for(let tt=0;tt<s.length;tt++){const ot=s[tt],yt=Number(ot>>BigInt(Le)&BigInt(de));pe[yt]=pe[yt].add(n[tt])}let Ye=e.ZERO;for(let tt=pe.length-1,ot=e.ZERO;tt>0;tt--)ot=ot.add(pe[tt]),Ye=Ye.add(ot);if(Be=Be.add(Ye),Le!==0)for(let tt=0;tt<l;tt++)Be=Be.double()}return Be}function validateBasic(e){return validateField(e.Fp),validateObject$1(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...nLength(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function validateSigVerOpts(e){e.lowS!==void 0&&abool("lowS",e.lowS),e.prehash!==void 0&&abool("prehash",e.prehash)}function validatePointOpts(e){const t=validateBasic(e);validateObject$1(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:s,a}=t;if(n){if(!s.eql(a,s.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}const{bytesToNumberBE:b2n,hexToBytes:h2b}=ut$2,DER={Err:class extends Error{constructor(t=""){super(t)}},_tlv:{encode:(e,t)=>{const{Err:n}=DER;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length&1)throw new n("tlv.encode: unpadded data");const s=t.length/2,a=numberToHexUnpadded$1(s);if(a.length/2&128)throw new n("tlv.encode: long form length too big");const l=s>127?numberToHexUnpadded$1(a.length/2|128):"";return`${numberToHexUnpadded$1(e)}${l}${a}${t}`},decode(e,t){const{Err:n}=DER;let s=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[s++]!==e)throw new n("tlv.decode: wrong tlv");const a=t[s++],l=!!(a&128);let de=0;if(!l)de=a;else{const me=a&127;if(!me)throw new n("tlv.decode(long): indefinite length not supported");if(me>4)throw new n("tlv.decode(long): byte length is too big");const Be=t.subarray(s,s+me);if(Be.length!==me)throw new n("tlv.decode: length bytes not complete");if(Be[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const Le of Be)de=de<<8|Le;if(s+=me,de<128)throw new n("tlv.decode(long): not minimal encoding")}const pe=t.subarray(s,s+de);if(pe.length!==de)throw new n("tlv.decode: wrong value length");return{v:pe,l:t.subarray(s+de)}}},_int:{encode(e){const{Err:t}=DER;if(e<_0n$1)throw new t("integer: negative integers are not allowed");let n=numberToHexUnpadded$1(e);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new t("unexpected assertion");return n},decode(e){const{Err:t}=DER;if(e[0]&128)throw new t("Invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return b2n(e)}},toSig(e){const{Err:t,_int:n,_tlv:s}=DER,a=typeof e=="string"?h2b(e):e;abytes(a);const{v:l,l:de}=s.decode(48,a);if(de.length)throw new t("Invalid signature: left bytes after parsing");const{v:pe,l:me}=s.decode(2,l),{v:Be,l:Le}=s.decode(2,me);if(Le.length)throw new t("Invalid signature: left bytes after parsing");return{r:n.decode(pe),s:n.decode(Be)}},hexFromSig(e){const{_tlv:t,_int:n}=DER,s=`${t.encode(2,n.encode(e.r))}${t.encode(2,n.encode(e.s))}`;return t.encode(48,s)}},_0n$1=BigInt(0),_1n$1=BigInt(1);BigInt(2);const _3n=BigInt(3);BigInt(4);function weierstrassPoints(e){const t=validatePointOpts(e),{Fp:n}=t,s=Field(t.n,t.nBitLength),a=t.toBytes||((nt,st,gt)=>{const wt=st.toAffine();return concatBytes$3(Uint8Array.from([4]),n.toBytes(wt.x),n.toBytes(wt.y))}),l=t.fromBytes||(nt=>{const st=nt.subarray(1),gt=n.fromBytes(st.subarray(0,n.BYTES)),wt=n.fromBytes(st.subarray(n.BYTES,2*n.BYTES));return{x:gt,y:wt}});function de(nt){const{a:st,b:gt}=t,wt=n.sqr(nt),vt=n.mul(wt,nt);return n.add(n.add(vt,n.mul(nt,st)),gt)}if(!n.eql(n.sqr(t.Gy),de(t.Gx)))throw new Error("bad generator point: equation left != right");function pe(nt){return inRange(nt,_1n$1,t.n)}function me(nt){const{allowedPrivateKeyLengths:st,nByteLength:gt,wrapPrivateKey:wt,n:vt}=t;if(st&&typeof nt!="bigint"){if(isBytes$1(nt)&&(nt=bytesToHex$2(nt)),typeof nt!="string"||!st.includes(nt.length))throw new Error("Invalid key");nt=nt.padStart(gt*2,"0")}let Rt;try{Rt=typeof nt=="bigint"?nt:bytesToNumberBE$1(ensureBytes$1("private key",nt,gt))}catch{throw new Error(`private key must be ${gt} bytes, hex or bigint, not ${typeof nt}`)}return wt&&(Rt=mod(Rt,vt)),aInRange("private key",Rt,_1n$1,vt),Rt}function Be(nt){if(!(nt instanceof tt))throw new Error("ProjectivePoint expected")}const Le=memoized((nt,st)=>{const{px:gt,py:wt,pz:vt}=nt;if(n.eql(vt,n.ONE))return{x:gt,y:wt};const Rt=nt.is0();st==null&&(st=Rt?n.ONE:n.inv(vt));const Bt=n.mul(gt,st),$t=n.mul(wt,st),Ct=n.mul(vt,st);if(Rt)return{x:n.ZERO,y:n.ZERO};if(!n.eql(Ct,n.ONE))throw new Error("invZ was invalid");return{x:Bt,y:$t}}),Ye=memoized(nt=>{if(nt.is0()){if(t.allowInfinityPoint&&!n.is0(nt.py))return;throw new Error("bad point: ZERO")}const{x:st,y:gt}=nt.toAffine();if(!n.isValid(st)||!n.isValid(gt))throw new Error("bad point: x or y not FE");const wt=n.sqr(gt),vt=de(st);if(!n.eql(wt,vt))throw new Error("bad point: equation left != right");if(!nt.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class tt{constructor(st,gt,wt){if(this.px=st,this.py=gt,this.pz=wt,st==null||!n.isValid(st))throw new Error("x required");if(gt==null||!n.isValid(gt))throw new Error("y required");if(wt==null||!n.isValid(wt))throw new Error("z required");Object.freeze(this)}static fromAffine(st){const{x:gt,y:wt}=st||{};if(!st||!n.isValid(gt)||!n.isValid(wt))throw new Error("invalid affine point");if(st instanceof tt)throw new Error("projective point not allowed");const vt=Rt=>n.eql(Rt,n.ZERO);return vt(gt)&&vt(wt)?tt.ZERO:new tt(gt,wt,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(st){const gt=n.invertBatch(st.map(wt=>wt.pz));return st.map((wt,vt)=>wt.toAffine(gt[vt])).map(tt.fromAffine)}static fromHex(st){const gt=tt.fromAffine(l(ensureBytes$1("pointHex",st)));return gt.assertValidity(),gt}static fromPrivateKey(st){return tt.BASE.multiply(me(st))}static msm(st,gt){return pippenger(tt,s,st,gt)}_setWindowSize(st){yt.setWindowSize(this,st)}assertValidity(){Ye(this)}hasEvenY(){const{y:st}=this.toAffine();if(n.isOdd)return!n.isOdd(st);throw new Error("Field doesn't support isOdd")}equals(st){Be(st);const{px:gt,py:wt,pz:vt}=this,{px:Rt,py:Bt,pz:$t}=st,Ct=n.eql(n.mul(gt,$t),n.mul(Rt,vt)),kt=n.eql(n.mul(wt,$t),n.mul(Bt,vt));return Ct&&kt}negate(){return new tt(this.px,n.neg(this.py),this.pz)}double(){const{a:st,b:gt}=t,wt=n.mul(gt,_3n),{px:vt,py:Rt,pz:Bt}=this;let $t=n.ZERO,Ct=n.ZERO,kt=n.ZERO,Lt=n.mul(vt,vt),Pt=n.mul(Rt,Rt),mt=n.mul(Bt,Bt),_t=n.mul(vt,Rt);return _t=n.add(_t,_t),kt=n.mul(vt,Bt),kt=n.add(kt,kt),$t=n.mul(st,kt),Ct=n.mul(wt,mt),Ct=n.add($t,Ct),$t=n.sub(Pt,Ct),Ct=n.add(Pt,Ct),Ct=n.mul($t,Ct),$t=n.mul(_t,$t),kt=n.mul(wt,kt),mt=n.mul(st,mt),_t=n.sub(Lt,mt),_t=n.mul(st,_t),_t=n.add(_t,kt),kt=n.add(Lt,Lt),Lt=n.add(kt,Lt),Lt=n.add(Lt,mt),Lt=n.mul(Lt,_t),Ct=n.add(Ct,Lt),mt=n.mul(Rt,Bt),mt=n.add(mt,mt),Lt=n.mul(mt,_t),$t=n.sub($t,Lt),kt=n.mul(mt,Pt),kt=n.add(kt,kt),kt=n.add(kt,kt),new tt($t,Ct,kt)}add(st){Be(st);const{px:gt,py:wt,pz:vt}=this,{px:Rt,py:Bt,pz:$t}=st;let Ct=n.ZERO,kt=n.ZERO,Lt=n.ZERO;const Pt=t.a,mt=n.mul(t.b,_3n);let _t=n.mul(gt,Rt),Tt=n.mul(wt,Bt),xt=n.mul(vt,$t),ht=n.add(gt,wt),ft=n.add(Rt,Bt);ht=n.mul(ht,ft),ft=n.add(_t,Tt),ht=n.sub(ht,ft),ft=n.add(gt,vt);let Et=n.add(Rt,$t);return ft=n.mul(ft,Et),Et=n.add(_t,xt),ft=n.sub(ft,Et),Et=n.add(wt,vt),Ct=n.add(Bt,$t),Et=n.mul(Et,Ct),Ct=n.add(Tt,xt),Et=n.sub(Et,Ct),Lt=n.mul(Pt,ft),Ct=n.mul(mt,xt),Lt=n.add(Ct,Lt),Ct=n.sub(Tt,Lt),Lt=n.add(Tt,Lt),kt=n.mul(Ct,Lt),Tt=n.add(_t,_t),Tt=n.add(Tt,_t),xt=n.mul(Pt,xt),ft=n.mul(mt,ft),Tt=n.add(Tt,xt),xt=n.sub(_t,xt),xt=n.mul(Pt,xt),ft=n.add(ft,xt),_t=n.mul(Tt,ft),kt=n.add(kt,_t),_t=n.mul(Et,ft),Ct=n.mul(ht,Ct),Ct=n.sub(Ct,_t),_t=n.mul(ht,Tt),Lt=n.mul(Et,Lt),Lt=n.add(Lt,_t),new tt(Ct,kt,Lt)}subtract(st){return this.add(st.negate())}is0(){return this.equals(tt.ZERO)}wNAF(st){return yt.wNAFCached(this,st,tt.normalizeZ)}multiplyUnsafe(st){aInRange("scalar",st,_0n$1,t.n);const gt=tt.ZERO;if(st===_0n$1)return gt;if(st===_1n$1)return this;const{endo:wt}=t;if(!wt)return yt.unsafeLadder(this,st);let{k1neg:vt,k1:Rt,k2neg:Bt,k2:$t}=wt.splitScalar(st),Ct=gt,kt=gt,Lt=this;for(;Rt>_0n$1||$t>_0n$1;)Rt&_1n$1&&(Ct=Ct.add(Lt)),$t&_1n$1&&(kt=kt.add(Lt)),Lt=Lt.double(),Rt>>=_1n$1,$t>>=_1n$1;return vt&&(Ct=Ct.negate()),Bt&&(kt=kt.negate()),kt=new tt(n.mul(kt.px,wt.beta),kt.py,kt.pz),Ct.add(kt)}multiply(st){const{endo:gt,n:wt}=t;aInRange("scalar",st,_1n$1,wt);let vt,Rt;if(gt){const{k1neg:Bt,k1:$t,k2neg:Ct,k2:kt}=gt.splitScalar(st);let{p:Lt,f:Pt}=this.wNAF($t),{p:mt,f:_t}=this.wNAF(kt);Lt=yt.constTimeNegate(Bt,Lt),mt=yt.constTimeNegate(Ct,mt),mt=new tt(n.mul(mt.px,gt.beta),mt.py,mt.pz),vt=Lt.add(mt),Rt=Pt.add(_t)}else{const{p:Bt,f:$t}=this.wNAF(st);vt=Bt,Rt=$t}return tt.normalizeZ([vt,Rt])[0]}multiplyAndAddUnsafe(st,gt,wt){const vt=tt.BASE,Rt=($t,Ct)=>Ct===_0n$1||Ct===_1n$1||!$t.equals(vt)?$t.multiplyUnsafe(Ct):$t.multiply(Ct),Bt=Rt(this,gt).add(Rt(st,wt));return Bt.is0()?void 0:Bt}toAffine(st){return Le(this,st)}isTorsionFree(){const{h:st,isTorsionFree:gt}=t;if(st===_1n$1)return!0;if(gt)return gt(tt,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:st,clearCofactor:gt}=t;return st===_1n$1?this:gt?gt(tt,this):this.multiplyUnsafe(t.h)}toRawBytes(st=!0){return abool("isCompressed",st),this.assertValidity(),a(tt,this,st)}toHex(st=!0){return abool("isCompressed",st),bytesToHex$2(this.toRawBytes(st))}}tt.BASE=new tt(t.Gx,t.Gy,n.ONE),tt.ZERO=new tt(n.ZERO,n.ONE,n.ZERO);const ot=t.nBitLength,yt=wNAF(tt,t.endo?Math.ceil(ot/2):ot);return{CURVE:t,ProjectivePoint:tt,normPrivateKeyToScalar:me,weierstrassEquation:de,isWithinCurveOrder:pe}}function validateOpts(e){const t=validateBasic(e);return validateObject$1(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function weierstrass(e){const t=validateOpts(e),{Fp:n,n:s}=t,a=n.BYTES+1,l=2*n.BYTES+1;function de(xt){return mod(xt,s)}function pe(xt){return invert(xt,s)}const{ProjectivePoint:me,normPrivateKeyToScalar:Be,weierstrassEquation:Le,isWithinCurveOrder:Ye}=weierstrassPoints({...t,toBytes(xt,ht,ft){const Et=ht.toAffine(),St=n.toBytes(Et.x),At=concatBytes$3;return abool("isCompressed",ft),ft?At(Uint8Array.from([ht.hasEvenY()?2:3]),St):At(Uint8Array.from([4]),St,n.toBytes(Et.y))},fromBytes(xt){const ht=xt.length,ft=xt[0],Et=xt.subarray(1);if(ht===a&&(ft===2||ft===3)){const St=bytesToNumberBE$1(Et);if(!inRange(St,_1n$1,n.ORDER))throw new Error("Point is not on curve");const At=Le(St);let Nt;try{Nt=n.sqrt(At)}catch(jt){const Ft=jt instanceof Error?": "+jt.message:"";throw new Error("Point is not on curve"+Ft)}const It=(Nt&_1n$1)===_1n$1;return(ft&1)===1!==It&&(Nt=n.neg(Nt)),{x:St,y:Nt}}else if(ht===l&&ft===4){const St=n.fromBytes(Et.subarray(0,n.BYTES)),At=n.fromBytes(Et.subarray(n.BYTES,2*n.BYTES));return{x:St,y:At}}else throw new Error(`Point of length ${ht} was invalid. Expected ${a} compressed bytes or ${l} uncompressed bytes`)}}),tt=xt=>bytesToHex$2(numberToBytesBE$1(xt,t.nByteLength));function ot(xt){const ht=s>>_1n$1;return xt>ht}function yt(xt){return ot(xt)?de(-xt):xt}const nt=(xt,ht,ft)=>bytesToNumberBE$1(xt.slice(ht,ft));class st{constructor(ht,ft,Et){this.r=ht,this.s=ft,this.recovery=Et,this.assertValidity()}static fromCompact(ht){const ft=t.nByteLength;return ht=ensureBytes$1("compactSignature",ht,ft*2),new st(nt(ht,0,ft),nt(ht,ft,2*ft))}static fromDER(ht){const{r:ft,s:Et}=DER.toSig(ensureBytes$1("DER",ht));return new st(ft,Et)}assertValidity(){aInRange("r",this.r,_1n$1,s),aInRange("s",this.s,_1n$1,s)}addRecoveryBit(ht){return new st(this.r,this.s,ht)}recoverPublicKey(ht){const{r:ft,s:Et,recovery:St}=this,At=$t(ensureBytes$1("msgHash",ht));if(St==null||![0,1,2,3].includes(St))throw new Error("recovery id invalid");const Nt=St===2||St===3?ft+t.n:ft;if(Nt>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const It=St&1?"03":"02",Mt=me.fromHex(It+tt(Nt)),jt=pe(Nt),Ft=de(-At*jt),Ut=de(Et*jt),Ot=me.BASE.multiplyAndAddUnsafe(Mt,Ft,Ut);if(!Ot)throw new Error("point at infinify");return Ot.assertValidity(),Ot}hasHighS(){return ot(this.s)}normalizeS(){return this.hasHighS()?new st(this.r,de(-this.s),this.recovery):this}toDERRawBytes(){return hexToBytes$2(this.toDERHex())}toDERHex(){return DER.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return hexToBytes$2(this.toCompactHex())}toCompactHex(){return tt(this.r)+tt(this.s)}}const gt={isValidPrivateKey(xt){try{return Be(xt),!0}catch{return!1}},normPrivateKeyToScalar:Be,randomPrivateKey:()=>{const xt=getMinHashLength(t.n);return mapHashToField(t.randomBytes(xt),t.n)},precompute(xt=8,ht=me.BASE){return ht._setWindowSize(xt),ht.multiply(BigInt(3)),ht}};function wt(xt,ht=!0){return me.fromPrivateKey(xt).toRawBytes(ht)}function vt(xt){const ht=isBytes$1(xt),ft=typeof xt=="string",Et=(ht||ft)&&xt.length;return ht?Et===a||Et===l:ft?Et===2*a||Et===2*l:xt instanceof me}function Rt(xt,ht,ft=!0){if(vt(xt))throw new Error("first arg must be private key");if(!vt(ht))throw new Error("second arg must be public key");return me.fromHex(ht).multiply(Be(xt)).toRawBytes(ft)}const Bt=t.bits2int||function(xt){const ht=bytesToNumberBE$1(xt),ft=xt.length*8-t.nBitLength;return ft>0?ht>>BigInt(ft):ht},$t=t.bits2int_modN||function(xt){return de(Bt(xt))},Ct=bitMask$1(t.nBitLength);function kt(xt){return aInRange(`num < 2^${t.nBitLength}`,xt,_0n$1,Ct),numberToBytesBE$1(xt,t.nByteLength)}function Lt(xt,ht,ft=Pt){if(["recovered","canonical"].some(Vt=>Vt in ft))throw new Error("sign() legacy options not supported");const{hash:Et,randomBytes:St}=t;let{lowS:At,prehash:Nt,extraEntropy:It}=ft;At==null&&(At=!0),xt=ensureBytes$1("msgHash",xt),validateSigVerOpts(ft),Nt&&(xt=ensureBytes$1("prehashed msgHash",Et(xt)));const Mt=$t(xt),jt=Be(ht),Ft=[kt(jt),kt(Mt)];if(It!=null&&It!==!1){const Vt=It===!0?St(n.BYTES):It;Ft.push(ensureBytes$1("extraEntropy",Vt))}const Ut=concatBytes$3(...Ft),Ot=Mt;function Ht(Vt){const Dt=Bt(Vt);if(!Ye(Dt))return;const qt=pe(Dt),Wt=me.BASE.multiply(Dt).toAffine(),zt=de(Wt.x);if(zt===_0n$1)return;const Gt=de(qt*de(Ot+zt*jt));if(Gt===_0n$1)return;let Zt=(Wt.x===zt?0:2)|Number(Wt.y&_1n$1),Kt=Gt;return At&&ot(Gt)&&(Kt=yt(Gt),Zt^=1),new st(zt,Kt,Zt)}return{seed:Ut,k2sig:Ht}}const Pt={lowS:t.lowS,prehash:!1},mt={lowS:t.lowS,prehash:!1};function _t(xt,ht,ft=Pt){const{seed:Et,k2sig:St}=Lt(xt,ht,ft),At=t;return createHmacDrbg$1(At.hash.outputLen,At.nByteLength,At.hmac)(Et,St)}me.BASE._setWindowSize(8);function Tt(xt,ht,ft,Et=mt){var Wt;const St=xt;if(ht=ensureBytes$1("msgHash",ht),ft=ensureBytes$1("publicKey",ft),"strict"in Et)throw new Error("options.strict was renamed to lowS");validateSigVerOpts(Et);const{lowS:At,prehash:Nt}=Et;let It,Mt;try{if(typeof St=="string"||isBytes$1(St))try{It=st.fromDER(St)}catch(zt){if(!(zt instanceof DER.Err))throw zt;It=st.fromCompact(St)}else if(typeof St=="object"&&typeof St.r=="bigint"&&typeof St.s=="bigint"){const{r:zt,s:Gt}=St;It=new st(zt,Gt)}else throw new Error("PARSE");Mt=me.fromHex(ft)}catch(zt){if(zt.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(At&&It.hasHighS())return!1;Nt&&(ht=t.hash(ht));const{r:jt,s:Ft}=It,Ut=$t(ht),Ot=pe(Ft),Ht=de(Ut*Ot),Vt=de(jt*Ot),Dt=(Wt=me.BASE.multiplyAndAddUnsafe(Mt,Ht,Vt))==null?void 0:Wt.toAffine();return Dt?de(Dt.x)===jt:!1}return{CURVE:t,getPublicKey:wt,getSharedSecret:Rt,sign:_t,verify:Tt,ProjectivePoint:me,Signature:st,utils:gt}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function getHash(e){return{hash:e,hmac:(t,...n)=>hmac$2(e,t,concatBytes$4(...n)),randomBytes:randomBytes$2}}function createCurve(e,t){const n=s=>weierstrass({...e,...getHash(s)});return Object.freeze({...n(t),create:n})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const secp256k1P=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),secp256k1N=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),_1n=BigInt(1),_2n=BigInt(2),divNearest=(e,t)=>(e+t/_2n)/t;function sqrtMod(e){const t=secp256k1P,n=BigInt(3),s=BigInt(6),a=BigInt(11),l=BigInt(22),de=BigInt(23),pe=BigInt(44),me=BigInt(88),Be=e*e*e%t,Le=Be*Be*e%t,Ye=pow2(Le,n,t)*Le%t,tt=pow2(Ye,n,t)*Le%t,ot=pow2(tt,_2n,t)*Be%t,yt=pow2(ot,a,t)*ot%t,nt=pow2(yt,l,t)*yt%t,st=pow2(nt,pe,t)*nt%t,gt=pow2(st,me,t)*st%t,wt=pow2(gt,pe,t)*nt%t,vt=pow2(wt,n,t)*Le%t,Rt=pow2(vt,de,t)*yt%t,Bt=pow2(Rt,s,t)*Be%t,$t=pow2(Bt,_2n,t);if(!Fp.eql(Fp.sqr($t),e))throw new Error("Cannot find square root");return $t}const Fp=Field(secp256k1P,void 0,void 0,{sqrt:sqrtMod}),secp256k1=createCurve({a:BigInt(0),b:BigInt(7),Fp,n:secp256k1N,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=secp256k1N,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),s=-_1n*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),a=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),l=n,de=BigInt("0x100000000000000000000000000000000"),pe=divNearest(l*e,t),me=divNearest(-s*e,t);let Be=mod(e-pe*n-me*a,t),Le=mod(-pe*s-me*l,t);const Ye=Be>de,tt=Le>de;if(Ye&&(Be=t-Be),tt&&(Le=t-Le),Be>de||Le>de)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:Ye,k1:Be,k2neg:tt,k2:Le}}}},sha256$2),_0n=BigInt(0),TAGGED_HASH_PREFIXES={};function taggedHash(e,...t){let n=TAGGED_HASH_PREFIXES[e];if(n===void 0){const s=sha256$2(Uint8Array.from(e,a=>a.charCodeAt(0)));n=concatBytes$3(s,s),TAGGED_HASH_PREFIXES[e]=n}return sha256$2(concatBytes$3(n,...t))}const pointToBytes=e=>e.toRawBytes(!0).slice(1),numTo32b=e=>numberToBytesBE$1(e,32),modP=e=>mod(e,secp256k1P),modN=e=>mod(e,secp256k1N),Point=secp256k1.ProjectivePoint,GmulAdd=(e,t,n)=>Point.BASE.multiplyAndAddUnsafe(e,t,n);function schnorrGetExtPubKey(e){let t=secp256k1.utils.normPrivateKeyToScalar(e),n=Point.fromPrivateKey(t);return{scalar:n.hasEvenY()?t:modN(-t),bytes:pointToBytes(n)}}function lift_x(e){aInRange("x",e,_1n,secp256k1P);const t=modP(e*e),n=modP(t*e+BigInt(7));let s=sqrtMod(n);s%_2n!==_0n&&(s=modP(-s));const a=new Point(e,s,_1n);return a.assertValidity(),a}const num=bytesToNumberBE$1;function challenge(...e){return modN(num(taggedHash("BIP0340/challenge",...e)))}function schnorrGetPublicKey(e){return schnorrGetExtPubKey(e).bytes}function schnorrSign(e,t,n=randomBytes$2(32)){const s=ensureBytes$1("message",e),{bytes:a,scalar:l}=schnorrGetExtPubKey(t),de=ensureBytes$1("auxRand",n,32),pe=numTo32b(l^num(taggedHash("BIP0340/aux",de))),me=taggedHash("BIP0340/nonce",pe,a,s),Be=modN(num(me));if(Be===_0n)throw new Error("sign failed: k is zero");const{bytes:Le,scalar:Ye}=schnorrGetExtPubKey(Be),tt=challenge(Le,a,s),ot=new Uint8Array(64);if(ot.set(Le,0),ot.set(numTo32b(modN(Ye+tt*l)),32),!schnorrVerify(ot,s,a))throw new Error("sign: Invalid signature produced");return ot}function schnorrVerify(e,t,n){const s=ensureBytes$1("signature",e,64),a=ensureBytes$1("message",t),l=ensureBytes$1("publicKey",n,32);try{const de=lift_x(num(l)),pe=num(s.subarray(0,32));if(!inRange(pe,_1n,secp256k1P))return!1;const me=num(s.subarray(32,64));if(!inRange(me,_1n,secp256k1N))return!1;const Be=challenge(numTo32b(pe),pointToBytes(de),a),Le=GmulAdd(de,me,modN(-Be));return!(!Le||!Le.hasEvenY()||Le.toAffine().x!==pe)}catch{return!1}}const schnorr={getPublicKey:schnorrGetPublicKey,sign:schnorrSign,verify:schnorrVerify,utils:{randomPrivateKey:secp256k1.utils.randomPrivateKey,lift_x,pointToBytes,numberToBytesBE:numberToBytesBE$1,bytesToNumberBE:bytesToNumberBE$1,taggedHash,mod}};var dist={},LRUCache$1={},LRUCacheNode$1={};Object.defineProperty(LRUCacheNode$1,"__esModule",{value:!0});LRUCacheNode$1.LRUCacheNode=void 0;class LRUCacheNode{constructor(t,n,s){const{entryExpirationTimeInMS:a=null,next:l=null,prev:de=null,onEntryEvicted:pe,onEntryMarkedAsMostRecentlyUsed:me,clone:Be,cloneFn:Le}=s??{};if(typeof a=="number"&&(a<=0||Number.isNaN(a)))throw new Error("entryExpirationTimeInMS must either be null (no expiry) or greater than 0");this.clone=Be??!1,this.cloneFn=Le??this.defaultClone,this.key=t,this.internalValue=this.clone?this.cloneFn(n):n,this.created=Date.now(),this.entryExpirationTimeInMS=a,this.next=l,this.prev=de,this.onEntryEvicted=pe,this.onEntryMarkedAsMostRecentlyUsed=me}get value(){return this.clone?this.cloneFn(this.internalValue):this.internalValue}get isExpired(){return typeof this.entryExpirationTimeInMS=="number"&&Date.now()-this.created>this.entryExpirationTimeInMS}invokeOnEvicted(){if(this.onEntryEvicted){const{key:t,value:n,isExpired:s}=this;this.onEntryEvicted({key:t,value:n,isExpired:s})}}invokeOnEntryMarkedAsMostRecentlyUsed(){if(this.onEntryMarkedAsMostRecentlyUsed){const{key:t,value:n}=this;this.onEntryMarkedAsMostRecentlyUsed({key:t,value:n})}}defaultClone(t){return typeof t=="boolean"||typeof t=="string"||typeof t=="number"?t:JSON.parse(JSON.stringify(t))}}LRUCacheNode$1.LRUCacheNode=LRUCacheNode;Object.defineProperty(LRUCache$1,"__esModule",{value:!0});LRUCache$1.LRUCache=void 0;const LRUCacheNode_1=LRUCacheNode$1;class LRUCache{constructor(t){this.lookupTable=new Map,this.head=null,this.tail=null;const{maxSize:n=25,entryExpirationTimeInMS:s=null,onEntryEvicted:a,onEntryMarkedAsMostRecentlyUsed:l,cloneFn:de,clone:pe}=t??{};if(Number.isNaN(n)||n<=0)throw new Error("maxSize must be greater than 0.");if(typeof s=="number"&&(s<=0||Number.isNaN(s)))throw new Error("entryExpirationTimeInMS must either be null (no expiry) or greater than 0");this.maxSizeInternal=n,this.entryExpirationTimeInMS=s,this.onEntryEvicted=a,this.onEntryMarkedAsMostRecentlyUsed=l,this.clone=pe,this.cloneFn=de}get size(){return this.cleanCache(),this.lookupTable.size}get remainingSize(){return this.maxSizeInternal-this.size}get newest(){return this.head?this.head.isExpired?(this.removeNodeFromListAndLookupTable(this.head),this.newest):this.mapNodeToEntry(this.head):null}get oldest(){return this.tail?this.tail.isExpired?(this.removeNodeFromListAndLookupTable(this.tail),this.oldest):this.mapNodeToEntry(this.tail):null}get maxSize(){return this.maxSizeInternal}set maxSize(t){if(Number.isNaN(t)||t<=0)throw new Error("maxSize must be greater than 0.");this.maxSizeInternal=t,this.enforceSizeLimit()}set(t,n,s){const a=this.lookupTable.get(t);a&&this.removeNodeFromListAndLookupTable(a);const l=new LRUCacheNode_1.LRUCacheNode(t,n,{entryExpirationTimeInMS:this.entryExpirationTimeInMS,onEntryEvicted:this.onEntryEvicted,onEntryMarkedAsMostRecentlyUsed:this.onEntryMarkedAsMostRecentlyUsed,clone:this.clone,cloneFn:this.cloneFn,...s});return this.setNodeAsHead(l),this.lookupTable.set(t,l),this.enforceSizeLimit(),this}get(t){const n=this.lookupTable.get(t);return n?n.isExpired?(this.removeNodeFromListAndLookupTable(n),null):(this.setNodeAsHead(n),n.value):null}peek(t){const n=this.lookupTable.get(t);return n?n.isExpired?(this.removeNodeFromListAndLookupTable(n),null):n.value:null}delete(t){const n=this.lookupTable.get(t);return n?this.removeNodeFromListAndLookupTable(n):!1}has(t){const n=this.lookupTable.get(t);return n?n.isExpired?(this.removeNodeFromListAndLookupTable(n),!1):!0:!1}clear(){this.head=null,this.tail=null,this.lookupTable.clear()}find(t){let n=this.head;for(;n;){if(n.isExpired){const a=n.next;this.removeNodeFromListAndLookupTable(n),n=a;continue}const s=this.mapNodeToEntry(n);if(t(s))return this.setNodeAsHead(n),s;n=n.next}return null}forEach(t){let n=this.head,s=0;for(;n;){if(n.isExpired){const a=n.next;this.removeNodeFromListAndLookupTable(n),n=a;continue}t(n.value,n.key,s),n=n.next,s++}}*values(){let t=this.head;for(;t;){if(t.isExpired){const n=t.next;this.removeNodeFromListAndLookupTable(t),t=n;continue}yield t.value,t=t.next}}*keys(){let t=this.head;for(;t;){if(t.isExpired){const n=t.next;this.removeNodeFromListAndLookupTable(t),t=n;continue}yield t.key,t=t.next}}*entries(){let t=this.head;for(;t;){if(t.isExpired){const n=t.next;this.removeNodeFromListAndLookupTable(t),t=n;continue}yield this.mapNodeToEntry(t),t=t.next}}*[Symbol.iterator](){let t=this.head;for(;t;){if(t.isExpired){const n=t.next;this.removeNodeFromListAndLookupTable(t),t=n;continue}yield this.mapNodeToEntry(t),t=t.next}}enforceSizeLimit(){let t=this.tail;for(;t!==null&&this.size>this.maxSizeInternal;){const n=t.prev;this.removeNodeFromListAndLookupTable(t),t=n}}mapNodeToEntry({key:t,value:n}){return{key:t,value:n}}setNodeAsHead(t){this.removeNodeFromList(t),this.head?(t.next=this.head,this.head.prev=t,this.head=t):(this.head=t,this.tail=t),t.invokeOnEntryMarkedAsMostRecentlyUsed()}removeNodeFromList(t){t.prev!==null&&(t.prev.next=t.next),t.next!==null&&(t.next.prev=t.prev),this.head===t&&(this.head=t.next),this.tail===t&&(this.tail=t.prev),t.next=null,t.prev=null}removeNodeFromListAndLookupTable(t){return t.invokeOnEvicted(),this.removeNodeFromList(t),this.lookupTable.delete(t.key)}cleanCache(){if(!this.entryExpirationTimeInMS)return;const t=[];for(const n of this.lookupTable.values())n.isExpired&&t.push(n);t.forEach(n=>this.removeNodeFromListAndLookupTable(n))}}LRUCache$1.LRUCache=LRUCache;(function(e){var t=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(s,a,l,de){de===void 0&&(de=l);var pe=Object.getOwnPropertyDescriptor(a,l);(!pe||("get"in pe?!a.__esModule:pe.writable||pe.configurable))&&(pe={enumerable:!0,get:function(){return a[l]}}),Object.defineProperty(s,de,pe)}:function(s,a,l,de){de===void 0&&(de=l),s[de]=a[l]}),n=commonjsGlobal&&commonjsGlobal.__exportStar||function(s,a){for(var l in s)l!=="default"&&!Object.prototype.hasOwnProperty.call(a,l)&&t(a,s,l)};Object.defineProperty(e,"__esModule",{value:!0}),n(LRUCache$1,e)})(dist);var lib={};(function(e){/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(e,"__esModule",{value:!0}),e.bytes=e.stringToBytes=e.str=e.bytesToString=e.hex=e.utf8=e.bech32m=e.bech32=e.base58check=e.base58xmr=e.base58xrp=e.base58flickr=e.base58=e.base64url=e.base64=e.base32crockford=e.base32hex=e.base32=e.base16=e.utils=e.assertNumber=void 0;function t(mt){if(!Number.isSafeInteger(mt))throw new Error(`Wrong integer: ${mt}`)}e.assertNumber=t;function n(...mt){const _t=(ht,ft)=>Et=>ht(ft(Et)),Tt=Array.from(mt).reverse().reduce((ht,ft)=>ht?_t(ht,ft.encode):ft.encode,void 0),xt=mt.reduce((ht,ft)=>ht?_t(ht,ft.decode):ft.decode,void 0);return{encode:Tt,decode:xt}}function s(mt){return{encode:_t=>{if(!Array.isArray(_t)||_t.length&&typeof _t[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return _t.map(Tt=>{if(t(Tt),Tt<0||Tt>=mt.length)throw new Error(`Digit index outside alphabet: ${Tt} (alphabet: ${mt.length})`);return mt[Tt]})},decode:_t=>{if(!Array.isArray(_t)||_t.length&&typeof _t[0]!="string")throw new Error("alphabet.decode input should be array of strings");return _t.map(Tt=>{if(typeof Tt!="string")throw new Error(`alphabet.decode: not string element=${Tt}`);const xt=mt.indexOf(Tt);if(xt===-1)throw new Error(`Unknown letter: "${Tt}". Allowed: ${mt}`);return xt})}}}function a(mt=""){if(typeof mt!="string")throw new Error("join separator should be string");return{encode:_t=>{if(!Array.isArray(_t)||_t.length&&typeof _t[0]!="string")throw new Error("join.encode input should be array of strings");for(let Tt of _t)if(typeof Tt!="string")throw new Error(`join.encode: non-string input=${Tt}`);return _t.join(mt)},decode:_t=>{if(typeof _t!="string")throw new Error("join.decode input should be string");return _t.split(mt)}}}function l(mt,_t="="){if(t(mt),typeof _t!="string")throw new Error("padding chr should be string");return{encode(Tt){if(!Array.isArray(Tt)||Tt.length&&typeof Tt[0]!="string")throw new Error("padding.encode input should be array of strings");for(let xt of Tt)if(typeof xt!="string")throw new Error(`padding.encode: non-string input=${xt}`);for(;Tt.length*mt%8;)Tt.push(_t);return Tt},decode(Tt){if(!Array.isArray(Tt)||Tt.length&&typeof Tt[0]!="string")throw new Error("padding.encode input should be array of strings");for(let ht of Tt)if(typeof ht!="string")throw new Error(`padding.decode: non-string input=${ht}`);let xt=Tt.length;if(xt*mt%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;xt>0&&Tt[xt-1]===_t;xt--)if(!((xt-1)*mt%8))throw new Error("Invalid padding: string has too much padding");return Tt.slice(0,xt)}}}function de(mt){if(typeof mt!="function")throw new Error("normalize fn should be function");return{encode:_t=>_t,decode:_t=>mt(_t)}}function pe(mt,_t,Tt){if(_t<2)throw new Error(`convertRadix: wrong from=${_t}, base cannot be less than 2`);if(Tt<2)throw new Error(`convertRadix: wrong to=${Tt}, base cannot be less than 2`);if(!Array.isArray(mt))throw new Error("convertRadix: data should be array");if(!mt.length)return[];let xt=0;const ht=[],ft=Array.from(mt);for(ft.forEach(Et=>{if(t(Et),Et<0||Et>=_t)throw new Error(`Wrong integer: ${Et}`)});;){let Et=0,St=!0;for(let At=xt;At<ft.length;At++){const Nt=ft[At],It=_t*Et+Nt;if(!Number.isSafeInteger(It)||_t*Et/_t!==Et||It-Nt!==_t*Et)throw new Error("convertRadix: carry overflow");if(Et=It%Tt,ft[At]=Math.floor(It/Tt),!Number.isSafeInteger(ft[At])||ft[At]*Tt+Et!==It)throw new Error("convertRadix: carry overflow");if(St)ft[At]?St=!1:xt=At;else continue}if(ht.push(Et),St)break}for(let Et=0;Et<mt.length-1&&mt[Et]===0;Et++)ht.push(0);return ht.reverse()}const me=(mt,_t)=>_t?me(_t,mt%_t):mt,Be=(mt,_t)=>mt+(_t-me(mt,_t));function Le(mt,_t,Tt,xt){if(!Array.isArray(mt))throw new Error("convertRadix2: data should be array");if(_t<=0||_t>32)throw new Error(`convertRadix2: wrong from=${_t}`);if(Tt<=0||Tt>32)throw new Error(`convertRadix2: wrong to=${Tt}`);if(Be(_t,Tt)>32)throw new Error(`convertRadix2: carry overflow from=${_t} to=${Tt} carryBits=${Be(_t,Tt)}`);let ht=0,ft=0;const Et=2**Tt-1,St=[];for(const At of mt){if(t(At),At>=2**_t)throw new Error(`convertRadix2: invalid data word=${At} from=${_t}`);if(ht=ht<<_t|At,ft+_t>32)throw new Error(`convertRadix2: carry overflow pos=${ft} from=${_t}`);for(ft+=_t;ft>=Tt;ft-=Tt)St.push((ht>>ft-Tt&Et)>>>0);ht&=2**ft-1}if(ht=ht<<Tt-ft&Et,!xt&&ft>=_t)throw new Error("Excess padding");if(!xt&&ht)throw new Error(`Non-zero padding: ${ht}`);return xt&&ft>0&&St.push(ht>>>0),St}function Ye(mt){return t(mt),{encode:_t=>{if(!(_t instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return pe(Array.from(_t),2**8,mt)},decode:_t=>{if(!Array.isArray(_t)||_t.length&&typeof _t[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(pe(_t,mt,2**8))}}}function tt(mt,_t=!1){if(t(mt),mt<=0||mt>32)throw new Error("radix2: bits should be in (0..32]");if(Be(8,mt)>32||Be(mt,8)>32)throw new Error("radix2: carry overflow");return{encode:Tt=>{if(!(Tt instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return Le(Array.from(Tt),8,mt,!_t)},decode:Tt=>{if(!Array.isArray(Tt)||Tt.length&&typeof Tt[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(Le(Tt,mt,8,_t))}}}function ot(mt){if(typeof mt!="function")throw new Error("unsafeWrapper fn should be function");return function(..._t){try{return mt.apply(null,_t)}catch{}}}function yt(mt,_t){if(t(mt),typeof _t!="function")throw new Error("checksum fn should be function");return{encode(Tt){if(!(Tt instanceof Uint8Array))throw new Error("checksum.encode: input should be Uint8Array");const xt=_t(Tt).slice(0,mt),ht=new Uint8Array(Tt.length+mt);return ht.set(Tt),ht.set(xt,Tt.length),ht},decode(Tt){if(!(Tt instanceof Uint8Array))throw new Error("checksum.decode: input should be Uint8Array");const xt=Tt.slice(0,-mt),ht=_t(xt).slice(0,mt),ft=Tt.slice(-mt);for(let Et=0;Et<mt;Et++)if(ht[Et]!==ft[Et])throw new Error("Invalid checksum");return xt}}}e.utils={alphabet:s,chain:n,checksum:yt,radix:Ye,radix2:tt,join:a,padding:l},e.base16=n(tt(4),s("0123456789ABCDEF"),a("")),e.base32=n(tt(5),s("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),l(5),a("")),e.base32hex=n(tt(5),s("0123456789ABCDEFGHIJKLMNOPQRSTUV"),l(5),a("")),e.base32crockford=n(tt(5),s("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),a(""),de(mt=>mt.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))),e.base64=n(tt(6),s("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),l(6),a("")),e.base64url=n(tt(6),s("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),l(6),a(""));const nt=mt=>n(Ye(58),s(mt),a(""));e.base58=nt("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),e.base58flickr=nt("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),e.base58xrp=nt("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const st=[0,2,3,5,6,7,9,10,11];e.base58xmr={encode(mt){let _t="";for(let Tt=0;Tt<mt.length;Tt+=8){const xt=mt.subarray(Tt,Tt+8);_t+=e.base58.encode(xt).padStart(st[xt.length],"1")}return _t},decode(mt){let _t=[];for(let Tt=0;Tt<mt.length;Tt+=11){const xt=mt.slice(Tt,Tt+11),ht=st.indexOf(xt.length),ft=e.base58.decode(xt);for(let Et=0;Et<ft.length-ht;Et++)if(ft[Et]!==0)throw new Error("base58xmr: wrong padding");_t=_t.concat(Array.from(ft.slice(ft.length-ht)))}return Uint8Array.from(_t)}};const gt=mt=>n(yt(4,_t=>mt(mt(_t))),e.base58);e.base58check=gt;const wt=n(s("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),a("")),vt=[996825010,642813549,513874426,1027748829,705979059];function Rt(mt){const _t=mt>>25;let Tt=(mt&33554431)<<5;for(let xt=0;xt<vt.length;xt++)(_t>>xt&1)===1&&(Tt^=vt[xt]);return Tt}function Bt(mt,_t,Tt=1){const xt=mt.length;let ht=1;for(let ft=0;ft<xt;ft++){const Et=mt.charCodeAt(ft);if(Et<33||Et>126)throw new Error(`Invalid prefix (${mt})`);ht=Rt(ht)^Et>>5}ht=Rt(ht);for(let ft=0;ft<xt;ft++)ht=Rt(ht)^mt.charCodeAt(ft)&31;for(let ft of _t)ht=Rt(ht)^ft;for(let ft=0;ft<6;ft++)ht=Rt(ht);return ht^=Tt,wt.encode(Le([ht%2**30],30,5,!1))}function $t(mt){const _t=mt==="bech32"?1:734539939,Tt=tt(5),xt=Tt.decode,ht=Tt.encode,ft=ot(xt);function Et(It,Mt,jt=90){if(typeof It!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof It}`);if(!Array.isArray(Mt)||Mt.length&&typeof Mt[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof Mt}`);const Ft=It.length+7+Mt.length;if(jt!==!1&&Ft>jt)throw new TypeError(`Length ${Ft} exceeds limit ${jt}`);return It=It.toLowerCase(),`${It}1${wt.encode(Mt)}${Bt(It,Mt,_t)}`}function St(It,Mt=90){if(typeof It!="string")throw new Error(`bech32.decode input should be string, not ${typeof It}`);if(It.length<8||Mt!==!1&&It.length>Mt)throw new TypeError(`Wrong string length: ${It.length} (${It}). Expected (8..${Mt})`);const jt=It.toLowerCase();if(It!==jt&&It!==It.toUpperCase())throw new Error("String must be lowercase or uppercase");It=jt;const Ft=It.lastIndexOf("1");if(Ft===0||Ft===-1)throw new Error('Letter "1" must be present between prefix and data only');const Ut=It.slice(0,Ft),Ot=It.slice(Ft+1);if(Ot.length<6)throw new Error("Data must be at least 6 characters long");const Ht=wt.decode(Ot).slice(0,-6),Vt=Bt(Ut,Ht,_t);if(!Ot.endsWith(Vt))throw new Error(`Invalid checksum in ${It}: expected "${Vt}"`);return{prefix:Ut,words:Ht}}const At=ot(St);function Nt(It){const{prefix:Mt,words:jt}=St(It,!1);return{prefix:Mt,words:jt,bytes:xt(jt)}}return{encode:Et,decode:St,decodeToBytes:Nt,decodeUnsafe:At,fromWords:xt,fromWordsUnsafe:ft,toWords:ht}}e.bech32=$t("bech32"),e.bech32m=$t("bech32m"),e.utf8={encode:mt=>new TextDecoder().decode(mt),decode:mt=>new TextEncoder().encode(mt)},e.hex=n(tt(4),s("0123456789abcdef"),a(""),de(mt=>{if(typeof mt!="string"||mt.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof mt} with length ${mt.length}`);return mt.toLowerCase()}));const Ct={utf8:e.utf8,hex:e.hex,base16:e.base16,base32:e.base32,base64:e.base64,base64url:e.base64url,base58:e.base58,base58xmr:e.base58xmr},kt=`Invalid encoding type. Available types: ${Object.keys(Ct).join(", ")}`,Lt=(mt,_t)=>{if(typeof mt!="string"||!Ct.hasOwnProperty(mt))throw new TypeError(kt);if(!(_t instanceof Uint8Array))throw new TypeError("bytesToString() expects Uint8Array");return Ct[mt].encode(_t)};e.bytesToString=Lt,e.str=e.bytesToString;const Pt=(mt,_t)=>{if(!Ct.hasOwnProperty(mt))throw new TypeError(kt);if(typeof _t!="string")throw new TypeError("stringToBytes() expects string");return Ct[mt].decode(_t)};e.stringToBytes=Pt,e.bytes=e.stringToBytes})(lib);const{bech32,hex,utf8}=lib,DEFAULTNETWORK={bech32:"bc",pubKeyHash:0,scriptHash:5,validWitnessVersions:[0]},TESTNETWORK={bech32:"tb",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},SIGNETNETWORK={bech32:"tbs",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},REGTESTNETWORK={bech32:"bcrt",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},SIMNETWORK={bech32:"sb",pubKeyHash:63,scriptHash:123,validWitnessVersions:[0]},FEATUREBIT_ORDER=["option_data_loss_protect","initial_routing_sync","option_upfront_shutdown_script","gossip_queries","var_onion_optin","gossip_queries_ex","option_static_remotekey","payment_secret","basic_mpp","option_support_large_channel"],DIVISORS={m:BigInt(1e3),u:BigInt(1e6),n:BigInt(1e9),p:BigInt(1e12)},MAX_MILLISATS=BigInt("2100000000000000000"),MILLISATS_PER_BTC=BigInt(1e11),TAGCODES={payment_hash:1,payment_secret:16,description:13,payee:19,description_hash:23,expiry:6,min_final_cltv_expiry:24,fallback_address:9,route_hint:3,feature_bits:5,metadata:27},TAGNAMES={};for(let e=0,t=Object.keys(TAGCODES);e<t.length;e++){const n=t[e],s=TAGCODES[t[e]].toString();TAGNAMES[s]=n}const TAGPARSERS={1:e=>hex.encode(bech32.fromWordsUnsafe(e)),16:e=>hex.encode(bech32.fromWordsUnsafe(e)),13:e=>utf8.encode(bech32.fromWordsUnsafe(e)),19:e=>hex.encode(bech32.fromWordsUnsafe(e)),23:e=>hex.encode(bech32.fromWordsUnsafe(e)),27:e=>hex.encode(bech32.fromWordsUnsafe(e)),6:wordsToIntBE,24:wordsToIntBE,3:routingInfoParser,5:featureBitsParser};function getUnknownParser(e){return t=>({tagCode:parseInt(e),words:bech32.encode("unknown",t,Number.MAX_SAFE_INTEGER)})}function wordsToIntBE(e){return e.reverse().reduce((t,n,s)=>t+n*Math.pow(32,s),0)}function routingInfoParser(e){const t=[];let n,s,a,l,de,pe=bech32.fromWordsUnsafe(e);for(;pe.length>0;)n=hex.encode(pe.slice(0,33)),s=hex.encode(pe.slice(33,41)),a=parseInt(hex.encode(pe.slice(41,45)),16),l=parseInt(hex.encode(pe.slice(45,49)),16),de=parseInt(hex.encode(pe.slice(49,51)),16),pe=pe.slice(51),t.push({pubkey:n,short_channel_id:s,fee_base_msat:a,fee_proportional_millionths:l,cltv_expiry_delta:de});return t}function featureBitsParser(e){const t=e.slice().reverse().map(a=>[!!(a&1),!!(a&2),!!(a&4),!!(a&8),!!(a&16)]).reduce((a,l)=>a.concat(l),[]);for(;t.length<FEATUREBIT_ORDER.length*2;)t.push(!1);const n={};FEATUREBIT_ORDER.forEach((a,l)=>{let de;t[l*2]?de="required":t[l*2+1]?de="supported":de="unsupported",n[a]=de});const s=t.slice(FEATUREBIT_ORDER.length*2);return n.extra_bits={start_bit:FEATUREBIT_ORDER.length*2,bits:s,has_required:s.reduce((a,l,de)=>de%2!==0?a||!1:a||l,!1)},n}function hrpToMillisat(e,t){let n,s;if(e.slice(-1).match(/^[munp]$/))n=e.slice(-1),s=e.slice(0,-1);else{if(e.slice(-1).match(/^[^munp0-9]$/))throw new Error("Not a valid multiplier for the amount");s=e}if(!s.match(/^\d+$/))throw new Error("Not a valid human readable amount");const a=BigInt(s),l=n?a*MILLISATS_PER_BTC/DIVISORS[n]:a*MILLISATS_PER_BTC;if(n==="p"&&a%BigInt(10)!==BigInt(0)||l>MAX_MILLISATS)throw new Error("Amount is outside of valid range");return t?l.toString():l}function decode(e,t){if(typeof e!="string")throw new Error("Lightning Payment Request must be string");if(e.slice(0,2).toLowerCase()!=="ln")throw new Error("Not a proper lightning payment request");const n=[],s=bech32.decode(e,Number.MAX_SAFE_INTEGER);e=e.toLowerCase();const a=s.prefix;let l=s.words,de=e.slice(a.length+1),pe=l.slice(-104);l=l.slice(0,-104);let me=a.match(/^ln(\S+?)(\d*)([a-zA-Z]?)$/);if(me&&!me[2]&&(me=a.match(/^ln(\S+)$/)),!me)throw new Error("Not a proper lightning payment request");n.push({name:"lightning_network",letters:"ln"});const Be=me[1];let Le;if(t){if(t.bech32===void 0||t.pubKeyHash===void 0||t.scriptHash===void 0||!Array.isArray(t.validWitnessVersions))throw new Error("Invalid network");Le=t}else switch(Be){case DEFAULTNETWORK.bech32:Le=DEFAULTNETWORK;break;case TESTNETWORK.bech32:Le=TESTNETWORK;break;case SIGNETNETWORK.bech32:Le=SIGNETNETWORK;break;case REGTESTNETWORK.bech32:Le=REGTESTNETWORK;break;case SIMNETWORK.bech32:Le=SIMNETWORK;break}if(!Le||Le.bech32!==Be)throw new Error("Unknown coin bech32 prefix");n.push({name:"coin_network",letters:Be,value:Le});const Ye=me[2];let tt;if(Ye){const Rt=me[3];tt=hrpToMillisat(Ye+Rt,!0),n.push({name:"amount",letters:me[2]+me[3],value:tt})}else tt=null;n.push({name:"separator",letters:"1"});const ot=wordsToIntBE(l.slice(0,7));l=l.slice(7),n.push({name:"timestamp",letters:de.slice(0,7),value:ot}),de=de.slice(7);let yt,nt,st,gt;for(;l.length>0;){const Rt=l[0].toString();yt=TAGNAMES[Rt]||"unknown_tag",nt=TAGPARSERS[Rt]||getUnknownParser(Rt),l=l.slice(1),st=wordsToIntBE(l.slice(0,2)),l=l.slice(2),gt=l.slice(0,st),l=l.slice(st),n.push({name:yt,tag:de[0],letters:de.slice(0,3+st),value:nt(gt)}),de=de.slice(3+st)}n.push({name:"signature",letters:de.slice(0,104),value:hex.encode(bech32.fromWordsUnsafe(pe))}),de=de.slice(104),n.push({name:"checksum",letters:de});let wt={paymentRequest:e,sections:n,get expiry(){let Rt=n.find(Bt=>Bt.name==="expiry");if(Rt)return vt("timestamp")+Rt.value},get route_hints(){return n.filter(Rt=>Rt.name==="route_hint").map(Rt=>Rt.value)}};for(let Rt in TAGCODES)Rt!=="route_hint"&&Object.defineProperty(wt,Rt,{get(){return vt(Rt)}});return wt;function vt(Rt){let Bt=n.find($t=>$t.name===Rt);return Bt?Bt.value:void 0}}var bolt11={decode,hrpToMillisat};function getRelaysForSync(e,t,n="write"){if(!e.outboxTracker)return;const s=e.outboxTracker.data.get(t);if(s)return n==="write"?s.writeRelays:s.readRelays}async function getWriteRelaysFor(e,t,n="write"){if(e.outboxTracker)return e.outboxTracker.data.has(t)||await e.outboxTracker.trackUsers([t]),getRelaysForSync(e,t,n)}function getTopRelaysForAuthors(e,t){const n=new Map;return t.forEach(a=>{const l=getRelaysForSync(e,a);l&&l.forEach(de=>{const pe=n.get(de)||0;n.set(de,pe+1)})}),Array.from(n.entries()).sort((a,l)=>l[1]-a[1]).map(a=>a[0])}function getAllRelaysForAllPubkeys(e,t,n="read"){const s=new Map,a=new Set;return t.forEach(l=>{const de=getRelaysForSync(e,l,n);de&&de.size>0?(de.forEach(pe=>{(s.get(pe)||new Set).add(l)}),s.set(l,de)):a.add(l)}),{pubkeysToRelays:s,authorsMissingRelays:a}}function chooseRelayCombinationForPubkeys(e,t,n,{count:s,preferredRelays:a}={}){s??(s=2),a??(a=new Set);const l=e.pool,de=l.connectedRelays();de.forEach(tt=>{a.add(tt.url)});const pe=new Map,{pubkeysToRelays:me,authorsMissingRelays:Be}=getAllRelaysForAllPubkeys(e,t,n),Le=getTopRelaysForAuthors(e,t),Ye=(tt,ot)=>{const yt=pe.get(ot)||[];yt.push(tt),pe.set(ot,yt)};for(const[tt,ot]of me.entries()){let yt=s;for(const nt of de)ot.has(nt.url)&&(Ye(tt,nt.url),yt--);for(const nt of ot)pe.has(nt)&&(Ye(tt,nt),yt--);if(!(yt<=0))for(const nt of Le){if(yt<=0)break;ot.has(nt)&&(Ye(tt,nt),yt--)}}for(const tt of Be)l.permanentAndConnectedRelays().forEach(ot=>{const yt=pe.get(ot.url)||[];yt.push(tt),pe.set(ot.url,yt)});return pe}function getRelaysForFilterWithAuthors(e,t,n=2){return chooseRelayCombinationForPubkeys(e,t,"write",{count:n})}function tryNormalizeRelayUrl(e){try{return normalizeRelayUrl(e)}catch{return}}function normalizeRelayUrl(e){let t=normalizeUrl(e.toLowerCase(),{stripAuthentication:!1,stripWWW:!1,stripHash:!0});return t.endsWith("/")||(t+="/"),t}function normalize(e){const t=new Set;for(const n of e)try{t.add(normalizeRelayUrl(n))}catch{}return Array.from(t)}var DATA_URL_DEFAULT_MIME_TYPE="text/plain",DATA_URL_DEFAULT_CHARSET="us-ascii",testParameter=(e,t)=>t.some(n=>n instanceof RegExp?n.test(e):n===e),supportedProtocols=new Set(["https:","http:","file:"]),hasCustomProtocol=e=>{try{const{protocol:t}=new URL(e);return t.endsWith(":")&&!t.includes(".")&&!supportedProtocols.has(t)}catch{return!1}},normalizeDataURL=(e,{stripHash:t})=>{var Ye,tt,ot,yt;const n=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(e);if(!n)throw new Error(`Invalid URL: ${e}`);let s=((Ye=n.groups)==null?void 0:Ye.type)??"",a=((tt=n.groups)==null?void 0:tt.data)??"",l=((ot=n.groups)==null?void 0:ot.hash)??"";const de=s.split(";");l=t?"":l;let pe=!1;de[de.length-1]==="base64"&&(de.pop(),pe=!0);const me=((yt=de.shift())==null?void 0:yt.toLowerCase())??"",Le=[...de.map(nt=>{let[st,gt=""]=nt.split("=").map(wt=>wt.trim());return st==="charset"&&(gt=gt.toLowerCase(),gt===DATA_URL_DEFAULT_CHARSET)?"":`${st}${gt?`=${gt}`:""}`}).filter(Boolean)];return pe&&Le.push("base64"),(Le.length>0||me&&me!==DATA_URL_DEFAULT_MIME_TYPE)&&Le.unshift(me),`data:${Le.join(";")},${pe?a.trim():a}${l?`#${l}`:""}`};function normalizeUrl(e,t){if(t={defaultProtocol:"http",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,removeExplicitPort:!1,sortQueryParameters:!0,...t},typeof t.defaultProtocol=="string"&&!t.defaultProtocol.endsWith(":")&&(t.defaultProtocol=`${t.defaultProtocol}:`),e=e.trim(),/^data:/i.test(e))return normalizeDataURL(e,t);if(hasCustomProtocol(e))return e;const n=e.startsWith("//");!n&&/^\.*\//.test(e)||(e=e.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,t.defaultProtocol));const a=new URL(e);if(t.forceHttp&&t.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(t.forceHttp&&a.protocol==="https:"&&(a.protocol="http:"),t.forceHttps&&a.protocol==="http:"&&(a.protocol="https:"),t.stripAuthentication&&(a.username="",a.password=""),t.stripHash?a.hash="":t.stripTextFragment&&(a.hash=a.hash.replace(/#?:~:text.*?$/i,"")),a.pathname){const de=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g;let pe=0,me="";for(;;){const Le=de.exec(a.pathname);if(!Le)break;const Ye=Le[0],tt=Le.index,ot=a.pathname.slice(pe,tt);me+=ot.replace(/\/{2,}/g,"/"),me+=Ye,pe=tt+Ye.length}const Be=a.pathname.slice(pe,a.pathname.length);me+=Be.replace(/\/{2,}/g,"/"),a.pathname=me}if(a.pathname)try{a.pathname=decodeURI(a.pathname)}catch{}if(t.removeDirectoryIndex===!0&&(t.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(t.removeDirectoryIndex)&&t.removeDirectoryIndex.length>0){let de=a.pathname.split("/");const pe=de[de.length-1];testParameter(pe,t.removeDirectoryIndex)&&(de=de.slice(0,-1),a.pathname=de.slice(1).join("/")+"/")}if(a.hostname&&(a.hostname=a.hostname.replace(/\.$/,""),t.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(a.hostname)&&(a.hostname=a.hostname.replace(/^www\./,""))),Array.isArray(t.removeQueryParameters))for(const de of[...a.searchParams.keys()])testParameter(de,t.removeQueryParameters)&&a.searchParams.delete(de);if(!Array.isArray(t.keepQueryParameters)&&t.removeQueryParameters===!0&&(a.search=""),Array.isArray(t.keepQueryParameters)&&t.keepQueryParameters.length>0)for(const de of[...a.searchParams.keys()])testParameter(de,t.keepQueryParameters)||a.searchParams.delete(de);if(t.sortQueryParameters){a.searchParams.sort();try{a.search=decodeURIComponent(a.search)}catch{}}t.removeTrailingSlash&&(a.pathname=a.pathname.replace(/\/$/,"")),t.removeExplicitPort&&a.port&&(a.port="");const l=e;return e=a.toString(),!t.removeSingleSlash&&a.pathname==="/"&&!l.endsWith("/")&&a.hash===""&&(e=e.replace(/\/$/,"")),(t.removeTrailingSlash||a.pathname==="/")&&a.hash===""&&t.removeSingleSlash&&(e=e.replace(/\/$/,"")),n&&!t.normalizeProtocol&&(e=e.replace(/^http:\/\//,"//")),t.stripProtocol&&(e=e.replace(/^(?:https?:)?\/\//,"")),e}var NDKKind=(e=>(e[e.Metadata=0]="Metadata",e[e.Text=1]="Text",e[e.RecommendRelay=2]="RecommendRelay",e[e.Contacts=3]="Contacts",e[e.EncryptedDirectMessage=4]="EncryptedDirectMessage",e[e.EventDeletion=5]="EventDeletion",e[e.Repost=6]="Repost",e[e.Reaction=7]="Reaction",e[e.BadgeAward=8]="BadgeAward",e[e.GroupChat=9]="GroupChat",e[e.GroupNote=11]="GroupNote",e[e.GroupReply=12]="GroupReply",e[e.GenericRepost=16]="GenericRepost",e[e.ChannelCreation=40]="ChannelCreation",e[e.ChannelMetadata=41]="ChannelMetadata",e[e.ChannelMessage=42]="ChannelMessage",e[e.ChannelHideMessage=43]="ChannelHideMessage",e[e.ChannelMuteUser=44]="ChannelMuteUser",e[e.Media=1063]="Media",e[e.Report=1984]="Report",e[e.Label=1985]="Label",e[e.DVMReqTextExtraction=5e3]="DVMReqTextExtraction",e[e.DVMReqTextSummarization=5001]="DVMReqTextSummarization",e[e.DVMReqTextTranslation=5002]="DVMReqTextTranslation",e[e.DVMReqTextGeneration=5050]="DVMReqTextGeneration",e[e.DVMReqImageGeneration=5100]="DVMReqImageGeneration",e[e.DVMReqTextToSpeech=5250]="DVMReqTextToSpeech",e[e.DVMReqDiscoveryNostrContent=5300]="DVMReqDiscoveryNostrContent",e[e.DVMReqDiscoveryNostrPeople=5301]="DVMReqDiscoveryNostrPeople",e[e.DVMReqTimestamping=5900]="DVMReqTimestamping",e[e.DVMEventSchedule=5905]="DVMEventSchedule",e[e.DVMJobFeedback=7e3]="DVMJobFeedback",e[e.Subscribe=7001]="Subscribe",e[e.Unsubscribe=7002]="Unsubscribe",e[e.SubscriptionReceipt=7003]="SubscriptionReceipt",e[e.CashuToken=7375]="CashuToken",e[e.WalletChange=7376]="WalletChange",e[e.GroupAdminAddUser=9e3]="GroupAdminAddUser",e[e.GroupAdminRemoveUser=9001]="GroupAdminRemoveUser",e[e.GroupAdminEditMetadata=9002]="GroupAdminEditMetadata",e[e.GroupAdminEditStatus=9006]="GroupAdminEditStatus",e[e.GroupAdminCreateGroup=9007]="GroupAdminCreateGroup",e[e.GroupAdminRequestJoin=9021]="GroupAdminRequestJoin",e[e.MuteList=1e4]="MuteList",e[e.PinList=10001]="PinList",e[e.RelayList=10002]="RelayList",e[e.BookmarkList=10003]="BookmarkList",e[e.CommunityList=10004]="CommunityList",e[e.PublicChatList=10005]="PublicChatList",e[e.BlockRelayList=10006]="BlockRelayList",e[e.SearchRelayList=10007]="SearchRelayList",e[e.SimpleGroupList=10009]="SimpleGroupList",e[e.InterestList=10015]="InterestList",e[e.CashuMintList=10019]="CashuMintList",e[e.EmojiList=10030]="EmojiList",e[e.BlossomList=10063]="BlossomList",e[e.NostrWaletConnectInfo=13194]="NostrWaletConnectInfo",e[e.TierList=17e3]="TierList",e[e.FollowSet=3e4]="FollowSet",e[e.CategorizedPeopleList=3e4]="CategorizedPeopleList",e[e.CategorizedBookmarkList=30001]="CategorizedBookmarkList",e[e.RelaySet=30002]="RelaySet",e[e.CategorizedRelayList=30002]="CategorizedRelayList",e[e.BookmarkSet=30003]="BookmarkSet",e[e.CurationSet=30004]="CurationSet",e[e.ArticleCurationSet=30004]="ArticleCurationSet",e[e.VideoCurationSet=30005]="VideoCurationSet",e[e.InterestSet=30015]="InterestSet",e[e.InterestsList=30015]="InterestsList",e[e.EmojiSet=30030]="EmojiSet",e[e.ModularArticle=30040]="ModularArticle",e[e.ModularArticleItem=30041]="ModularArticleItem",e[e.Wiki=30818]="Wiki",e[e.Draft=31234]="Draft",e[e.SubscriptionTier=37001]="SubscriptionTier",e[e.EcashMintRecommendation=38e3]="EcashMintRecommendation",e[e.HighlightSet=39802]="HighlightSet",e[e.CategorizedHighlightList=39802]="CategorizedHighlightList",e[e.Nutzap=9321]="Nutzap",e[e.ZapRequest=9734]="ZapRequest",e[e.Zap=9735]="Zap",e[e.Highlight=9802]="Highlight",e[e.ClientAuth=22242]="ClientAuth",e[e.NostrWalletConnectReq=23194]="NostrWalletConnectReq",e[e.NostrWalletConnectRes=23195]="NostrWalletConnectRes",e[e.NostrConnect=24133]="NostrConnect",e[e.BlossomUpload=24242]="BlossomUpload",e[e.HttpAuth=27235]="HttpAuth",e[e.ProfileBadge=30008]="ProfileBadge",e[e.BadgeDefinition=30009]="BadgeDefinition",e[e.MarketStall=30017]="MarketStall",e[e.MarketProduct=30018]="MarketProduct",e[e.Article=30023]="Article",e[e.AppSpecificData=30078]="AppSpecificData",e[e.Classified=30402]="Classified",e[e.HorizontalVideo=34235]="HorizontalVideo",e[e.VerticalVideo=34236]="VerticalVideo",e[e.CashuWallet=37375]="CashuWallet",e[e.GroupMetadata=39e3]="GroupMetadata",e[e.GroupAdmins=39001]="GroupAdmins",e[e.GroupMembers=39002]="GroupMembers",e[e.AppRecommendation=31989]="AppRecommendation",e[e.AppHandler=31990]="AppHandler",e))(NDKKind||{}),MAX_RECONNECT_ATTEMPTS=5,FLAPPING_THRESHOLD_MS=1e3,NDKRelayConnectivity=class{constructor(e,t){bt(this,"ndkRelay");bt(this,"ws");bt(this,"_status");bt(this,"timeoutMs");bt(this,"connectedAt");bt(this,"_connectionStats",{attempts:0,success:0,durations:[]});bt(this,"debug");bt(this,"connectTimeout");bt(this,"reconnectTimeout");bt(this,"ndk");bt(this,"openSubs",new Map);bt(this,"openCountRequests",new Map);bt(this,"openEventPublishes",new Map);bt(this,"serial",0);bt(this,"baseEoseTimeout",4400);bt(this,"updateConnectionStats",{connected:()=>{this._connectionStats.success++,this._connectionStats.connectedAt=Date.now()},disconnected:()=>{this._connectionStats.connectedAt&&(this._connectionStats.durations.push(Date.now()-this._connectionStats.connectedAt),this._connectionStats.durations.length>100&&this._connectionStats.durations.shift()),this._connectionStats.connectedAt=void 0},attempt:()=>{this._connectionStats.attempts++,this._connectionStats.connectedAt=Date.now()}});this.ndkRelay=e,this._status=1;const n=Math.floor(Math.random()*1e3);this.debug=this.ndkRelay.debug.extend("connectivity"+n),this.ndk=t}async connect(e,t=!0){if(this._status!==1||this.reconnectTimeout){this.debug("Relay requested to be connected but was in state %s or it had a reconnect timeout",this._status);return}this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0),this.connectTimeout&&(clearTimeout(this.connectTimeout),this.connectTimeout=void 0),e??(e=this.timeoutMs),!this.timeoutMs&&e&&(this.timeoutMs=e),this.timeoutMs&&(this.connectTimeout=setTimeout(()=>this.onConnectionError(t),this.timeoutMs));try{this.updateConnectionStats.attempt(),this._status===1?this._status=4:this._status=2,this.ws=new WebSocket(this.ndkRelay.url),this.ws.onopen=this.onConnect.bind(this),this.ws.onclose=this.onDisconnect.bind(this),this.ws.onmessage=this.onMessage.bind(this),this.ws.onerror=this.onError.bind(this)}catch(n){throw this.debug(`Failed to connect to ${this.ndkRelay.url}`,n),this._status=1,t?this.handleReconnection():this.ndkRelay.emit("delayed-connect",2*24*60*60*1e3),n}}disconnect(){var e;this._status=0;try{(e=this.ws)==null||e.close()}catch(t){this.debug("Failed to disconnect",t),this._status=1}}onConnectionError(e){this.debug(`Error connecting to ${this.ndkRelay.url}`,this.timeoutMs),e&&!this.reconnectTimeout&&this.handleReconnection()}onConnect(){this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0),this.connectTimeout&&(clearTimeout(this.connectTimeout),this.connectTimeout=void 0),this.updateConnectionStats.connected(),this._status=5,this.ndkRelay.emit("connect"),this.ndkRelay.emit("ready")}onDisconnect(){this.updateConnectionStats.disconnected(),this._status=1}onMessage(e){try{const t=JSON.parse(e.data),[n,s,...a]=t;switch(n){case"EVENT":{const l=this.openSubs.get(s),de=t[2];if(!l){this.debug(`Received event for unknown subscription ${s}`);return}l.onevent(de);return}case"COUNT":{const l=t[2],de=this.openCountRequests.get(s);de&&(de.resolve(l.count),this.openCountRequests.delete(s));return}case"EOSE":{const l=this.openSubs.get(s);if(!l)return;l.oneose();return}case"OK":{const l=t[2],de=t[3],pe=this.openEventPublishes.get(s),me=pe==null?void 0:pe.pop();if(!pe||!me){this.debug("Received OK for unknown event publish",s);return}l?me.resolve(de):me.reject(new Error(de)),pe.length===0?this.openEventPublishes.delete(s):this.openEventPublishes.set(s,pe);return}case"CLOSED":{const l=this.openSubs.get(s);if(!l)return;l.onclosed(t[2]);return}case"NOTICE":this.onNotice(t[1]);return;case"AUTH":{this.onAuthRequested(t[1]);return}}}catch(t){this.debug(`Error parsing message from ${this.ndkRelay.url}: ${t.message}`,t==null?void 0:t.stack);return}}async onAuthRequested(e){var n,s,a;const t=this.ndkRelay.authPolicy??((n=this.ndk)==null?void 0:n.relayAuthDefaultPolicy);if(this.debug("Relay requested authentication",{havePolicy:!!t}),this._status===7){this.debug("Already authenticating, ignoring");return}if(this._status=6,t){if(this._status>=5){this._status=7;let l;try{l=await t(this.ndkRelay,e)}catch(de){this.debug("Authentication policy threw an error",de),l=!1}if(this.debug("Authentication policy returned",!!l),l instanceof NDKEvent||l===!0){l instanceof NDKEvent&&await this.auth(l);const de=async()=>{if(this._status>=5&&this._status<8){const pe=new NDKEvent(this.ndk);pe.kind=22242,pe.tags=[["relay",this.ndkRelay.url],["challenge",e]],await pe.sign(),this.auth(pe).then(()=>{this._status=8,this.ndkRelay.emit("authed"),this.debug("Authentication successful")}).catch(me=>{this._status=6,this.ndkRelay.emit("auth:failed",me),this.debug("Authentication failed",me)})}else this.debug("Authentication failed, it changed status, status is %d",this._status)};l===!0&&((s=this.ndk)!=null&&s.signer?de().catch(pe=>{console.error("Error authenticating",pe)}):(this.debug("No signer available for authentication localhost"),(a=this.ndk)==null||a.once("signer:ready",de))),this._status=5,this.ndkRelay.emit("authed")}}}else this.ndkRelay.emit("auth",e)}onError(e){this.debug(`WebSocket error on ${this.ndkRelay.url}:`,e)}get status(){return this._status}isAvailable(){return this._status===5}isFlapping(){const e=this._connectionStats.durations;if(e.length%3!==0)return!1;const n=e.reduce((de,pe)=>de+pe,0)/e.length,s=e.map(de=>Math.pow(de-n,2)).reduce((de,pe)=>de+pe,0)/e.length;return Math.sqrt(s)<FLAPPING_THRESHOLD_MS}async onNotice(e){this.ndkRelay.emit("notice",e)}handleReconnection(e=0){if(this.reconnectTimeout)return;if(this.isFlapping()){this.ndkRelay.emit("flapping",this._connectionStats),this._status=3;return}const t=this.connectedAt?Math.max(0,6e4-(Date.now()-this.connectedAt)):5e3*(this._connectionStats.attempts+1);this.reconnectTimeout=setTimeout(()=>{this.reconnectTimeout=void 0,this._status=2,this.connect().catch(n=>{e<MAX_RECONNECT_ATTEMPTS?setTimeout(()=>{this.handleReconnection(e+1)},1e3*(e+1)^4):this.debug("Reconnect failed")})},t),this.ndkRelay.emit("delayed-connect",t),this.debug("Reconnecting in",t),this._connectionStats.nextReconnectAt=Date.now()+t}async send(e){var t,n;this._status>=5&&((t=this.ws)==null?void 0:t.readyState)===WebSocket.OPEN?(n=this.ws)==null||n.send(e):this.debug(`Not connected to ${this.ndkRelay.url} (%d), not sending message ${e}`,this._status)}async auth(e){const t=new Promise((n,s)=>{const a=this.openEventPublishes.get(e.id)??[];a.push({resolve:n,reject:s}),this.openEventPublishes.set(e.id,a)});return this.send('["AUTH",'+JSON.stringify(e.rawEvent())+"]"),t}async publish(e){const t=new Promise((n,s)=>{const a=this.openEventPublishes.get(e.id)??[];a.length>0&&console.warn("Duplicate event publishing detected, you are publishing event "+e.id+" twice"),a.push({resolve:n,reject:s}),this.openEventPublishes.set(e.id,a)});return this.send('["EVENT",'+JSON.stringify(e)+"]"),t}async count(e,t){this.serial++;const n=(t==null?void 0:t.id)||"count:"+this.serial,s=new Promise((a,l)=>{this.openCountRequests.set(n,{resolve:a,reject:l})});return this.send('["COUNT","'+n+'",'+JSON.stringify(e).substring(1)),s}close(e,t){this.send('["CLOSE","'+e+'"]');const n=this.openSubs.get(e);this.openSubs.delete(e),n&&n.onclose(t)}req(e){this.send('["REQ","'+e.subId+'",'+JSON.stringify(e.executeFilters).substring(1))+"",this.openSubs.set(e.subId,e)}get connectionStats(){return this._connectionStats}get url(){return this.ndkRelay.url}get connected(){var e;return this._status>=5&&((e=this.ws)==null?void 0:e.readyState)===WebSocket.OPEN}},NDKRelayPublisher=class{constructor(e){bt(this,"ndkRelay");bt(this,"debug");this.ndkRelay=e,this.debug=e.debug.extend("publisher")}async publish(e,t=2500){let n;const s=()=>new Promise((Le,Ye)=>{try{this.publishEvent(e).then(tt=>{this.ndkRelay.emit("published",e),e.emit("relay:published",this.ndkRelay),Le(!0)}).catch(Ye)}catch(tt){Ye(tt)}}),a=new Promise((Le,Ye)=>{n=setTimeout(()=>{n=void 0,Ye(new Error("Timeout: "+t+"ms"))},t)}),l=()=>{s().then(Le=>de(Le)).catch(Le=>pe(Le))};let de,pe;const me=Le=>{throw this.ndkRelay.debug("Publish failed",Le,e.id),this.ndkRelay.emit("publish:failed",e,Le),e.emit("relay:publish:failed",this.ndkRelay,Le),Le},Be=()=>{n&&clearTimeout(n),this.ndkRelay.removeListener("connect",l)};return this.ndkRelay.status>=5?Promise.race([s(),a]).catch(me).finally(Be):Promise.race([new Promise((Le,Ye)=>{de=Le,pe=Ye,this.ndkRelay.once("connect",l)}),a]).catch(me).finally(Be)}async publishEvent(e){return this.ndkRelay.connectivity.publish(e.rawEvent())}};function filterFingerprint(e,t){const n=[];for(const a of e){if(a.since||a.until)return;const de=Object.keys(a||{}).sort().join("-");n.push(de)}let s=t?"+":"";return s+=n.join("|"),s}function mergeFilters(e){const t={};return e.forEach(n=>{Object.entries(n).forEach(([s,a])=>{Array.isArray(a)?t[s]===void 0?t[s]=[...a]:t[s]=Array.from(new Set([...t[s],...a])):t[s]=a})}),t}var NDKRelaySubscription=class{constructor(e,t){bt(this,"fingerprint");bt(this,"items",new Map);bt(this,"topSubscriptionManager");bt(this,"debug");bt(this,"status",0);bt(this,"onClose");bt(this,"relay");bt(this,"eosed",!1);bt(this,"itemsToRemoveAfterEose",[]);bt(this,"executionTimer");bt(this,"fireTime");bt(this,"delayType");bt(this,"executeFilters");bt(this,"eventIds",new Set);bt(this,"_subId");bt(this,"subIdParts",new Set);bt(this,"executeOnRelayReady",()=>{this.status===2&&(this.status=1,this.execute())});bt(this,"reExecuteAfterAuth",(()=>{const e=this.subId;this.debug("Re-executing after auth",this.items.size),this.relay.close(this.subId),this._subId=void 0,this.status=1,this.execute(),this.debug("Re-executed after auth %s  %s",e,this.subId)}).bind(this));this.relay=e;const n=Math.random().toString(36).substring(7);this.debug=e.debug.extend("subscription-"+n),this.fingerprint=t||Math.random().toString(36).substring(7)}get subId(){return this._subId?this._subId:(this._subId=this.fingerprint.slice(0,15),this._subId)}addSubIdPart(e){this.subIdParts.add(e)}addItem(e,t){if(!this.items.has(e.internalId))switch(e.on("close",this.removeItem.bind(this,e)),this.items.set(e.internalId,{subscription:e,filters:t}),this.status!==3&&e.subId&&(!this._subId||this._subId.length<48)&&(this.status===0||this.status===1)&&this.addSubIdPart(e.subId),this.status){case 0:this.evaluateExecutionPlan(e);break;case 3:break;case 1:this.evaluateExecutionPlan(e);break;case 4:throw this.debug("Subscription is closed, cannot add new items"),new Error("Cannot add new items to a closed subscription")}}removeItem(e){if(!this.eosed){this.itemsToRemoveAfterEose.push(e.internalId);return}this.items.delete(e.internalId),this.items.size===0&&this.close()}close(){if(this.status===4)return;const e=this.status;if(this.status=4,e===3)try{this.relay.close(this.subId)}catch(t){this.debug("Error closing subscription",t,this)}else this.debug("Subscription wanted to close but it wasn't running, this is probably ok",{subId:this.subId,prevStatus:e,sub:this});this.cleanup()}cleanup(){this.executionTimer&&clearTimeout(this.executionTimer),this.relay.off("ready",this.executeOnRelayReady),this.relay.off("authed",this.reExecuteAfterAuth),this.onClose&&this.onClose(this)}catchUpSubscription(e,t){this.debug("TODO: catch up subscription",e,t)}evaluateExecutionPlan(e){if(!e.isGroupable()){this.status=1,this.execute();return}const t=e.groupableDelay,n=e.groupableDelayType;if(!t)throw new Error("Cannot group a subscription without a delay");if(this.status===0)this.schedule(t,n);else{const s=this.delayType,a=this.fireTime-Date.now();if(s==="at-least"&&n==="at-least")a<t&&(this.executionTimer&&clearTimeout(this.executionTimer),this.schedule(t,n));else if(s==="at-least"&&n==="at-most")a>t&&(this.executionTimer&&clearTimeout(this.executionTimer),this.schedule(t,n));else if(s==="at-most"&&n==="at-most")a>t&&(this.executionTimer&&clearTimeout(this.executionTimer),this.schedule(t,n));else if(s==="at-most"&&n==="at-least")a>t&&(this.executionTimer&&clearTimeout(this.executionTimer),this.schedule(t,n));else throw new Error("Unknown delay type combination "+s+" "+n)}}schedule(e,t){this.status=1;const n=Date.now();this.fireTime=n+e,this.delayType=t;const s=setTimeout(this.execute.bind(this),e);t==="at-least"&&(this.executionTimer=s)}finalizeSubId(){this.subIdParts.size>0?this._subId=Array.from(this.subIdParts).join("-"):this._subId=this.fingerprint.slice(0,15),this._subId+="-"+Math.random().toString(36).substring(2,7)}execute(){if(this.status===1){if(this.relay.connected)this.relay.status<8&&this.relay.once("authed",this.reExecuteAfterAuth);else{this.status=2,this.relay.once("ready",this.executeOnRelayReady);return}this.status=3,this.finalizeSubId(),this.executeFilters=this.compileFilters(),this.relay.req(this)}}onstart(){}onevent(e){var t;(t=this.topSubscriptionManager)==null||t.seenEvent(e.id,this.relay);for(const{subscription:n}of this.items.values())matchFilters(n.filters,e)&&n.eventReceived(e,this.relay,!1)}oneose(){this.eosed=!0;for(const{subscription:e}of this.items.values())e.eoseReceived(this.relay),e.closeOnEose&&this.removeItem(e)}onclose(e){this.status=4}onclosed(e){if(e)for(const{subscription:t}of this.items.values())t.closedReceived(this.relay,e)}compileFilters(){const e=[],t=Array.from(this.items.values()).map(s=>s.filters),n=t[0].length;for(let s=0;s<n;s++){const a=t.map(l=>l[s]);e.push(mergeFilters(a))}return e}},NDKRelaySubscriptionManager=class{constructor(e,t){bt(this,"relay");bt(this,"subscriptions");bt(this,"topSubscriptionManager");bt(this,"debug");this.relay=e,this.subscriptions=new Map,this.debug=e.debug.extend("sub-manager"),this.topSubscriptionManager=t}addSubscription(e,t){let n;if(!e.isGroupable())n=this.createSubscription(e,t);else{const s=filterFingerprint(t,e.closeOnEose);s&&(n=this.subscriptions.get(s)),n??(n=this.createSubscription(e,t,s))}n.addItem(e,t)}createSubscription(e,t,n){const s=new NDKRelaySubscription(this.relay,n);return s.topSubscriptionManager=this.topSubscriptionManager,s.onClose=this.onRelaySubscriptionClose.bind(this),this.subscriptions.set(s.fingerprint,s),s}onRelaySubscriptionClose(e){this.subscriptions.delete(e.fingerprint)}},Jt,NDKRelay=(Jt=class extends lib$1.EventEmitter{constructor(n,s,a){super();bt(this,"url");bt(this,"scores");bt(this,"connectivity");bt(this,"subs");bt(this,"publisher");bt(this,"authPolicy");bt(this,"lowestValidationRatio");bt(this,"targetValidationRatio");bt(this,"validationRatioFn");bt(this,"validatedEventCount",0);bt(this,"nonValidatedEventCount",0);bt(this,"trusted",!1);bt(this,"complaining",!1);bt(this,"debug");bt(this,"req");bt(this,"close");this.url=normalizeRelayUrl(n),this.scores=new Map,this.debug=debug7(`ndk:relay:${n}`),this.connectivity=new NDKRelayConnectivity(this,a),this.req=this.connectivity.req.bind(this.connectivity),this.close=this.connectivity.close.bind(this.connectivity),this.subs=new NDKRelaySubscriptionManager(this,a==null?void 0:a.subManager),this.publisher=new NDKRelayPublisher(this),this.authPolicy=s,this.targetValidationRatio=a==null?void 0:a.initialValidationRatio,this.lowestValidationRatio=a==null?void 0:a.lowestValidationRatio,this.validationRatioFn=((a==null?void 0:a.validationRatioFn)??Jt.defaultValidationRatioUpdateFn).bind(this),this.updateValidationRatio(),a||console.trace("relay created without ndk")}updateValidationRatio(){setTimeout(()=>{this.updateValidationRatio()},3e4)}get status(){return this.connectivity.status}get connectionStats(){return this.connectivity.connectionStats}async connect(n,s=!0){return this.connectivity.connect(n,s)}disconnect(){this.status!==1&&this.connectivity.disconnect()}subscribe(n,s){this.subs.addSubscription(n,s)}async publish(n,s=2500){return this.publisher.publish(n,s)}referenceTags(){return[["r",this.url]]}addValidatedEvent(){this.validatedEventCount++}addNonValidatedEvent(){this.nonValidatedEventCount++}get validationRatio(){return this.nonValidatedEventCount===0?1:this.validatedEventCount/(this.validatedEventCount+this.nonValidatedEventCount)}shouldValidateEvent(){return this.trusted?!1:this.targetValidationRatio===void 0?!0:this.validationRatio<this.targetValidationRatio}get connected(){return this.connectivity.connected}},bt(Jt,"defaultValidationRatioUpdateFn",(n,s,a)=>{if(n.lowestValidationRatio===void 0||n.targetValidationRatio===void 0)return 1;let l=n.validationRatio;if(n.validationRatio>n.targetValidationRatio){const de=s/100;l=Math.max(n.lowestValidationRatio,n.validationRatio-de)}return l<n.validationRatio?l:n.validationRatio}),Jt),NDKPublishError=class extends Error{constructor(t,n,s,a){super(t);bt(this,"errors");bt(this,"publishedToRelays");bt(this,"intendedRelaySet");this.errors=n,this.publishedToRelays=s,this.intendedRelaySet=a}get relayErrors(){const t=[];for(const[n,s]of this.errors)t.push(`${n.url}: ${s}`);return t.join(`
`)}},NDKRelaySet=class tn{constructor(t,n){bt(this,"relays");bt(this,"debug");bt(this,"ndk");this.relays=t,this.ndk=n,this.debug=n.debug.extend("relayset")}addRelay(t){this.relays.add(t)}get relayUrls(){return Array.from(this.relays).map(t=>t.url)}static fromRelayUrls(t,n,s=!0){const a=new Set;for(const l of t){const de=n.pool.relays.get(normalizeRelayUrl(l));if(de)de.status<5&&s&&de.connect(),a.add(de);else{const pe=new NDKRelay(normalizeRelayUrl(l),n==null?void 0:n.relayAuthDefaultPolicy,n);n.pool.useTemporaryRelay(pe,void 0,"requested from fromRelayUrls "+t),a.add(pe)}}return new tn(new Set(a),n)}async publish(t,n,s=1){const a=new Set,l=new Map,de=t.isEphemeral();t.publishStatus="pending";const pe=Array.from(this.relays).map(me=>new Promise(Be=>{me.publish(t,n).then(Le=>{a.add(me),Be()}).catch(Le=>{de||l.set(me,Le),Be()})}));if(await Promise.all(pe),a.size<s){if(!de){const me=new NDKPublishError("Not enough relays received the event",l,a,this);throw t.publishStatus="error",t.publishError=me,this.ndk.emit("event:publish-failed",t,me,this.relayUrls),me}}else t.emit("published",{relaySet:this,publishedToRelays:a});return a}get size(){return this.relays.size}},d=debug7("ndk:outbox:calculate");async function calculateRelaySetFromEvent(e,t){var de;const n=new Set,s=await getWriteRelaysFor(e,t.pubkey);s&&s.forEach(pe=>{var Be;const me=(Be=e.pool)==null?void 0:Be.getRelay(pe);me&&n.add(me)});let a=t.tags.filter(pe=>["a","e"].includes(pe[0])).map(pe=>pe[2]).filter(pe=>pe&&pe.startsWith("wss://")).filter(pe=>{try{return new URL(pe),!0}catch{return!1}}).map(pe=>normalizeRelayUrl(pe));a=Array.from(new Set(a)).slice(0,5),a.forEach(pe=>{var Be;const me=(Be=e.pool)==null?void 0:Be.getRelay(pe,!0,!0);me&&(d("Adding relay hint %s",pe),n.add(me))});const l=t.getMatchingTags("p").map(pe=>pe[1]);return l.length<5?Array.from(chooseRelayCombinationForPubkeys(e,l,"read",{preferredRelays:new Set(s)}).keys()).forEach(me=>{var Le;const Be=(Le=e.pool)==null?void 0:Le.getRelay(me,!1,!0);Be&&(d("Adding p-tagged relay %s",me),n.add(Be))}):d("Too many p-tags to consider %d",l.length),(de=e.pool)==null||de.permanentAndConnectedRelays().forEach(pe=>n.add(pe)),new NDKRelaySet(n,e)}function calculateRelaySetsFromFilter(e,t,n){const s=new Map,a=new Set;if(t.forEach(l=>{l.authors&&l.authors.forEach(de=>a.add(de))}),a.size>0){const l=getRelaysForFilterWithAuthors(e,Array.from(a));for(const de of l.keys())s.set(de,[]);for(const de of t)if(de.authors)for(const[pe,me]of l.entries()){const Be=de.authors.filter(Le=>me.includes(Le));s.set(pe,[...s.get(pe),{...de,authors:Be}])}else for(const pe of l.keys())s.set(pe,[...s.get(pe),de])}else e.explicitRelayUrls&&e.explicitRelayUrls.forEach(l=>{s.set(l,t)});return s.size===0&&n.permanentAndConnectedRelays().slice(0,5).forEach(l=>{s.set(l.url,t)}),s.size===0&&console.warn("No relays found for filter",t),s}function calculateRelaySetsFromFilters(e,t,n){return calculateRelaySetsFromFilter(e,t,n)}function mergeTags(e,t){const n=new Map,s=de=>de.join(","),a=(de,pe)=>de.every((me,Be)=>me===pe[Be]),l=de=>{for(const[pe,me]of n)if(a(me,de)||a(de,me)){de.length>=me.length&&n.set(pe,de);return}n.set(s(de),de)};return e.concat(t).forEach(l),Array.from(n.values())}async function generateContentTags(e,t=[]){const n=/(@|nostr:)(npub|nprofile|note|nevent|naddr)[a-zA-Z0-9]+/g,s=new RegExp(`(?<=\\s|^)(#[^\\s!@#$%^&*()=+./,[{\\]};:'"?><]+)`,"g"),a=[],l=de=>{t.find(pe=>["q",de[0]].includes(pe[0])&&pe[1]===de[1])||t.push(de)};return e=e.replace(n,de=>{try{const pe=de.split(/(@|nostr:)/)[2],{type:me,data:Be}=nip19_exports.decode(pe);let Le;switch(me){case"npub":Le=["p",Be];break;case"nprofile":Le=["p",Be.pubkey];break;case"note":a.push(new Promise(async Ye=>{l(["e",Be,await maybeGetEventRelayUrl(pe),"mention"]),Ye()}));break;case"nevent":a.push(new Promise(async Ye=>{const{id:tt,author:ot}=Be;let{relays:yt}=Be;(!yt||yt.length===0)&&(yt=[await maybeGetEventRelayUrl(pe)]),l(["e",tt,yt[0],"mention"]),ot&&l(["p",ot]),Ye()}));break;case"naddr":a.push(new Promise(async Ye=>{const tt=[Be.kind,Be.pubkey,Be.identifier].join(":");let ot=Be.relays??[];ot.length===0&&(ot=[await maybeGetEventRelayUrl(pe)]),l(["a",tt,ot[0],"mention"]),l(["p",Be.pubkey]),Ye()}));break;default:return de}return Le&&l(Le),`nostr:${pe}`}catch{return de}}),await Promise.all(a),e=e.replace(s,(de,pe)=>{const me=["t",pe.slice(1)];return t.find(Be=>Be[0]===me[0]&&Be[1]===me[1])||t.push(me),de}),{content:e,tags:t}}async function maybeGetEventRelayUrl(e){return""}function isReplaceable(){if(this.kind===void 0)throw new Error("Kind not set");return[0,3].includes(this.kind)||this.kind>=1e4&&this.kind<2e4||this.kind>=3e4&&this.kind<4e4}function isEphemeral(){if(this.kind===void 0)throw new Error("Kind not set");return this.kind>=2e4&&this.kind<3e4}function isParamReplaceable(){if(this.kind===void 0)throw new Error("Kind not set");return this.kind>=3e4&&this.kind<4e4}async function encrypt(e,t){if(!this.ndk)throw new Error("No NDK instance found!");if(t||(await this.ndk.assertSigner(),t=this.ndk.signer),!e){const n=this.getMatchingTags("p");if(n.length!==1)throw new Error("No recipient could be determined and no explicit recipient was provided");e=this.ndk.getUser({pubkey:n[0][1]})}this.content=await(t==null?void 0:t.encrypt(e,this.content))}async function decrypt(e,t){if(!this.ndk)throw new Error("No NDK instance found!");t||(await this.ndk.assertSigner(),t=this.ndk.signer),e||(e=this.author),this.content=await(t==null?void 0:t.decrypt(e,this.content))}function encode(){let e=[];return this.onRelays.length>0?e=this.onRelays.map(t=>t.url):this.relay&&(e=[this.relay.url]),this.isParamReplaceable()?nip19_exports.naddrEncode({kind:this.kind,pubkey:this.pubkey,identifier:this.replaceableDTag(),relays:e}):e.length>0?nip19_exports.neventEncode({id:this.tagId(),relays:e,author:this.pubkey}):nip19_exports.noteEncode(this.tagId())}async function repost(e=!0,t){if(!t&&e){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner(),t=this.ndk.signer}const n=new NDKEvent(this.ndk,{kind:getKind(this),content:""});return n.tag(this),n.kind===16?n.tags.push(["k",`${this.kind}`]):n.content=JSON.stringify(this.rawEvent()),t&&await n.sign(t),e&&await n.publish(),n}function getKind(e){return e.kind===1?6:16}function eventHasETagMarkers(e){return e.getMatchingTags("e").some(t=>t[3])}function getRootTag(e,t){t??(t=e.tagType());const n=e.tags.find(s=>s[3]==="root");if(!n){if(eventHasETagMarkers(e))return;const s=e.getMatchingTags(t);if(s.length<3)return s[0]}return n}function getReplyTag(e,t){t??(t=e.tagType());let n=e.tags.find(s=>s[3]==="reply");if(n)return n;if(n||(n=e.tags.find(s=>s[3]==="root")),!n){if(eventHasETagMarkers(e))return;const s=e.getMatchingTags(t);if(s.length===1)return s[0];if(s.length===2)return s[1]}}async function fetchTaggedEvent(e,t){if(!this.ndk)throw new Error("NDK instance not found");const n=this.getMatchingTags(e,t);if(n.length===0)return;const[s,a,l]=n[0];return await this.ndk.fetchEvent(a,{},void 0)}async function fetchRootEvent(e){if(!this.ndk)throw new Error("NDK instance not found");const t=getRootTag(this);if(t)return this.ndk.fetchEventFromTag(t,this,e)}async function fetchReplyEvent(e){if(!this.ndk)throw new Error("NDK instance not found");const t=getReplyTag(this);if(t)return this.ndk.fetchEventFromTag(t,this,e)}function serialize(e=!1,t=!1){const n=[0,this.pubkey,this.created_at,this.kind,this.tags,this.content];return e&&n.push(this.sig),t&&n.push(this.id),JSON.stringify(n)}function deserialize(e){const t=JSON.parse(e),n={pubkey:t[1],created_at:t[2],kind:t[3],tags:t[4],content:t[5]};return t.length===7&&(n.sig=t[6]),t.length===8&&(n.id=t[7]),n}var worker,processingQueue={};function signatureVerificationInit(e){worker=e,worker.onmessage=t=>{const[n,s]=t.data,a=processingQueue[n];if(!a){console.error("No record found for event",n);return}delete processingQueue[n];for(const l of a.resolves)l(s)}}async function verifySignatureAsync(e,t){return new Promise(s=>{const a=e.serialize();let l=!1;processingQueue[e.id]||(processingQueue[e.id]={event:e,resolves:[]},l=!0),processingQueue[e.id].resolves.push(s),l&&worker.postMessage({serialized:a,id:e.id,sig:e.sig,pubkey:e.pubkey})})}var PUBKEY_REGEX=/^[a-f0-9]{64}$/;function validate(){if(typeof this.kind!="number"||typeof this.content!="string"||typeof this.created_at!="number"||typeof this.pubkey!="string"||!this.pubkey.match(PUBKEY_REGEX)||!Array.isArray(this.tags))return!1;for(let e=0;e<this.tags.length;e++){const t=this.tags[e];if(!Array.isArray(t))return!1;for(let n=0;n<t.length;n++)if(typeof t[n]=="object")return!1}return!0}var verifiedSignatures=new dist.LRUCache({maxSize:1e3,entryExpirationTimeInMS:6e4});function verifySignature(e){var n;if(typeof this.signatureVerified=="boolean")return this.signatureVerified;const t=verifiedSignatures.get(this.id);if(t!==null)return this.signatureVerified=!!t;try{if((n=this.ndk)!=null&&n.asyncSigVerification)verifySignatureAsync(this,e).then(s=>{e&&(this.signatureVerified=s,s&&verifiedSignatures.set(this.id,this.sig)),s||(this.ndk.emit("event:invalid-sig",this),verifiedSignatures.set(this.id,!1))});else{const s=sha256$2(new TextEncoder().encode(this.serialize())),a=schnorr.verify(this.sig,s,this.pubkey);return a?verifiedSignatures.set(this.id,this.sig):verifiedSignatures.set(this.id,!1),this.signatureVerified=a}}catch{return this.signatureVerified=!1}}function getEventHash(){return getEventHashFromSerializedEvent(this.serialize())}function getEventHashFromSerializedEvent(e){const t=sha256$2(new TextEncoder().encode(e));return bytesToHex$3(t)}var skipClientTagOnKinds=[3],NDKEvent=class Qt extends lib$1.EventEmitter{constructor(n,s){var a;super();bt(this,"ndk");bt(this,"created_at");bt(this,"content","");bt(this,"tags",[]);bt(this,"kind");bt(this,"id","");bt(this,"sig");bt(this,"pubkey","");bt(this,"signatureVerified");bt(this,"_author");bt(this,"relay");bt(this,"publishStatus","success");bt(this,"publishError");bt(this,"serialize",serialize.bind(this));bt(this,"getEventHash",getEventHash.bind(this));bt(this,"validate",validate.bind(this));bt(this,"verifySignature",verifySignature.bind(this));bt(this,"isReplaceable",isReplaceable.bind(this));bt(this,"isEphemeral",isEphemeral.bind(this));bt(this,"isParamReplaceable",isParamReplaceable.bind(this));bt(this,"encode",encode.bind(this));bt(this,"encrypt",encrypt.bind(this));bt(this,"decrypt",decrypt.bind(this));bt(this,"fetchTaggedEvent",fetchTaggedEvent.bind(this));bt(this,"fetchRootEvent",fetchRootEvent.bind(this));bt(this,"fetchReplyEvent",fetchReplyEvent.bind(this));bt(this,"repost",repost.bind(this));this.ndk=n,this.created_at=s==null?void 0:s.created_at,this.content=(s==null?void 0:s.content)||"",this.tags=(s==null?void 0:s.tags)||[],this.id=(s==null?void 0:s.id)||"",this.sig=s==null?void 0:s.sig,this.pubkey=(s==null?void 0:s.pubkey)||"",this.kind=s==null?void 0:s.kind,s instanceof Qt&&(this.relay&&(this.relay=s.relay,(a=this.ndk)==null||a.subManager.seenEvent(s.id,this.relay)),this.publishStatus=s.publishStatus,this.publishError=s.publishError)}get onRelays(){let n=[];return this.ndk?n=this.ndk.subManager.seenEvents.get(this.id)||[]:this.relay&&n.push(this.relay),n}static deserialize(n,s){return new Qt(n,deserialize(s))}rawEvent(){return{created_at:this.created_at,content:this.content,tags:this.tags,kind:this.kind,pubkey:this.pubkey,id:this.id,sig:this.sig}}set author(n){var s;this.pubkey=n.pubkey,this._author=n,(s=this._author).ndk??(s.ndk=this.ndk)}get author(){if(this._author)return this._author;if(!this.ndk)throw new Error("No NDK instance found");const n=this.ndk.getUser({pubkey:this.pubkey});return this._author=n,n}tag(n,s,a,l){let de=[];if(n.fetchProfile!==void 0){l??(l="p");const me=[l,n.pubkey];s&&me.push("",s),de.push(me)}else if(n instanceof Qt){const me=n;a??(a=(me==null?void 0:me.pubkey)===this.pubkey),de=me.referenceTags(s,a,l);for(const Be of me.getMatchingTags("p"))Be[1]!==this.pubkey&&(this.tags.find(Le=>Le[0]==="p"&&Le[1]===Be[1])||this.tags.push(["p",Be[1]]))}else if(Array.isArray(n))de=[n];else throw new Error("Invalid argument",n);this.tags=mergeTags(this.tags,de)}async toNostrEvent(n){var l,de;if(!n&&this.pubkey===""){const pe=await((de=(l=this.ndk)==null?void 0:l.signer)==null?void 0:de.user());this.pubkey=(pe==null?void 0:pe.pubkey)||""}this.created_at||(this.created_at=Math.floor(Date.now()/1e3));const{content:s,tags:a}=await this.generateTags();this.content=s||"",this.tags=a;try{this.id=this.getEventHash()}catch{}return this.rawEvent()}getMatchingTags(n,s){const a=this.tags.filter(l=>l[0]===n);return s===void 0?a:a.filter(l=>l[3]===s)}hasTag(n,s){return this.tags.some(a=>a[0]===n&&(!s||a[3]===s))}tagValue(n){const s=this.getMatchingTags(n);if(s.length!==0)return s[0][1]}get alt(){return this.tagValue("alt")}set alt(n){this.removeTag("alt"),n&&this.tags.push(["alt",n])}get dTag(){return this.tagValue("d")}set dTag(n){this.removeTag("d"),n&&this.tags.push(["d",n])}removeTag(n){const s=Array.isArray(n)?n:[n];this.tags=this.tags.filter(a=>!s.includes(a[0]))}async sign(n){var a;n?this.author=await n.user():((a=this.ndk)==null||a.assertSigner(),n=this.ndk.signer);const s=await this.toNostrEvent();return this.sig=await n.sign(s),this.sig}async publishReplaceable(n,s,a){return this.id="",this.created_at=Math.floor(Date.now()/1e3),this.sig="",this.publish(n,s,a)}async publish(n,s,a){var pe,me;if(this.sig||await this.sign(),!this.ndk)throw new Error("NDKEvent must be associated with an NDK instance to publish");n||(n=this.ndk.devWriteRelaySet||await calculateRelaySetFromEvent(this.ndk,this)),this.kind===5&&((pe=this.ndk.cacheAdapter)!=null&&pe.deleteEvent)&&this.ndk.cacheAdapter.deleteEvent(this);const l=this.rawEvent();if((me=this.ndk.cacheAdapter)!=null&&me.addUnpublishedEvent)try{this.ndk.cacheAdapter.addUnpublishedEvent(this,n.relayUrls)}catch(Be){console.error("Error adding unpublished event to cache",Be)}this.ndk.subManager.subscriptions.forEach(Be=>{Be.filters.some(Le=>matchFilter(Le,l))&&Be.eventReceived(this,void 0,!1,!0)});const de=await n.publish(this,s,a);return de.forEach(Be=>{var Le;return(Le=this.ndk)==null?void 0:Le.subManager.seenEvent(this.id,Be)}),de}async generateTags(){var l,de;let n=[];const s=await generateContentTags(this.content,this.tags),a=s.content;if(n=s.tags,this.kind&&this.isParamReplaceable()&&!this.getMatchingTags("d")[0]){const me=this.tagValue("title");let Le=[...Array(me?6:16)].map(()=>Math.random().toString(36)[2]).join("");me&&me.length>0&&(Le=me.replace(/[^a-z0-9]+/gi,"-").replace(/^-|-$/g,"")+"-"+Le),n.push(["d",Le])}if(((l=this.ndk)!=null&&l.clientName||(de=this.ndk)!=null&&de.clientNip89)&&skipClientTagOnKinds.includes(this.kind)&&!this.tags.some(pe=>pe[0]==="client")){const pe=["client",this.ndk.clientName??""];this.ndk.clientNip89&&pe.push(this.ndk.clientNip89),n.push(pe)}return{content:a||"",tags:n}}muted(){var l,de;const n=(l=this.ndk)==null?void 0:l.mutedIds.get(this.pubkey);if(n&&n==="p")return"author";const s=this.tagReference(),a=(de=this.ndk)==null?void 0:de.mutedIds.get(s[1]);return a&&a===s[0]?"event":null}replaceableDTag(){if(this.kind&&this.kind>=3e4&&this.kind<=4e4){const n=this.getMatchingTags("d")[0];return n?n[1]:""}throw new Error("Event is not a parameterized replaceable event")}deduplicationKey(){return this.kind===0||this.kind===3||this.kind&&this.kind>=1e4&&this.kind<2e4?`${this.kind}:${this.pubkey}`:this.tagId()}tagId(){return this.isParamReplaceable()?this.tagAddress():this.id}tagAddress(){if(!this.isParamReplaceable())throw new Error("This must only be called on replaceable events");const n=this.replaceableDTag();return`${this.kind}:${this.pubkey}:${n}`}tagType(){return this.isParamReplaceable()?"a":"e"}tagReference(n){let s;return this.isParamReplaceable()?s=["a",this.tagAddress()]:s=["e",this.tagId()],this.relay?s.push(this.relay.url):s.push(""),n&&s.push(n),s}referenceTags(n,s,a){var de;let l=[];return this.isParamReplaceable()?l=[[a??"a",this.tagAddress()],[a??"e",this.id]]:l=[[a??"e",this.id]],(de=this.relay)!=null&&de.url?l=l.map(pe=>{var me;return pe.push((me=this.relay)==null?void 0:me.url),pe}):n&&(l=l.map(pe=>(pe.push(""),pe))),n&&l.forEach(pe=>pe.push(n)),l=[...l,...this.getMatchingTags("h")],s||l.push(...this.author.referenceTags()),l}filter(){return this.isParamReplaceable()?{"#a":[this.tagId()]}:{"#e":[this.tagId()]}}async delete(n,s=!0){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner();const a=new Qt(this.ndk,{kind:5,content:n||""});return a.tag(this,void 0,!0),a.tags.push(["k",this.kind.toString()]),s&&await a.publish(),a}async react(n,s=!0){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner();const a=new Qt(this.ndk,{kind:7,content:n});return a.tag(this),s?await a.publish():await a.sign(),a}get isValid(){return this.validate()}};function queryFullyFilled(e){return!!(filterIncludesIds(e.filter)&&resultHasAllRequestedIds(e))}function filterIncludesIds(e){return!!e.ids}function resultHasAllRequestedIds(e){const t=e.filter.ids;return!!t&&t.length===e.eventFirstSeen.size}function filterFromId(e){let t;if(e.match(NIP33_A_REGEX)){const[n,s,a]=e.split(":"),l={authors:[s],kinds:[parseInt(n)]};return a&&(l["#d"]=[a]),l}if(e.match(BECH32_REGEX))try{switch(t=nip19_exports.decode(e),t.type){case"nevent":{const s={ids:[t.data.id]};return t.data.author&&(s.authors=[t.data.author]),t.data.kind&&(s.kinds=[t.data.kind]),s}case"note":return{ids:[t.data]};case"naddr":const n={authors:[t.data.pubkey],kinds:[t.data.kind]};return t.data.identifier&&(n["#d"]=[t.data.identifier]),n}}catch(n){console.error("Error decoding",e,n)}return{ids:[e]}}function isNip33AValue(e){return e.match(NIP33_A_REGEX)!==null}var NIP33_A_REGEX=/^(\d+):([0-9A-Fa-f]+)(?::(.*))?$/,BECH32_REGEX=/^n(event|ote|profile|pub|addr)1[\d\w]+$/;function relaysFromBech32(e,t){try{const n=nip19_exports.decode(e);if(["naddr","nevent"].includes(n==null?void 0:n.type)){const s=n.data;if(s!=null&&s.relays)return s.relays.map(a=>new NDKRelay(a,t==null?void 0:t.relayAuthDefaultPolicy,t))}}catch{}return[]}var defaultOpts={closeOnEose:!1,cacheUsage:"CACHE_FIRST",groupable:!0,groupableDelay:100,groupableDelayType:"at-most"},NDKSubscription=class extends lib$1.EventEmitter{constructor(t,n,s,a,l){super();bt(this,"subId");bt(this,"filters");bt(this,"opts");bt(this,"pool");bt(this,"skipVerification",!1);bt(this,"skipValidation",!1);bt(this,"relayFilters");bt(this,"relaySet");bt(this,"ndk");bt(this,"debug");bt(this,"eventFirstSeen",new Map);bt(this,"eosesSeen",new Set);bt(this,"lastEventReceivedAt");bt(this,"internalId");bt(this,"closeOnEose");bt(this,"poolMonitor");bt(this,"eoseTimeout");bt(this,"eosed",!1);if(this.ndk=t,this.pool=(s==null?void 0:s.pool)||t.pool,this.opts={...defaultOpts,...s||{}},this.filters=n instanceof Array?n:[n],this.subId=l||(s==null?void 0:s.subId),this.internalId=Math.random().toString(36).substring(7),this.relaySet=a,this.debug=t.debug.extend(`subscription[${(s==null?void 0:s.subId)??this.internalId}]`),this.skipVerification=(s==null?void 0:s.skipVerification)||!1,this.skipValidation=(s==null?void 0:s.skipValidation)||!1,this.closeOnEose=(s==null?void 0:s.closeOnEose)||!1,this.opts.cacheUsage==="ONLY_CACHE"&&!this.opts.closeOnEose)throw new Error("Cannot use cache-only options with a persistent subscription")}relaysMissingEose(){return this.relayFilters?Array.from(this.relayFilters.keys()).filter(n=>!this.eosesSeen.has(this.pool.getRelay(n,!1,!1))):[]}get filter(){return this.filters[0]}get groupableDelay(){var t;if(this.isGroupable())return(t=this.opts)==null?void 0:t.groupableDelay}get groupableDelayType(){var t;return((t=this.opts)==null?void 0:t.groupableDelayType)||"at-most"}isGroupable(){var t;return((t=this.opts)==null?void 0:t.groupable)||!1}shouldQueryCache(){var t;return((t=this.opts)==null?void 0:t.cacheUsage)!=="ONLY_RELAY"}shouldQueryRelays(){var t;return((t=this.opts)==null?void 0:t.cacheUsage)!=="ONLY_CACHE"}shouldWaitForCache(){var t;return this.opts.closeOnEose&&!!((t=this.ndk.cacheAdapter)!=null&&t.locking)&&this.opts.cacheUsage!=="PARALLEL"}async start(){let t;if(this.shouldQueryCache()&&(t=this.startWithCache(),this.shouldWaitForCache()&&(await t,queryFullyFilled(this)))){this.emit("eose",this);return}this.shouldQueryRelays()?(this.startWithRelays(),this.startPoolMonitor()):this.emit("eose",this)}startPoolMonitor(){this.debug.extend("pool-monitor"),this.poolMonitor=t=>{var s,a;if((s=this.relayFilters)!=null&&s.has(t.url))return;calculateRelaySetsFromFilters(this.ndk,this.filters,this.pool).get(t.url)&&((a=this.relayFilters)==null||a.set(t.url,this.filters),t.subscribe(this,this.filters))},this.pool.on("relay:connect",this.poolMonitor)}stop(){this.emit("close",this),this.poolMonitor&&this.pool.off("relay:connect",this.poolMonitor),this.removeAllListeners()}hasAuthorsFilter(){return this.filters.some(t=>{var n;return(n=t.authors)==null?void 0:n.length})}async startWithCache(){var t;if((t=this.ndk.cacheAdapter)!=null&&t.query){const n=this.ndk.cacheAdapter.query(this);this.ndk.cacheAdapter.locking&&await n}}startWithRelays(){if(!this.relaySet)this.relayFilters=calculateRelaySetsFromFilters(this.ndk,this.filters,this.pool);else{this.relayFilters=new Map;for(const t of this.relaySet.relays)this.relayFilters.set(t.url,this.filters)}if(!(!this.relayFilters||this.relayFilters.size===0))for(const[t,n]of this.relayFilters)this.pool.getRelay(t,!0,!0,n).subscribe(this,n)}eventReceived(t,n,s=!1,a=!1){const l=t.id,de=this.eventFirstSeen.has(l);let pe;if(t instanceof NDKEvent&&(pe=t),de){const me=Date.now()-(this.eventFirstSeen.get(l)||0);if(this.emit("event:dup",l,n,me,this),n){const Be=verifiedSignatures.get(l);Be&&typeof Be=="string"&&t.sig===Be&&n.addValidatedEvent()}}else{if(pe??(pe=new NDKEvent(this.ndk,t)),pe.ndk=this.ndk,pe.relay=n,!s&&!a){if(!this.skipValidation&&!pe.isValid){this.debug("Event failed validation %s from relay %s",l,n==null?void 0:n.url);return}if(n)if((n==null?void 0:n.shouldValidateEvent())!==!1){if(!this.skipVerification)if(!pe.verifySignature(!0)&&!this.ndk.asyncSigVerification){this.debug("Event failed signature validation",t);return}else n&&n.addValidatedEvent()}else n.addNonValidatedEvent();this.ndk.cacheAdapter&&this.ndk.cacheAdapter.setEvent(pe,this.filters,n)}!s&&n&&this.ndk.emit("event",pe,n),this.emit("event",pe,n,this),this.eventFirstSeen.set(l,Date.now())}this.lastEventReceivedAt=Date.now()}closedReceived(t,n){this.emit("closed",t,n)}eoseReceived(t){var de;this.debug("Received EOSE from %s",t.url),this.eosesSeen.add(t);let n=this.lastEventReceivedAt?Date.now()-this.lastEventReceivedAt:void 0;const s=this.eosesSeen.size===((de=this.relayFilters)==null?void 0:de.size),a=queryFullyFilled(this),l=pe=>{var me;this.eosed||(this.eoseTimeout&&clearTimeout(this.eoseTimeout),this.debug(`Performing EOSE: ${pe}`),this.emit("eose",this),this.eosed=!0,(me=this.opts)!=null&&me.closeOnEose&&this.stop())};if(a||s)l("query filled or seen all");else if(this.relayFilters){let pe=1e3;const me=new Set(this.pool.connectedRelays().map(Ye=>Ye.url)),Be=Array.from(this.relayFilters.keys()).filter(Ye=>me.has(Ye));if(Be.length===0)return;const Le=this.eosesSeen.size/Be.length;if(this.eosesSeen.size>=2&&Le>=.5){if(pe=pe*(1-Le),pe===0){l("tiem to wait was 0");return}this.eoseTimeout&&clearTimeout(this.eoseTimeout);const Ye=()=>{n=this.lastEventReceivedAt?Date.now()-this.lastEventReceivedAt:void 0,n!==void 0&&n<20?this.eoseTimeout=setTimeout(Ye,pe):l("send eose timeout: "+pe)};this.eoseTimeout=setTimeout(Ye,pe)}}}};async function follows(e,t,n=3){var a,l;if(!this.ndk)throw new Error("NDK not set");const s=await this.ndk.fetchEvent({kinds:[n],authors:[this.pubkey]},e||{groupable:!1});if(s){const de=new Set;return s.tags.forEach(pe=>{pe[0]==="p"&&de.add(pe[1])}),t&&((l=(a=this.ndk)==null?void 0:a.outboxTracker)==null||l.trackUsers(Array.from(de))),[...de].reduce((pe,me)=>{const Be=new NDKUser({pubkey:me});return Be.ndk=this.ndk,pe.add(Be),pe},new Set)}return new Set}function profileFromEvent(e){const t={};let n;try{n=JSON.parse(e.content)}catch(s){throw new Error(`Failed to parse profile event: ${s}`)}return t.created_at=e.created_at,t.profileEvent=JSON.stringify(e.rawEvent()),Object.keys(n).forEach(s=>{switch(s){case"name":t.name=n.name;break;case"display_name":t.displayName=n.display_name;break;case"image":case"picture":t.image=n.picture||n.image;break;case"banner":t.banner=n.banner;break;case"bio":t.bio=n.bio;break;case"nip05":t.nip05=n.nip05;break;case"lud06":t.lud06=n.lud06;break;case"lud16":t.lud16=n.lud16;break;case"about":t.about=n.about;break;case"zapService":t.zapService=n.zapService;break;case"website":t.website=n.website;break;default:t[s]=n[s];break}}),t}function serializeProfile(e){const t={};for(const[n,s]of Object.entries(e))switch(n){case"username":case"name":t.name=s;break;case"displayName":t.display_name=s;break;case"image":case"picture":t.picture=s;break;case"bio":case"about":t.about=s;break;default:t[n]=s;break}return JSON.stringify(t)}var NIP05_REGEX=/^(?:([\w.+-]+)@)?([\w.-]+)$/;async function getNip05For(e,t,n=fetch,s={}){return await e.queuesNip05.add({id:t,func:async()=>{if(e.cacheAdapter&&e.cacheAdapter.loadNip05){const me=await e.cacheAdapter.loadNip05(t);if(me!=="missing"){if(me){const Be=new NDKUser({pubkey:me.pubkey,relayUrls:me.relays,nip46Urls:me.nip46});return Be.ndk=e,Be}else if(s.cache!=="no-cache")return null}}const a=t.match(NIP05_REGEX);if(!a)return null;const[l,de="_",pe]=a;try{const me=await n(`https://${pe}/.well-known/nostr.json?name=${de}`,s),{names:Be,relays:Le,nip46:Ye}=parseNIP05Result(await me.json()),tt=Be[de.toLowerCase()];let ot=null;return tt&&(ot={pubkey:tt,relays:Le==null?void 0:Le[tt],nip46:Ye==null?void 0:Ye[tt]}),e!=null&&e.cacheAdapter&&e.cacheAdapter.saveNip05&&e.cacheAdapter.saveNip05(t,ot),ot}catch(me){return e!=null&&e.cacheAdapter&&e.cacheAdapter.saveNip05&&(e==null||e.cacheAdapter.saveNip05(t,null)),console.error("Failed to fetch NIP05 for",t,me),null}}})}function parseNIP05Result(e){const t={names:{}};for(const[n,s]of Object.entries(e.names))typeof n=="string"&&typeof s=="string"&&(t.names[n.toLowerCase()]=s);if(e.relays){t.relays={};for(const[n,s]of Object.entries(e.relays))typeof n=="string"&&Array.isArray(s)&&(t.relays[n]=s.filter(a=>typeof a=="string"))}if(e.nip46){t.nip46={};for(const[n,s]of Object.entries(e.nip46))typeof n=="string"&&Array.isArray(s)&&(t.nip46[n]=s.filter(a=>typeof a=="string"))}return t}var Yt,NDKCashuMintList=(Yt=class extends NDKEvent{constructor(n,s){super(n,s);bt(this,"_p2pk");this.kind??(this.kind=10019)}static from(n){return new Yt(n.ndk,n)}set relays(n){this.tags=this.tags.filter(s=>s[0]!=="relay");for(const s of n)this.tags.push(["relay",s])}get relays(){const n=[];for(const s of this.tags)s[0]==="relay"&&n.push(s[1]);return n}set mints(n){this.tags=this.tags.filter(s=>s[0]!=="mint");for(const s of n)this.tags.push(["mint",s])}get mints(){const n=[];for(const s of this.tags)s[0]==="mint"&&n.push(s[1]);return Array.from(new Set(n))}get p2pk(){return this._p2pk?this._p2pk:(this._p2pk=this.tagValue("pubkey")??this.pubkey,this._p2pk)}set p2pk(n){this._p2pk=n,this.removeTag("pubkey"),n&&this.tags.push(["pubkey",n])}get relaySet(){return NDKRelaySet.fromRelayUrls(this.relays,this.ndk)}},bt(Yt,"kind",10019),bt(Yt,"kinds",[10019]),Yt),d2=debug7("ndk:zapper:ln");async function getNip57ZapSpecFromLud({lud06:e,lud16:t},n){let s;if(t&&!t.startsWith("LNURL")){const[a,l]=t.split("@");s=`https://${l}/.well-known/lnurlp/${a}`}else if(e){const{words:a}=bech32$2.decode(e,1e3),l=bech32$2.fromWords(a);s=new TextDecoder("utf-8").decode(l)}if(!s)throw d2("No zap endpoint found %o",{lud06:e,lud16:t}),new Error("No zap endpoint found");try{const l=await(n.httpFetch||fetch)(s);if(l.status!==200){const de=await l.text();throw new Error(`Unable to fetch zap endpoint ${s}: ${de}`)}return await l.json()}catch(a){throw new Error(`Unable to fetch zap endpoint ${s}: ${a}`)}}var NDKUser=class nn{constructor(t){bt(this,"ndk");bt(this,"profile");bt(this,"_npub");bt(this,"_pubkey");bt(this,"relayUrls",[]);bt(this,"nip46Urls",[]);bt(this,"follows",follows.bind(this));t.npub&&(this._npub=t.npub),t.hexpubkey&&(this._pubkey=t.hexpubkey),t.pubkey&&(this._pubkey=t.pubkey),t.relayUrls&&(this.relayUrls=t.relayUrls),t.nip46Urls&&(this.nip46Urls=t.nip46Urls)}get npub(){if(!this._npub){if(!this._pubkey)throw new Error("pubkey not set");this._npub=nip19_exports.npubEncode(this.pubkey)}return this._npub}set npub(t){this._npub=t}get hexpubkey(){return this.pubkey}set hexpubkey(t){this._pubkey=t}get pubkey(){if(!this._pubkey){if(!this._npub)throw new Error("npub not set");this._pubkey=nip19_exports.decode(this.npub).data}return this._pubkey}set pubkey(t){this._pubkey=t}async getZapInfo(t=!0,n=["nip61","nip57"]){if(!this.ndk)throw new Error("No NDK instance found");const s=[];if(n.includes("nip61")&&s.push(10019),n.includes("nip57")&&s.push(0),s.length===0)return[];let a=await this.ndk.fetchEvents({kinds:s,authors:[this.pubkey]},{cacheUsage:"ONLY_CACHE",groupable:!1});a.size<n.length&&(a=await this.ndk.fetchEvents({kinds:s,authors:[this.pubkey]},{cacheUsage:"ONLY_RELAY"}));const l=[],de=Array.from(a).find(me=>me.kind===10019),pe=Array.from(a).find(me=>me.kind===0);if(de){const me=NDKCashuMintList.from(de);if(me.mints.length>0&&l.push({type:"nip61",data:{mints:me.mints,relays:me.relays,p2pk:me.p2pk}}),!t)return l}if(pe){const me=profileFromEvent(pe),{lud06:Be,lud16:Le}=me;try{const Ye=await getNip57ZapSpecFromLud({lud06:Be,lud16:Le},this.ndk);Ye&&l.push({type:"nip57",data:Ye})}catch(Ye){console.error("Error getting NIP-57 zap spec",Ye)}}return l}async getZapConfiguration(t){if(t??(t=this.ndk),!t)throw new Error("No NDK instance found");const n=async()=>{var a,l,de,pe;if((l=(a=this.ndk)==null?void 0:a.cacheAdapter)!=null&&l.loadUsersLNURLDoc){const me=await this.ndk.cacheAdapter.loadUsersLNURLDoc(this.pubkey);if(me!=="missing"){if(me===null)return;if(me)return me}}let s;try{if(await this.fetchProfile({groupable:!1}),this.profile){const{lud06:me,lud16:Be}=this.profile;s=await getNip57ZapSpecFromLud({lud06:me,lud16:Be},t)}}catch{}if((pe=(de=this.ndk)==null?void 0:de.cacheAdapter)!=null&&pe.saveUsersLNURLDoc&&this.ndk.cacheAdapter.saveUsersLNURLDoc(this.pubkey,s||null),!!s)return s};return await t.queuesZapConfig.add({id:this.pubkey,func:n})}async getZapperPubkey(){const t=await this.getZapConfiguration();return t==null?void 0:t.nostrPubkey}static async fromNip05(t,n,s=!1){if(!n)throw new Error("No NDK instance found");const a={};s&&(a.cache="no-cache");const l=await getNip05For(n,t,n==null?void 0:n.httpFetch,a);if(l){const de=new nn({pubkey:l.pubkey,relayUrls:l.relays,nip46Urls:l.nip46});return de.ndk=n,de}}async fetchProfile(t,n=!1){if(!this.ndk)throw new Error("NDK not set");this.profile||(this.profile={});let s=null;if(this.ndk.cacheAdapter&&this.ndk.cacheAdapter.fetchProfile&&(t==null?void 0:t.cacheUsage)!=="ONLY_RELAY"){const de=await this.ndk.cacheAdapter.fetchProfile(this.pubkey);if(de)return this.profile=de,de}!t&&this.ndk.cacheAdapter&&this.ndk.cacheAdapter.locking&&(s=await this.ndk.fetchEvents({kinds:[0],authors:[this.pubkey]},{cacheUsage:"ONLY_CACHE",closeOnEose:!0,groupable:!1}),t={cacheUsage:"ONLY_RELAY",closeOnEose:!0,groupable:!0,groupableDelay:250}),(!s||s.size===0)&&(s=await this.ndk.fetchEvents({kinds:[0],authors:[this.pubkey]},t));const a=Array.from(s).sort((de,pe)=>de.created_at-pe.created_at);if(a.length===0)return null;const l=a[0];return this.profile=profileFromEvent(l),n&&(this.profile.profileEvent=JSON.stringify(l)),this.profile&&this.ndk.cacheAdapter&&this.ndk.cacheAdapter.saveProfile&&this.ndk.cacheAdapter.saveProfile(this.pubkey,this.profile),this.profile}tagReference(){return["p",this.pubkey]}referenceTags(t){const n=[["p",this.pubkey]];return t&&n[0].push("",t),n}async publish(){if(!this.ndk)throw new Error("No NDK instance found");if(!this.profile)throw new Error("No profile available");this.ndk.assertSigner(),await new NDKEvent(this.ndk,{kind:0,content:serializeProfile(this.profile)}).publish()}async follow(t,n,s=3){if(!this.ndk)throw new Error("No NDK instance found");if(this.ndk.assertSigner(),n||(n=await this.follows(void 0,void 0,s)),n.has(t))return!1;n.add(t);const a=new NDKEvent(this.ndk,{kind:s});for(const l of n)a.tag(l);return await a.publish(),!0}async unfollow(t,n,s=3){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner(),n||(n=await this.follows(void 0,void 0,s));const a=new Set;let l=!1;for(const pe of n)pe.pubkey!==t.pubkey?a.add(pe):l=!0;if(!l)return!1;const de=new NDKEvent(this.ndk,{kind:s});for(const pe of a)de.tag(pe);return await de.publish()}async validateNip05(t){if(!this.ndk)throw new Error("No NDK instance found");const n=await getNip05For(this.ndk,t);return n===null?null:n.pubkey===this.pubkey}async zap(t,n,s,a){return new Promise((l,de)=>{var Be;if(!this.ndk){de("No NDK instance found");return}let pe=(Be=this.ndk.walletConfig)==null?void 0:Be.onLnPay;pe??(pe=async({pr:Le})=>{l(Le)}),this.ndk.zap(this,t,{comment:n,tags:s,signer:a,onLnPay:pe}).zap().then(l).catch(de)})}},NDKList=class rn extends NDKEvent{constructor(n,s){super(n,s);bt(this,"_encryptedTags");bt(this,"encryptedTagsLength");this.kind??(this.kind=30001)}static from(n){return new rn(n.ndk,n)}get title(){const n=this.tagValue("title")||this.tagValue("name");return n||(this.kind===3?"Contacts":this.kind===1e4?"Mute":this.kind===10001?"Pinned Notes":this.kind===10002?"Relay Metadata":this.kind===10003?"Bookmarks":this.kind===10004?"Communities":this.kind===10005?"Public Chats":this.kind===10006?"Blocked Relays":this.kind===10007?"Search Relays":this.kind===10015?"Interests":this.kind===10030?"Emojis":this.tagValue("d"))}set title(n){this.removeTag(["title","name"]),n&&this.tags.push(["title",n])}get name(){return this.title}set name(n){this.title=n}get description(){return this.tagValue("description")}set description(n){this.removeTag("description"),n&&this.tags.push(["description",n])}get image(){return this.tagValue("image")}set image(n){this.removeTag("image"),n&&this.tags.push(["image",n])}isEncryptedTagsCacheValid(){return!!(this._encryptedTags&&this.encryptedTagsLength===this.content.length)}async encryptedTags(n=!0){if(n&&this.isEncryptedTagsCacheValid())return this._encryptedTags;if(!this.ndk)throw new Error("NDK instance not set");if(!this.ndk.signer)throw new Error("NDK signer not set");const s=await this.ndk.signer.user();try{if(this.content.length>0)try{const a=await this.ndk.signer.decrypt(s,this.content),l=JSON.parse(a);return l&&l[0]?(this.encryptedTagsLength=this.content.length,this._encryptedTags=l):(this.encryptedTagsLength=this.content.length,this._encryptedTags=[])}catch{console.log(`error decrypting ${this.content}`)}}catch{}return[]}validateTag(n){return!0}getItems(n){return this.tags.filter(s=>s[0]===n)}get items(){return this.tags.filter(n=>!["d","L","l","title","name","description","published_at","summary","image","thumb","alt","expiration","subject","client"].includes(n[0]))}async addItem(n,s=void 0,a=!1,l="bottom"){if(!this.ndk)throw new Error("NDK instance not set");if(!this.ndk.signer)throw new Error("NDK signer not set");let de;if(n instanceof NDKEvent)de=[n.tagReference(s)];else if(n instanceof NDKUser)de=n.referenceTags();else if(n instanceof NDKRelay)de=n.referenceTags();else if(Array.isArray(n))de=[n];else throw new Error("Invalid object type");if(s&&de[0].push(s),a){const pe=await this.ndk.signer.user(),me=await this.encryptedTags();l==="top"?me.unshift(...de):me.push(...de),this._encryptedTags=me,this.encryptedTagsLength=this.content.length,this.content=JSON.stringify(me),await this.encrypt(pe)}else l==="top"?this.tags.unshift(...de):this.tags.push(...de);this.created_at=Math.floor(Date.now()/1e3),this.emit("change")}async removeItemByValue(n,s=!0){if(!this.ndk)throw new Error("NDK instance not set");if(!this.ndk.signer)throw new Error("NDK signer not set");const a=this.tags.findIndex(me=>me[1]===n);a>=0&&this.tags.splice(a,1);const l=await this.ndk.signer.user(),de=await this.encryptedTags(),pe=de.findIndex(me=>me[1]===n);if(pe>=0&&(de.splice(pe,1),this._encryptedTags=de,this.encryptedTagsLength=this.content.length,this.content=JSON.stringify(de),await this.encrypt(l)),s)return this.publishReplaceable();this.created_at=Math.floor(Date.now()/1e3),this.emit("change")}async removeItem(n,s){if(!this.ndk)throw new Error("NDK instance not set");if(!this.ndk.signer)throw new Error("NDK signer not set");if(s){const a=await this.ndk.signer.user(),l=await this.encryptedTags();l.splice(n,1),this._encryptedTags=l,this.encryptedTagsLength=this.content.length,this.content=JSON.stringify(l),await this.encrypt(a)}else this.tags.splice(n,1);return this.created_at=Math.floor(Date.now()/1e3),this.emit("change"),this}has(n){return this.items.some(s=>s[1]===n)}filterForItems(){const n=new Set,s=new Map,a=[];for(const l of this.items)if(l[0]==="e"&&l[1])n.add(l[1]);else if(l[0]==="a"&&l[1]){const[de,pe,me]=l[1].split(":");if(!de||!pe)continue;const Be=`${de}:${pe}`,Le=s.get(Be)||[];Le.push(me||""),s.set(Be,Le)}if(n.size>0&&a.push({ids:Array.from(n)}),s.size>0)for(const[l,de]of s.entries()){const[pe,me]=l.split(":");a.push({kinds:[parseInt(pe)],authors:[me],"#d":de})}return a}},lists_default=NDKList,READ_MARKER="read",WRITE_MARKER="write",NDKRelayList=class sn extends NDKEvent{constructor(t,n){super(t,n),this.kind??(this.kind=10002)}static from(t){return new sn(t.ndk,t.rawEvent())}get readRelayUrls(){return this.tags.filter(t=>t[0]==="r"||t[0]==="relay").filter(t=>!t[2]||t[2]&&t[2]===READ_MARKER).map(t=>tryNormalizeRelayUrl(t[1])).filter(t=>!!t)}set readRelayUrls(t){for(const n of t)this.tags.push(["r",n,READ_MARKER])}get writeRelayUrls(){return this.tags.filter(t=>t[0]==="r"||t[0]==="relay").filter(t=>!t[2]||t[2]&&t[2]===WRITE_MARKER).map(t=>tryNormalizeRelayUrl(t[1])).filter(t=>!!t)}set writeRelayUrls(t){for(const n of t)this.tags.push(["r",n,WRITE_MARKER])}get bothRelayUrls(){return this.tags.filter(t=>t[0]==="r"||t[0]==="relay").filter(t=>!t[2]).map(t=>t[1])}set bothRelayUrls(t){for(const n of t)this.tags.push(["r",n])}get relays(){return this.tags.filter(t=>t[0]==="r"||t[0]==="relay").map(t=>t[1])}get relaySet(){if(!this.ndk)throw new Error("NDKRelayList has no NDK instance");return new NDKRelaySet(new Set(this.relays.map(t=>this.ndk.pool.getRelay(t))),this.ndk)}};function relayListFromKind3(e,t){try{const n=JSON.parse(t.content),s=new NDKRelayList(e),a=new Set,l=new Set;for(let[de,pe]of Object.entries(n)){try{de=normalizeRelayUrl(de)}catch{continue}if(!pe)a.add(de),l.add(de);else{const me=pe;me.write&&l.add(de),me.read&&a.add(de)}}return s.readRelayUrls=Array.from(a),s.writeRelayUrls=Array.from(l),s}catch{}}var Xt,NDKNutzap=(Xt=class extends NDKEvent{constructor(n,s){super(n,s);bt(this,"debug");bt(this,"_proofs",[]);bt(this,"sender",this.author);this.kind??(this.kind=9321),this.debug=(n==null?void 0:n.debug.extend("nutzap"))??debug7("ndk:nutzap"),this.alt||(this.alt="This is a nutzap")}static from(n){const s=new this(n.ndk,n);try{const a=s.getMatchingTags("proof");a.length?s._proofs=a.map(l=>JSON.parse(l[1])):s._proofs=JSON.parse(s.content)}catch{return}if(!(!s._proofs||!s._proofs.length))return s}set comment(n){this.content=n??""}get comment(){const n=this.tagValue("comment");return n||this.content}set proofs(n){this._proofs=n,this.tags=this.tags.filter(s=>s[0]!=="proof");for(const s of n)this.tags.push(["proof",JSON.stringify(s)]);this.removeTag("amount"),this.tags.push(["amount",this.amount.toString()])}get proofs(){return this._proofs}get p2pk(){var s;const n=this.proofs[0];try{const a=JSON.parse(n.secret);let l={};if(typeof a=="string"?(l=JSON.parse(a),this.debug("stringified payload",n.secret)):typeof a=="object"&&(l=a),l[0]==="P2PK"&&((s=l[1])==null?void 0:s.data)){const me=l[1].data.slice(2,-1);if(me)return me}}catch(a){this.debug("error parsing p2pk pubkey",a,this.proofs[0])}}get mint(){return this.tagValue("u")}set mint(n){this.removeTag("u"),this.tag(["u",n])}get unit(){return this.tagValue("unit")??"msat"}set unit(n){this.removeTag("unit"),n&&this.tag(["unit",n])}get amount(){return this.proofs.reduce((s,a)=>s+a.amount,0)*1e3}set target(n){this.tags=this.tags.filter(s=>s[0]!=="p"),n instanceof NDKEvent&&this.tags.push()}set recipientPubkey(n){this.removeTag("p"),this.tag(["p",n])}get recipientPubkey(){return this.tagValue("p")}get recipient(){const n=this.recipientPubkey;return this.ndk?this.ndk.getUser({pubkey:n}):new NDKUser({pubkey:n})}get isValid(){let n=0,s=0;for(const a of this.tags)a[0]==="p"&&n++,a[0]==="u"&&s++;return n===1&&s===1&&this.proofs.length>0}},bt(Xt,"kind",9321),bt(Xt,"kinds",[Xt.kind]),Xt);async function payInvoice(e){return await this.sendReq("pay_invoice",{invoice:e})}var NDKPrivateKeySigner=class on{constructor(t){bt(this,"_user");bt(this,"_privateKey");if(t){if(typeof t=="string")if(t.startsWith("nsec1")){const{type:n,data:s}=nip19_exports.decode(t);n==="nsec"&&(this._privateKey=s)}else if(t.length===64)this._privateKey=hexToBytes$3(t);else throw new Error("Invalid private key provided.");else this._privateKey=t;this._privateKey&&(this._user=new NDKUser({pubkey:getPublicKey(this._privateKey)}))}}get privateKey(){if(this._privateKey)return bytesToHex$3(this._privateKey)}static generate(){const t=generateSecretKey();return new on(t)}async blockUntilReady(){if(!this._user)throw new Error("NDKUser not initialized");return this._user}async user(){return await this.blockUntilReady(),this._user}async sign(t){if(!this._privateKey)throw Error("Attempted to sign without a private key");return finalizeEvent(t,this._privateKey).sig}async encrypt(t,n){if(!this._privateKey)throw Error("Attempted to encrypt without a private key");const s=t.pubkey;return await nip04_exports.encrypt(this._privateKey,s,n)}async decrypt(t,n){if(!this._privateKey)throw Error("Attempted to decrypt without a private key");const s=t.pubkey;return await nip04_exports.decrypt(this._privateKey,s,n)}};async function sendReq(e,t){const n=new NDKEvent(this.ndk,{kind:23194,tags:[["p",this.walletService.pubkey]],content:JSON.stringify({method:e,params:t})});return this.debug("Sending request",n.content),await n.encrypt(this.walletService,this.signer),await n.sign(this.signer),this.debug("Request encrypted and signed"),new Promise(async(s,a)=>{try{const l=n.tagId();if(!l)throw new Error("Failed to get e-tag");const de=me=>{this.off(l,de),this.off("event",de),this.debug("Received response",me);try{const Be=JSON.parse(me);Be.error&&a(Be),s(Be)}catch(Be){this.debug("Failed to parse response",Be),a({result_type:"error",error:{code:"failed_to_parse_response",message:Be.message}})}},pe=this.ndk.subscribe({kinds:[23195],"#e":[l],limit:1},{groupable:!1,subId:`nwc-${e}`},this.relaySet);pe.on("event",async me=>{await me.decrypt(me.author,this.signer),de(me.content),pe.stop()}),this.once(l,de),this.once("event",de),this.debug("Sending request to relay",n.rawEvent()),await n.publish(this.relaySet)}catch(l){this.debug("Failed to send request",l,l.relayErrors),a({result_type:"error",error:{code:"failed_to_send_request",message:l.message}})}})}async function getBalance(){return await this.sendReq("get_balance",{})}async function getInfo(){return await this.sendReq("get_info",{})}var NDKNwc=class an extends lib$1.EventEmitter{constructor({ndk:n,pubkey:s,relayUrls:a,secret:l}){super();bt(this,"ndk");bt(this,"debug");bt(this,"walletService");bt(this,"relaySet");bt(this,"signer");bt(this,"active",!1);bt(this,"getBalance",getBalance.bind(this));this.ndk=n,this.walletService=n.getUser({pubkey:s}),this.relaySet=new NDKRelaySet(new Set(a.map(de=>n.pool.getRelay(de))),n),this.signer=new NDKPrivateKeySigner(l instanceof Uint8Array?l:hexToBytes$3(l)),this.debug=n.debug.extend("nwc"),this.debug(`Starting with wallet service ${this.walletService.npub}`)}static async fromURI(n,s){const a=new URL(s);if(a.protocol!=="nostr+walletconnect:")throw new Error("Invalid protocol");return new an({ndk:n,pubkey:a.host??a.pathname,relayUrls:a.searchParams.getAll("relay")??[""],secret:a.searchParams.get("secret")??""})}async blockUntilReady(n){const s=await this.signer.user(),a=new Promise((pe,me)=>{setTimeout(()=>{me(new Error("Timeout"))},n)}),de=[new Promise(pe=>{const me=this.ndk.subscribe({kinds:[23195],"#p":[s.pubkey],limit:1},{groupable:!1,subId:"nwc"},this.relaySet);me.on("event",async Be=>{this.debug("received response",Be.rawEvent());const Le=Be.tagValue("e");if(!Le){this.debug("Received an event without an e-tag");return}this.debug("received an event",Le);try{await Be.decrypt(Be.author,this.signer),this.emit(Le,Be.content)}catch(Ye){this.debug("Failed to decrypt event",Ye);return}}),me.on("eose",()=>{this.debug("Subscription ready"),this.active=!0,pe()}),me.on("close",()=>{this.debug("Subscription closed"),this.active=!1})})];return n&&de.push(a),await Promise.race(de)}async sendReq(n,s){return await sendReq.call(this,n,s)}async payInvoice(n){return await payInvoice.call(this,n)}async getInfo(){return await getInfo.call(this)}};function dedup(e,t){return e.created_at>t.created_at?e:t}async function getRelayListForUser(e,t){return(await getRelayListForUsers([e],t)).get(e)}async function getRelayListForUsers(e,t,n=!1){var Le;const s=t.outboxPool||t.pool,a=new Set;for(const Ye of s.relays.values())a.add(Ye);const l=new Map,de=new Map,pe=new NDKRelaySet(a,t);if((Le=t.cacheAdapter)!=null&&Le.locking&&!n){const Ye=await t.fetchEvents({kinds:[3,10002],authors:e},{cacheUsage:"ONLY_CACHE"});for(const tt of Ye)tt.kind===10002&&l.set(tt.pubkey,NDKRelayList.from(tt));for(const tt of Ye)if(tt.kind===3){if(l.has(tt.pubkey))continue;const ot=relayListFromKind3(t,tt);ot&&de.set(tt.pubkey,ot)}e=e.filter(tt=>!l.has(tt)&&!de.has(tt))}if(e.length===0)return l;const me=new Map,Be=new Map;return new Promise(async Ye=>{const tt=t.subscribe({kinds:[3,10002],authors:e},{closeOnEose:!0,pool:s,groupable:!0,cacheUsage:"ONLY_RELAY",subId:"ndk-relay-list-fetch"},pe,!1);tt.on("event",ot=>{if(ot.kind===10002){const yt=me.get(ot.pubkey);if(yt&&yt.created_at>ot.created_at)return;me.set(ot.pubkey,ot)}else if(ot.kind===3){const yt=Be.get(ot.pubkey);if(yt&&yt.created_at>ot.created_at)return;Be.set(ot.pubkey,ot)}}),tt.on("eose",()=>{for(const ot of me.values())l.set(ot.pubkey,NDKRelayList.from(ot));for(const ot of e){if(l.has(ot))continue;const yt=Be.get(ot);if(!yt)continue;const nt=relayListFromKind3(t,yt);nt&&l.set(ot,nt)}Ye(l)}),tt.start()})}var OutboxItem=class{constructor(e){bt(this,"type");bt(this,"relayUrlScores");bt(this,"readRelays");bt(this,"writeRelays");this.type=e,this.relayUrlScores=new Map,this.readRelays=new Set,this.writeRelays=new Set}},OutboxTracker=class extends lib$1.EventEmitter{constructor(t){super();bt(this,"data");bt(this,"ndk");bt(this,"debug");this.ndk=t,this.debug=t.debug.extend("outbox-tracker"),this.data=new dist.LRUCache({maxSize:1e5,entryExpirationTimeInMS:2*60*1e3})}async trackUsers(t,n=!1){const s=[];for(let a=0;a<t.length;a+=400){const de=t.slice(a,a+400).map(pe=>getKeyFromItem(pe)).filter(pe=>!this.data.has(pe));if(de.length!==0){for(const pe of de)this.data.set(pe,new OutboxItem("user"));s.push(new Promise(pe=>{getRelayListForUsers(de,this.ndk,n).then(me=>{for(const[Be,Le]of me){let Ye=this.data.get(Be);if(Ye??(Ye=new OutboxItem("user")),Le){Ye.readRelays=new Set(normalize(Le.readRelayUrls)),Ye.writeRelays=new Set(normalize(Le.writeRelayUrls));for(const tt of Ye.readRelays)this.ndk.pool.blacklistRelayUrls.has(tt)&&Ye.readRelays.delete(tt);for(const tt of Ye.writeRelays)this.ndk.pool.blacklistRelayUrls.has(tt)&&Ye.writeRelays.delete(tt);this.data.set(Be,Ye)}}}).finally(pe)}))}}return Promise.all(s)}track(t,n,s=!0){const a=getKeyFromItem(t);n??(n=getTypeFromItem(t));let l=this.data.get(a);return l||(l=new OutboxItem(n),t instanceof NDKUser&&this.trackUsers([t])),l}};function getKeyFromItem(e){return e instanceof NDKUser?e.pubkey:e}function getTypeFromItem(e){return e instanceof NDKUser?"user":"kind"}var NDKPool=class extends lib$1.EventEmitter{constructor(t=[],n=[],s,a){super();bt(this,"relays",new Map);bt(this,"autoConnectRelays",new Set);bt(this,"blacklistRelayUrls");bt(this,"debug");bt(this,"temporaryRelayTimers",new Map);bt(this,"flappingRelays",new Set);bt(this,"backoffTimes",new Map);bt(this,"ndk");this.debug=a??s.debug.extend("pool"),this.ndk=s;for(const l of t){const de=new NDKRelay(l,void 0,this.ndk);this.addRelay(de,!1)}this.blacklistRelayUrls=new Set(n)}set name(t){this.debug=this.debug.extend(t)}useTemporaryRelay(t,n=3e4,s){const a=this.relays.has(t.url);a||(this.addRelay(t),this.debug("Adding temporary relay %s for filters %o",t.url,s));const l=this.temporaryRelayTimers.get(t.url);if(l&&clearTimeout(l),!a||l){const de=setTimeout(()=>{var pe;(pe=this.ndk.explicitRelayUrls)!=null&&pe.includes(t.url)||this.removeRelay(t.url)},n);this.temporaryRelayTimers.set(t.url,de)}}addRelay(t,n=!0){var nt,st;const s=this.relays.has(t.url),a=(nt=this.blacklistRelayUrls)==null?void 0:nt.has(t.url),l=t.url.includes("/npub1");let de=!0;const pe=t.url;if(s)return;if(a){this.debug(`Refusing to add relay ${pe}: blacklisted`);return}if(l){this.debug(`Refusing to add relay ${pe}: is a filter relay`);return}if((st=this.ndk.cacheAdapter)!=null&&st.getRelayStatus){const gt=this.ndk.cacheAdapter.getRelayStatus(pe);if(gt&&gt.dontConnectBefore)if(gt.dontConnectBefore>Date.now()){const wt=gt.dontConnectBefore-Date.now();this.debug(`Refusing to add relay ${pe}: delayed connect for ${wt}ms`),setTimeout(()=>{this.addRelay(t,n)},wt);return}else de=!1}const me=gt=>this.emit("notice",t,gt),Be=()=>this.handleRelayConnect(pe),Le=()=>this.handleRelayReady(t),Ye=()=>this.emit("relay:disconnect",t),tt=()=>this.handleFlapping(t),ot=gt=>this.emit("relay:auth",t,gt),yt=()=>this.emit("relay:authed",t);t.off("notice",me),t.off("connect",Be),t.off("ready",Le),t.off("disconnect",Ye),t.off("flapping",tt),t.off("auth",ot),t.off("authed",yt),t.on("notice",me),t.on("connect",Be),t.on("ready",Le),t.on("disconnect",Ye),t.on("flapping",tt),t.on("auth",ot),t.on("authed",yt),t.on("delayed-connect",gt=>{var wt;(wt=this.ndk.cacheAdapter)!=null&&wt.updateRelayStatus&&this.ndk.cacheAdapter.updateRelayStatus(t.url,{dontConnectBefore:Date.now()+gt})}),this.relays.set(pe,t),n&&this.autoConnectRelays.add(pe),n&&(this.emit("relay:connecting",t),t.connect(void 0,de).catch(gt=>{this.debug(`Failed to connect to relay ${pe}`,gt)}))}removeRelay(t){const n=this.relays.get(t);if(n)return n.disconnect(),this.relays.delete(t),this.autoConnectRelays.delete(t),this.emit("relay:disconnect",n),!0;const s=this.temporaryRelayTimers.get(t);return s&&(clearTimeout(s),this.temporaryRelayTimers.delete(t)),!1}isRelayConnected(t){const n=normalizeRelayUrl(t),s=this.relays.get(n);return s?s.status===5:!1}getRelay(t,n=!0,s=!1,a){let l=this.relays.get(normalizeRelayUrl(t));return l||(l=new NDKRelay(t,void 0,this.ndk),s?this.useTemporaryRelay(l,3e4,a):this.addRelay(l,n)),l}handleRelayConnect(t){this.emit("relay:connect",this.relays.get(t)),this.stats().connected===this.relays.size&&this.emit("connect")}handleRelayReady(t){this.emit("relay:ready",t)}async connect(t){var a;const n=[];this.debug(`Connecting to ${this.relays.size} relays${t?`, timeout ${t}...`:""}`);const s=new Set(this.autoConnectRelays.keys());(a=this.ndk.explicitRelayUrls)==null||a.forEach(l=>{const de=normalizeRelayUrl(l);s.add(de)});for(const l of s){const de=this.relays.get(l);if(!de)continue;const pe=new Promise((me,Be)=>(this.emit("relay:connecting",de),de.connect(t).then(me).catch(Be)));if(t){const me=new Promise((Be,Le)=>{setTimeout(()=>Le(`Timed out after ${t}ms`),t)});n.push(Promise.race([pe,me]).catch(Be=>{this.debug(`Failed to connect to relay ${de.url}: ${Be??"No reason specified"}`)}))}else n.push(pe)}t&&setTimeout(()=>{const l=this.stats().connected===this.relays.size,de=this.stats().connected>0;!l&&de&&this.emit("connect")},t),await Promise.all(n)}checkOnFlappingRelays(){const t=this.flappingRelays.size,n=this.relays.size;if(t/n>=.8)for(const s of this.flappingRelays)this.backoffTimes.set(s,0)}handleFlapping(t){this.debug(`Relay ${t.url} is flapping`);let n=this.backoffTimes.get(t.url)||5e3;n=n*2,this.backoffTimes.set(t.url,n),this.debug(`Backoff time for ${t.url} is ${n}ms`),setTimeout(()=>{this.debug(`Attempting to reconnect to ${t.url}`),this.emit("relay:connecting",t),t.connect(),this.checkOnFlappingRelays()},n),t.disconnect(),this.emit("flapping",t)}size(){return this.relays.size}stats(){const t={total:0,connected:0,disconnected:0,connecting:0};for(const n of this.relays.values())t.total++,n.status===5?t.connected++:n.status===1?t.disconnected++:n.status===4&&t.connecting++;return t}connectedRelays(){return Array.from(this.relays.values()).filter(t=>t.status===5)}permanentAndConnectedRelays(){return Array.from(this.relays.values()).filter(t=>t.status>=5&&!this.temporaryRelayTimers.has(t.url))}urls(){return Array.from(this.relays.keys())}};function correctRelaySet(e,t){const n=t.connectedRelays();if(!Array.from(e.relays).some(a=>n.map(l=>l.url).includes(a.url)))for(const a of n)e.addRelay(a);if(n.length===0)for(const a of t.relays.values())e.addRelay(a);return e}function isValidHint(e){if(!e||e==="")return!1;try{return new URL(e),!0}catch{return!1}}async function fetchEventFromTag(e,t,n,s={type:"timeout"}){const a=this.debug.extend("fetch-event-from-tag"),[l,de,pe]=e;n={},a("fetching event from tag",e,n,s);const me=getRelaysForSync(this,t.pubkey);if(me&&me.size>0){a("fetching event from author relays %o",Array.from(me));const nt=NDKRelaySet.fromRelayUrls(Array.from(me),this),st=await this.fetchEvent(de,n,nt);if(st)return st}else a("no author relays found for %s",t.pubkey,t);const Be=calculateRelaySetsFromFilters(this,[{ids:[de]}],this.pool);a("fetching event without relay hint",Be);const Le=await this.fetchEvent(de,n);if(Le)return Le;if(pe&&pe!==""){const nt=await this.fetchEvent(de,n,this.pool.getRelay(pe,!0,!0,[{ids:[de]}]));if(nt)return nt}let Ye;const tt=isValidHint(pe)?this.pool.getRelay(pe,!1,!0,[{ids:[de]}]):void 0,ot=new Promise(nt=>{this.fetchEvent(de,n,tt).then(nt)});if(!isValidHint(pe)||s.type==="none")return ot;const yt=new Promise(async nt=>{const st=s.relaySet,gt=s.timeout??1500,wt=new Promise(vt=>setTimeout(vt,gt));if(s.type==="timeout"&&await wt,Ye)nt(Ye);else{a("fallback fetch triggered");const vt=await this.fetchEvent(de,n,st);nt(vt)}});switch(s.type){case"timeout":return Promise.race([ot,yt]);case"eose":return Ye=await ot,Ye||yt}}var SPEC_PATH="/.well-known/nostr/nip96.json",Nip96=class{constructor(e,t){bt(this,"ndk");bt(this,"spec");bt(this,"url");bt(this,"nip98Required",!1);this.url=`https://${e}${SPEC_PATH}`,this.ndk=t}async prepareUpload(e,t="POST"){if(this.validateHttpFetch(),this.spec||await this.fetchSpec(),!this.spec)throw new Error("Failed to fetch NIP96 spec");let n={};return this.nip98Required&&(n={Authorization:await this.generateNip98Header(this.spec.api_url,t,e)}),{url:this.spec.api_url,headers:n}}async xhrUpload(e,t){const n="POST",{url:s,headers:a}=await this.prepareUpload(t,n);e.open(n,s,!0),a.Authorization&&e.setRequestHeader("Authorization",a.Authorization);const l=new FormData;return l.append("file",t),new Promise((de,pe)=>{e.onload=function(){e.status>=200&&e.status<300?de(JSON.parse(e.responseText)):pe(new Error(e.statusText))},e.onerror=function(){pe(new Error("Network Error"))},e.send(l)})}async upload(e){const t="POST",{url:n,headers:s}=await this.prepareUpload(e,t),a=new FormData;a.append("file",e);const l=await this.ndk.httpFetch(this.spec.api_url,{method:t,headers:s,body:a});if(l.status!==200)throw new Error(`Failed to upload file to ${n}`);const de=await l.json();if(de.status!=="success")throw new Error(de.message);return de}validateHttpFetch(){if(!this.ndk)throw new Error("NDK is required to fetch NIP96 spec");if(!this.ndk.httpFetch)throw new Error("NDK must have an httpFetch method to fetch NIP96 spec")}async fetchSpec(){this.validateHttpFetch();const e=await this.ndk.httpFetch(this.url);if(e.status!==200)throw new Error(`Failed to fetch NIP96 spec from ${this.url}`);const t=await e.json();if(!t)throw new Error(`Failed to parse NIP96 spec from ${this.url}`);this.spec=t,this.nip98Required=this.spec.plans.free.is_nip98_required}async generateNip98Header(e,t,n){const s=new NDKEvent(this.ndk,{kind:27235,tags:[["u",e],["method",t]]});if(["POST","PUT","PATCH"].includes(t)){const l=await this.calculateSha256(n);s.tags.push(["payload",l])}return await s.sign(),`Nostr ${btoa(JSON.stringify(s.rawEvent()))}`}async calculateSha256(e){const t=await e.arrayBuffer(),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map(l=>l.toString(16).padStart(2,"0")).join("")}},Queue=class{constructor(e,t){bt(this,"queue",[]);bt(this,"maxConcurrency");bt(this,"processing",new Set);bt(this,"promises",new Map);this.maxConcurrency=t}add(e){if(this.promises.has(e.id))return this.promises.get(e.id);const t=new Promise((n,s)=>{this.queue.push({...e,func:()=>e.func().then(a=>(n(a),a),a=>{throw s(a),a})}),this.process()});return this.promises.set(e.id,t),t.finally(()=>{this.promises.delete(e.id),this.processing.delete(e.id),this.process()}),t}process(){if(this.processing.size>=this.maxConcurrency||this.queue.length===0)return;const e=this.queue.shift();!e||this.processing.has(e.id)||(this.processing.add(e.id),e.func())}clear(){this.queue=[]}clearProcessing(){this.processing.clear()}clearAll(){this.clear(),this.clearProcessing()}length(){return this.queue.length}},NDKSubscriptionManager=class{constructor(e){bt(this,"subscriptions");bt(this,"seenEvents",new Map);bt(this,"debug");this.subscriptions=new Map,this.debug=e.extend("sub-manager")}add(e){this.subscriptions.set(e.internalId,e),e.on("close",()=>{this.subscriptions.delete(e.internalId)})}seenEvent(e,t){const n=this.seenEvents.get(e)||[];n.push(t),this.seenEvents.set(e,n)}},debug6=debug7("ndk:active-user");async function getUserRelayList(e){if(!this.autoConnectUserRelays)return;const t=await getRelayListForUser(e.pubkey,this);if(t){for(const n of t.relays){let s=this.pool.relays.get(n);s||(s=new NDKRelay(n,this.relayAuthDefaultPolicy,this),this.pool.addRelay(s))}return t}}async function setActiveUser(e){const t=this.outboxPool||this.pool;t.connectedRelays.length>0?setActiveUserConnected.call(this,e):t.once("connect",()=>{setActiveUserConnected.call(this,e)})}async function setActiveUserConnected(e){const t=await getUserRelayList.call(this,e),n=[{kinds:[10006],authors:[e.pubkey]}];this.autoFetchUserMutelist&&n[0].kinds.push(1e4);const s=t?t.relaySet:void 0,a=this.subscribe(n,{subId:"active-user-settings",closeOnEose:!0},s,!1),l=new Map;a.on("event",de=>{const pe=l.get(de.kind);pe&&pe.created_at>=de.created_at||l.set(de.kind,de)}),a.on("eose",()=>{for(const de of l.values())processEvent.call(this,de)}),a.start()}async function processEvent(e){e.kind===10006?processBlockRelayList.call(this,e):e.kind===1e4&&processMuteList.call(this,e)}function processBlockRelayList(e){const t=lists_default.from(e);for(const n of t.items)this.pool.blacklistRelayUrls.add(n[0]);debug6("Added %d relays to relay blacklist",t.items.length)}function processMuteList(e){const t=lists_default.from(e);for(const n of t.items)this.mutedIds.set(n[1],n[0]);debug6("Added %d users to mute list",t.items.length)}async function generateZapRequest(e,t,n,s,a,l,de,pe,me){const Be=n.callback,Le=nip57_exports.makeZapRequest({profile:s,event:null,amount:a,comment:de||"",relays:l.slice(0,4)});if(e instanceof NDKEvent){const ot=e.referenceTags().filter(yt=>yt[0]!=="p");Le.tags.push(...ot)}Le.tags.push(["lnurl",Be]);const Ye=new NDKEvent(t,Le);return pe&&(Ye.tags=Ye.tags.concat(pe)),Ye.tags=Ye.tags.filter(tt=>tt[0]!=="p"),Ye.tags.push(["p",s]),await Ye.sign(me),Ye}var d3=debug7("ndk:zapper"),NDKZapper=class extends lib$1.EventEmitter{constructor(t,n,s="msat",a,l,de,pe){super();bt(this,"target");bt(this,"ndk");bt(this,"comment");bt(this,"amount");bt(this,"unit");bt(this,"tags");bt(this,"signer");bt(this,"zapMethod");bt(this,"onLnPay");bt(this,"onCashuPay");bt(this,"onComplete");bt(this,"maxRelays",3);if(this.target=t,this.ndk=l||t.ndk,!this.ndk)throw new Error("No NDK instance provided");this.amount=n,this.comment=a,this.unit=s,this.tags=de,this.signer=pe}async zap(){const t=this.getZapSplits(),n=new Map;return await Promise.all(t.map(async s=>{let a;try{a=await this.zapSplit(s)}catch(l){a=l}this.emit("split:complete",s,a),n.set(s,a)})),this.emit("complete",n),this.onComplete&&this.onComplete(n),n}async zapSplit(t){let n=await this.getZapMethods(this.ndk,t.pubkey),s;if(n.length===0)throw new Error("No zap method available for recipient");n=n.sort((l,de)=>l.type==="nip61"?-1:de.type==="nip61"?1:0);const a=await this.relays(t.pubkey);for(const l of n){d3("Zapping to %s with %d %s using %s",t.pubkey,t.amount,this.unit,l.type);try{switch(l.type){case"nip61":{const de=l.data;let pe;if(pe=await this.onCashuPay({target:this.target,comment:this.comment,tags:this.tags,recipientPubkey:t.pubkey,amount:t.amount,unit:this.unit,...de}),d3("NIP-61 Zap result: %o",pe),pe instanceof Error)s=pe;else if(pe){const{proofs:me,mint:Be}=pe;if(!me||!Be)throw new Error("Invalid zap confirmation: missing proofs or mint: "+pe);const Le=NDKRelaySet.fromRelayUrls(a,this.ndk),Ye=new NDKNutzap(this.ndk);return Ye.tags=[...Ye.tags,...this.tags||[]],Ye.proofs=me,Ye.mint=Be,Ye.comment=this.comment,Ye.unit=this.unit,Ye.recipientPubkey=t.pubkey,await Ye.sign(this.signer),await Ye.publish(Le),Ye}break}case"nip57":{const de=l.data,pe=await generateZapRequest(this.target,this.ndk,de,t.pubkey,t.amount,a,this.comment,this.tags,this.signer);if(!pe)throw d3("Unable to generate zap request"),new Error("Unable to generate zap request");const me=await this.getLnInvoice(pe,t.amount,de);if(!me)throw d3("Unable to get payment request"),new Error("Unable to get payment request");s=await this.onLnPay({target:this.target,comment:this.comment,recipientPubkey:t.pubkey,amount:t.amount,unit:this.unit,pr:me});break}}}catch(de){de instanceof Error?s=de:s=new Error(de),d3("Error zapping to %s with %d %s using %s: %o",t.pubkey,t.amount,this.unit,l.type,de)}}if(s instanceof Error)throw s;return s}async getLnInvoice(t,n,s){const a=s.callback,l=JSON.stringify(t.rawEvent());d3(`Fetching invoice from ${a}?`+new URLSearchParams({amount:n.toString(),nostr:l}));const de=new URL(a);de.searchParams.append("amount",n.toString()),de.searchParams.append("nostr",l),d3(`Fetching invoice from ${de.toString()}`);const pe=await fetch(de.toString());if(d3(`Got response from zap endpoint: ${a}`,{status:pe.status}),pe.status!==200){d3(`Received non-200 status from zap endpoint: ${a}`,{status:pe.status,amount:n,nostr:l});const Be=await pe.text();throw new Error(`Unable to fetch zap endpoint ${a}: ${Be}`)}return(await pe.json()).pr}getZapSplits(){if(this.target instanceof NDKUser)return[{pubkey:this.target.pubkey,amount:this.amount}];const t=this.target.getMatchingTags("zap");if(t.length===0)return[{pubkey:this.target.pubkey,amount:this.amount}];const n=[],s=t.reduce((a,l)=>a+parseInt(l[2]),0);for(const a of t){const l=a[1],de=Math.floor(parseInt(a[2])/s*this.amount);n.push({pubkey:l,amount:de})}return n}async getZapMethods(t,n){const s=[];this.onCashuPay&&s.push("nip61"),s.push("nip57");const a=t.getUser({pubkey:n}),l=await a.getZapInfo(!1,s);return d3("Zap info for %s: %o",a.npub,l),l}async relays(t){var s,a,l;let n=[];if((s=this.ndk)!=null&&s.activeUser){const de=await getRelayListForUsers([this.ndk.activeUser.pubkey,t],this.ndk),pe=new Map;for(const me of de.values())for(const Be of me.readRelayUrls){const Le=pe.get(Be)||0;pe.set(Be,Le+1)}n=Array.from(pe.entries()).sort((me,Be)=>Be[1]-me[1]).map(([me])=>me).slice(0,this.maxRelays)}return(l=(a=this.ndk)==null?void 0:a.pool)!=null&&l.permanentAndConnectedRelays().length&&(n=this.ndk.pool.permanentAndConnectedRelays().map(de=>de.url)),n.length||(n=[]),n}},DEFAULT_OUTBOX_RELAYS=["wss://purplepag.es/","wss://nos.lol/"],DEFAULT_BLACKLISTED_RELAYS=["wss://brb.io/","wss://nostr.mutinywallet.com/"],NDK=class extends lib$1.EventEmitter{constructor(t={}){super();bt(this,"explicitRelayUrls");bt(this,"pool");bt(this,"outboxPool");bt(this,"_signer");bt(this,"_activeUser");bt(this,"cacheAdapter");bt(this,"debug");bt(this,"devWriteRelaySet");bt(this,"outboxTracker");bt(this,"mutedIds");bt(this,"clientName");bt(this,"clientNip89");bt(this,"queuesZapConfig");bt(this,"queuesNip05");bt(this,"asyncSigVerification",!1);bt(this,"initialValidationRatio",1);bt(this,"lowestValidationRatio",1);bt(this,"validationRatioFn");bt(this,"subManager");bt(this,"publishingFailureHandled",!1);bt(this,"relayAuthDefaultPolicy");bt(this,"httpFetch");bt(this,"autoConnectUserRelays",!0);bt(this,"autoFetchUserMutelist",!0);bt(this,"walletConfig");bt(this,"fetchEventFromTag",fetchEventFromTag.bind(this));this.debug=t.debug||debug7("ndk"),this.explicitRelayUrls=t.explicitRelayUrls||[],this.subManager=new NDKSubscriptionManager(this.debug),this.pool=new NDKPool(t.explicitRelayUrls||[],t.blacklistRelayUrls||DEFAULT_BLACKLISTED_RELAYS,this),this.pool.name="main",this.pool.on("relay:auth",async(n,s)=>{this.relayAuthDefaultPolicy&&await this.relayAuthDefaultPolicy(n,s)}),this.autoConnectUserRelays=t.autoConnectUserRelays??!0,this.autoFetchUserMutelist=t.autoFetchUserMutelist??!0,this.clientName=t.clientName,this.clientNip89=t.clientNip89,this.relayAuthDefaultPolicy=t.relayAuthDefaultPolicy,t.enableOutboxModel&&(this.outboxPool=new NDKPool(t.outboxRelayUrls||DEFAULT_OUTBOX_RELAYS,t.blacklistRelayUrls||DEFAULT_BLACKLISTED_RELAYS,this,this.debug.extend("outbox-pool")),this.outboxPool.name="outbox",this.outboxTracker=new OutboxTracker(this)),this.signer=t.signer,this.cacheAdapter=t.cacheAdapter,this.mutedIds=t.mutedIds||new Map,t.devWriteRelayUrls&&(this.devWriteRelaySet=NDKRelaySet.fromRelayUrls(t.devWriteRelayUrls,this)),this.queuesZapConfig=new Queue("zaps",3),this.queuesNip05=new Queue("nip05",10),this.signatureVerificationWorker=t.signatureVerificationWorker,this.initialValidationRatio=t.initialValidationRatio||1,this.lowestValidationRatio=t.lowestValidationRatio||1;try{this.httpFetch=fetch}catch{}}set signatureVerificationWorker(t){this.asyncSigVerification=!!t,t&&signatureVerificationInit(t)}addExplicitRelay(t,n,s=!0){let a;return typeof t=="string"?a=new NDKRelay(t,n,this):a=t,this.pool.addRelay(a,s),this.explicitRelayUrls.push(a.url),a}toJSON(){return{relayCount:this.pool.relays.size}.toString()}get activeUser(){return this._activeUser}set activeUser(t){var s;const n=((s=this._activeUser)==null?void 0:s.pubkey)!==(t==null?void 0:t.pubkey);this._activeUser=t,t&&n?setActiveUser.call(this,t):t||(this.mutedIds=new Map)}get signer(){return this._signer}set signer(t){this._signer=t,t&&this.emit("signer:ready",t),t==null||t.user().then(n=>{n.ndk=this,this.activeUser=n})}async connect(t){var s,a;this._signer&&this.autoConnectUserRelays&&(this.debug("Attempting to connect to user relays specified by signer %o",await((a=(s=this._signer).relays)==null?void 0:a.call(s,this))),this._signer.relays&&(await this._signer.relays(this)).forEach(de=>this.pool.addRelay(de)));const n=[this.pool.connect(t)];return this.outboxPool&&n.push(this.outboxPool.connect(t)),this.debug("Connecting to relays %o",{timeoutMs:t}),Promise.allSettled(n).then(()=>{})}getUser(t){const n=new NDKUser(t);return n.ndk=this,n}async getUserFromNip05(t,n=!1){return NDKUser.fromNip05(t,this,n)}subscribe(t,n,s,a=!0){var de;const l=new NDKSubscription(this,t,n,s);if(this.subManager.add(l),s)for(const pe of s.relays)this.pool.useTemporaryRelay(pe,void 0,l.filters);if(this.outboxPool&&l.hasAuthorsFilter()){const pe=l.filters.filter(me=>{var Be;return me.authors&&((Be=me.authors)==null?void 0:Be.length)>0}).map(me=>me.authors).flat();(de=this.outboxTracker)==null||de.trackUsers(pe)}return a&&setTimeout(()=>l.start(),0),l}async publish(t,n,s){return this.debug("Deprecated: Use `event.publish()` instead"),t.publish(n,s)}async fetchEvent(t,n,s){let a,l;if(s instanceof NDKRelay?l=new NDKRelaySet(new Set([s]),this):s instanceof NDKRelaySet&&(l=s),!s&&typeof t=="string"&&!isNip33AValue(t)){const de=relaysFromBech32(t,this);de.length>0&&(l=new NDKRelaySet(new Set(de),this),l=correctRelaySet(l,this.pool))}if(typeof t=="string"?a=[filterFromId(t)]:Array.isArray(t)?a=t:a=[t],a.length===0)throw new Error(`Invalid filter: ${JSON.stringify(t)}`);return new Promise(de=>{let pe=null;const me=this.subscribe(a,{...n||{},closeOnEose:!0},l,!1),Be=setTimeout(()=>{me.stop(),de(pe)},1e4);me.on("event",Le=>{Le.ndk=this,Le.isReplaceable()?(!pe||pe.created_at<Le.created_at)&&(pe=Le):(clearTimeout(Be),de(Le))}),me.on("eose",()=>{clearTimeout(Be),de(pe)}),me.start()})}async fetchEvents(t,n,s){return new Promise(a=>{const l=new Map,de=this.subscribe(t,{...n||{},closeOnEose:!0},s,!1),pe=me=>{me instanceof NDKEvent||(me=new NDKEvent(void 0,me));const Be=me.deduplicationKey(),Le=l.get(Be);Le&&(me=dedup(Le,me)),me.ndk=this,l.set(Be,me)};de.on("event",pe),de.on("eose",()=>{a(new Set(l.values()))}),de.start()})}assertSigner(){if(!this.signer)throw this.emit("signer:required"),new Error("Signer required")}getNip96(t){return new Nip96(t,this)}async nwc(t,n=2e3){const s=await NDKNwc.fromURI(this,t);return n!==!1&&await s.blockUntilReady(n),s}zap(t,n,{comment:s,unit:a,signer:l,tags:de,onLnPay:pe,onCashuPay:me,onComplete:Be}){var Ye,tt,ot;l||this.assertSigner();const Le=new NDKZapper(t,n,a,s,this,de,l);return pe!==!1&&(Le.onLnPay=pe??((Ye=this.walletConfig)==null?void 0:Ye.onLnPay)),me!==!1&&(Le.onCashuPay=me??((tt=this.walletConfig)==null?void 0:tt.onCashuPay)),Le.onComplete=Be??((ot=this.walletConfig)==null?void 0:ot.onPaymentComplete),pe&&Le.zap(),Le}};async function parseText(e){const t=new NDK({explicitRelayUrls:["wss://relay.damus.io","wss://nostr.wine","wss://relay.nostr.net","wss://nos.lol","wss://nostr-pub.wellorder.net","wss://njump.me","wss://relay.primal.net"]});await t.connect();let n=e;const s=n.matchAll(new RegExp(nip21_exports.NOSTR_URI_REGEX,"g"));for(let me of s){const Le=nip21_exports.parse(me[0]).decoded.data;let Ye="";typeof Le=="string"?Ye=Le:Ye=Le.pubkey;const tt=await t.getUser({pubkey:Ye}).fetchProfile(),ot=(tt==null?void 0:tt.displayName)||(tt==null?void 0:tt.name)||"";n=n.replace(me[0],`<a>@${ot}</a>`)}const a=/(^|\s)(#[a-z\d-]+)/ig;n=n.replace(a,"$1<a>$2</a>");const l=/(https:\/\/(?!njump\.me)[\w.-]+(?:\.[\w.-]+)+(?:\/[^\s]*)?)/g,de=n.match(l),pe=[];if(de){let me=0;for(const Be of de){const Le=n.indexOf(Be,me),Ye=Le+Be.length;Le>me&&pe.push({type:"text",value:n.substring(me,Le)});const tt=new URL(Be);let ot;tt.pathname.endsWith(".jpg")||tt.pathname.endsWith(".jpeg")||tt.pathname.endsWith(".png")?ot="image":tt.pathname.endsWith(".gif")?ot="gif":tt.pathname.endsWith(".mp4")||tt.pathname.endsWith(".mov")||tt.pathname.endsWith(".webm")?ot="video":ot="link",pe.push({type:ot,value:Be}),me=Ye}me<n.length&&pe.push({type:"text",value:n.substring(me)})}else pe.push({type:"text",value:n});return pe}function getHTML(e){const t=[];let n=0,s="";for(const l of e)if(l.type==="text")s+=l.value;else switch(s&&(t.push(`<span class="text-content">${s.replace(/\n/g,"<br />")}</span>`),s=""),l.type){case"image":t.push(`<img style="border-radius: 12px" width="100%" src="${proxyImg(l.value,defaultImgProxy)}" alt="Image embeded in the nostr note">`),n++;break;case"gif":t.push(`<img style="border-radius: 12px" width="100%" src="${proxyImg(l.value,defaultImgProxy)}" alt="GIF embeded in the nostr note">`),n++;break;case"video":t.push(`<video style="border-radius: 12px" width="100%" src="${l.value}" alt="video embeded in the nostr note"></video>`),n++;break;case"link":t.push(`<a href="${l.value}">${l.value}</a>`);break}if(s&&t.push(`<span class="text-content">${s.replace(/\n/g,"<br />")}</span>`),n>1)for(let l=0;l<t.length;l++){const de=t[l];(de.startsWith("<img")||de.startsWith("<video"))&&(t.splice(l,1),l--)}return`
    <style>
      a {
        color: #ca077c;
      }
    </style>
  `+t.join("")}function getNip19Bech32RegexMatch(e){return e.match(nip19_exports.BECH32_REGEX)}function validateAndGetMatchedNostrEventBech32(e){if(!e)return!1;let t="";if(e.startsWith("http")||e.startsWith("https")){const n=e.split("/");for(let s=0;s<n.length;s++){const a=n[s],l=getNip19Bech32RegexMatch(a);l!==null&&(t=l[0])}}else if(e.startsWith("nostr:")){const n=e.substring(6),s=getNip19Bech32RegexMatch(n);s!==null&&(t=s[0])}else{const n=getNip19Bech32RegexMatch(e);n!==null&&(t=n[0])}if(t==="")return!1;try{const n=nip19_exports.decode(t);return n.type==="nevent"||n.type==="note"?t:!1}catch{return!1}}async function getPostDetails(e,t){const n=await e.fetchEvent(t),s=await(n==null?void 0:n.author.fetchProfile()),a=await getPostStats(e,(n==null?void 0:n.id)||"");return{post:n,author:s,stats:a}}async function getPostStats(e,t){const n=await e.fetchEvents({kinds:[NDKKind.Repost],"#e":[t||""]}),s=Array.from(n).filter(Be=>Be.tags.filter(Ye=>Ye[0]==="p").length===1).length,a=await e.fetchEvents({kinds:[NDKKind.Reaction],"#e":[t||""]}),l=await e.fetchEvents({kinds:[NDKKind.Zap],"#e":[t||""]}),de=Array.from(l).reduce((Be,Le)=>{const Ye=Le.getMatchingTags("bolt11");if(!Ye||!Array.isArray(Ye)||Ye.length===0||!Ye[0]||!Array.isArray(Ye[0])||Ye[0].length===0)return Be;const tt=Ye[0][1],yt=bolt11.decode(tt).sections.find(nt=>nt.name==="amount");if(yt){const nt=Number(yt.value);return Be+nt}return Be},0),pe=await e.fetchEvents({kinds:[NDKKind.Text],"#e":[t||""]}),me=Array.from(pe).filter(Be=>Be.tags.filter(Ye=>Ye[0]==="e").length===1).length;return{likes:a.size,reposts:s,zaps:de/MILLISATS_PER_SAT,replies:me}}function useNostrEvent(e){const[t,n]=reactExports.useState(!1),[s,a]=reactExports.useState(!1),{setNote:l}=useNoteContext(),{relays:de}=useRelaysContext();return reactExports.useEffect(()=>{async function pe(me){n(!0);try{console.log({relays:de});const Be=new NDK({explicitRelayUrls:de});await Be.connect();const{post:Le,author:Ye,stats:tt}=await getPostDetails(Be,me),{likes:ot,replies:yt,reposts:nt,zaps:st}=tt,gt=(Le==null?void 0:Le.id)||"",wt=(Le==null?void 0:Le.content)||"",vt=await parseText(wt),Rt=getHTML(vt);l({html:Rt,author:Ye,createdAt:(Le==null?void 0:Le.created_at)||0,replies:yt,zaps:st,likes:ot,reposts:nt,postId:gt}),a(!1)}catch{a(!0)}finally{n(!1)}}e&&pe(e)},[e]),{isError:s,isLoading:t}}function useShakeAnimation(e){const[t,n]=reactExports.useState(!1);function s(){n(!0),setTimeout(()=>{n(!1)},600)}return reactExports.useEffect(()=>{e&&s()},[e]),{isAnimate:t,addShakeAnimation:s}}const pressEnterToFindNote="Press Enter to find note";function useSearchInput(){const[e,t]=reactExports.useState(""),[n,s]=reactExports.useState({type:"info",message:""}),{isError:a,isLoading:l}=useNostrEvent(e),{isAnimate:de,addShakeAnimation:pe}=useShakeAnimation(a);reactExports.useEffect(()=>{s({type:"info",message:""})},[l]),reactExports.useEffect(()=>{a&&s({type:"error",message:"Something went wrong!"})},[a]);function me(yt){const nt=validateAndGetMatchedNostrEventBech32(yt);nt?t(nt):(pe(),s({type:"error",message:"Invalid note ID or invalid URL!"}))}function Be(yt){yt.preventDefault();const nt=yt.currentTarget[0].value;me(nt)}function Le(yt){setTimeout(()=>{const nt=yt.target.value;me(nt)})}function Ye(yt){yt.target.value===""?s({type:"info",message:""}):n.message!==pressEnterToFindNote&&!l&&s({type:"info",message:pressEnterToFindNote})}function tt(){n.type!=="error"&&s({type:"info",message:""})}function ot(yt){n.message===""&&yt.target.value!==""&&!l&&s({type:"info",message:pressEnterToFindNote})}return{helperMessage:n,isAnimate:de,isLoading:l,onSubmit:Be,onPaste:Le,onInputChange:Ye,onInputBlur:tt,onInputFocus:ot}}function SearchBar(){const{helperMessage:e,isLoading:t,isAnimate:n,onInputBlur:s,onInputChange:a,onInputFocus:l,onPaste:de,onSubmit:pe}=useSearchInput(),me=reactExports.useRef(null);return me.current&&t&&me.current.blur(),jsxRuntimeExports.jsxs(SearchBarWrapper,{className:n?"shake":"",children:[jsxRuntimeExports.jsxs(SearchBarContainer,{children:[jsxRuntimeExports.jsx(SearchIcon,{}),jsxRuntimeExports.jsxs(SearchBarForm,{onSubmit:pe,children:[jsxRuntimeExports.jsx(SearchInput,{type:"text",placeholder:"Paste nostr event id, primal, damus, iris or snort link here",autoComplete:"off",ref:me,onChange:a,onPaste:de,onBlur:s,onFocus:l,autoFocus:!0}),t?jsxRuntimeExports.jsx(SearchBarProgressContainer,{children:jsxRuntimeExports.jsx(SearchBarProgress,{})}):null]})]}),e.message&&e.type==="error"?jsxRuntimeExports.jsx(ErrorText,{children:e.message}):jsxRuntimeExports.jsx(HelperText,{children:e.message})]})}const HomePageHeader=dt.header`
    height: 75px;
    padding: 50px 60px 0 60px;

    display: flex;
    justify-content: space-between;
    align-items: center;

    ${tablet(`
        flex-direction: column-reverse;
        height: auto;
        padding: 20px;
    `)}
`,HeaderActions=dt.div`
    display: flex;
    align-items: center;
    gap: 12px;

    ${tablet(`
        width: 100%;
        justify-content: space-between;
    `)}
`,breakpoint$1=getBreakpoint();function Header(){return jsxRuntimeExports.jsxs(HomePageHeader,{children:[breakpoint$1==="large"?jsxRuntimeExports.jsx(Logo,{}):null,jsxRuntimeExports.jsx(SearchBar,{}),jsxRuntimeExports.jsxs(HeaderActions,{children:[breakpoint$1==="small"||breakpoint$1==="medium"?jsxRuntimeExports.jsx(Logo,{}):null,jsxRuntimeExports.jsx(HelpButton,{})]})]})}const GradientPickerStyled=dt.div`
    padding: 20px;

    position: absolute;
    left: 10px;
    top: 0px;

    background-color: #222;
    box-shadow: 0 0 15px #444;
    border: 1px solid #71717187;
    border-radius: 6px;

    transform: rotateX(25deg) translateY(-100%);
    -webkit-transform: rotateX(25deg) translateY(-100%);
    will-change: -webkit-transform, transform, opacity;
    transition-property: -webkit-transform, transform, opacity;
    transition-duration: 150ms;
    -webkit-transition-property: -webkit-transform, transform, opacity;
    -webkit-transition-duration: 150ms;
    opacity: 0;
    pointer-events: none;
    transition-timing-function: cubic-bezier(.4,0,.2,1);
    -webkit-transition-timing-function: cubic-bezier(.4,0,.2,1);

    display: flex;
    flex-wrap: wrap;
    gap: 15px;

    width: 300px;
`,GradientContainer=dt.div`
    border: none;
    cursor: pointer;
    background: transparent;

    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;

    width: max-content;
`,Gradient=dt.div`
    width: 40px;
    height: 40px;
    border-radius: 6px;
    background: ${e=>e.$background};
    transition: box-shadow 0.1s;
    -webkit-transition: box-shadow 0.1s;
    position: relative;

    &::before {
        content: '';
        position: absolute;
        top: -5px;
        left: -5px;
        right: -5px;
        bottom: -5px;
        border: 2px solid transparent;
        transition: transform 0.4s ease, border-color 0.4s ease;
        -webkit-transition: transform 0.4s ease, border-color 0.4s ease;
        border-radius: 10px;
    }

    ${e=>e.$isSelected?`
            &::before {
                border-color: #CE66FF; 
                transform: scale(1); 
                -webkit-transform: scale(1); 
            }
        `:""}

    &:hover {
        box-shadow: 0 0 2px 4px #ffffff26;
    }

    &:active {
        transform: scale(0.9);
        -webkit-transform: scale(0.9);
    }
`,GradientName=dt.small`
    color: #FFF;
`;function GradientPicker({gradient:e,onGradientChange:t}){return jsxRuntimeExports.jsx(GradientPickerStyled,{className:"color-picker",children:Object.keys(GRADIENTS).map(n=>jsxRuntimeExports.jsxs(GradientContainer,{"aria-label":"Gradient buton",onClick:()=>t(n),children:[jsxRuntimeExports.jsx(Gradient,{$background:GRADIENTS[n],$isSelected:e===n}),jsxRuntimeExports.jsx(GradientName,{children:n})]},n))})}const ToolbarContainer=dt.ul`
    width: 100px;
    height: max-content;
    border-radius: 8px;
    background-color: #272727;
    padding: 20px 5px 10px 5px;
    margin: none;
    list-style-type: none;

    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;

    position: relative;

    ${tablet(`
        flex-direction: row;
        width: 90%;
        padding: 10px;
        margin: 0;
        justify-content: space-between;
        gap: 0px;

        position: absolute;
        top: 180px;

        & hr {
            width: 1px;
            height: 40px;
            margin: 0;
        }
    `)}
`,ToolbarListItem=dt.li`
    width: 100%;

    ${tablet(`
        width: auto !important;
    `)}
`,Tool=dt.button`
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    width: 90%;
    padding: 10px;
    border-radius: 5px;
    transition: background-color 0.1s;
    -webkit-transition: background-color 0.1s;
    border: none;
    position: relative;

    background: ${e=>e.$withBackground?"linear-gradient(45deg, #CE66FF, #FE983B)":"transparent"};

    & span {
        color: ${e=>e.$withBackground?"#FFF":"#9F9F9F"};
        font-weight: ${e=>e.$withBackground?"600":"normal"};;
    }

    &:hover {
        background-color: #323131;
    }

    &:hover ${GradientPickerStyled} {
        opacity: 1;
        pointer-events: auto;
        transform: translateY(-100%);
        -webkit-transform: translateY(-100%);
    }

    &:active svg, &:active > div {
        transform: scale(0.8);
        -webkit-transform: scale(0.8);
    }

    & svg {
        ${tablet(`
            width: 20px !important;
            height: 20px !important;
        `)}
    }

    ${tablet(`
        width: auto;
    `)}
`,ToolName=dt.span`
    color: #9F9F9F;
    font-size: 12px;
`,ColorTool=dt.div`
    width: 30px;
    height: 30px;
    border-radius: 50%;
    background: ${e=>e.$gradient};
    box-shadow: rgba(255, 255, 255, 0.7) 0px 0px 0px 2px, rgba(0, 0, 0, 0.5) 0px 3px 6px;

    ${tablet(`
        width: 20px;
        height: 20px;
    `)}
`,RelaysToolContainer=dt.div`
    position: relative;
    width: 100%;

    ${tablet(`
        width: auto;
    `)}
`,RelaysContainer=dt.aside`
    position: absolute;
    top: 0px;
    right: 0px;
    padding: 20px;
    box-shadow: 0 0 15px #444;
    color: #FFF;
    cursor: default;
    z-index: 100;

    border: 1px solid transparent;
    border-radius: 6px;
    background: 
        linear-gradient(90deg, #222, #222), 
        linear-gradient(to right, #FE983B , #CE66FF);

    background-clip: padding-box, border-box;
    background-origin: padding-box, border-box;

    min-width: 300px;

    display: flex;
    flex-direction: column;
    gap: 36px;

    will-change:-webkit-transform,  transform, opacity;
    transition-property: -webkit-transform, transform, opacity;
    transition-duration: 150ms;
    transition-timing-function: cubic-bezier(.4,0,.2,1);
    -webkit-transition-property: -webkit-transform, transform, opacity;
    -webkit-transition-duration: 150ms;
    -webkit-transition-timing-function: cubic-bezier(.4,0,.2,1);

    ${tablet(`
        display: none;
        position: fixed;
        left: 0;
        right: 0;
        width: 100vw;
        height: 100vh;
        z-index: 10000;
    `)}
`,RelaysCardHeader=dt.div`
    display: flex;
    justify-content: space-between;
    font-size: 22px
`,CloseButton=dt.button`
    width: 32px;
    height: 32px;
    display: flex;
    justify-content: center;
    align-items: center;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s;
    -webkit-transition: all 0.2s;
    background-color: transparent;

    &:hover {
        background-color: transparent;
        border: 1px solid #FE3B3B;
    }

    &:focus {
        outline: 1px solid #FE3B3B;
    }
`,InputContainer=dt.div`
    display: flex;
    gap: 8px;
`,Input=dt.input`
    background-color: transparent;
    border: 1px solid #383838;
    border-radius: 6px;
    padding: 12px;
    flex: 1;
    color: #FFF;
`,AddButton=dt.button`
    background-color: #383838;
    width: 42px;
    display: flex;
    justify-content: center;
    align-items: center;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s;
    -webkit-transition: all 0.2s;

    &:hover {
        background-color: transparent;
        border: 1px solid #383838;
    }
`,SaveButton=dt.button`
    border: 1px solid transparent;
    border-radius: 6px;
    background: 
        linear-gradient(90deg, #383838, #383838), 
        linear-gradient(to right, #CE66FF , #FE983B);

    background-clip: padding-box, border-box;
    background-origin: padding-box, border-box;

    width: 100%;
    padding: 10px;
    font-size: 18px;
    font-weight: bold;
    color: #FFF;
    cursor: pointer;
`,RelayList=dt.ul`
    list-style-type: none;
    margin-top: 12px;
    padding: 0;

    display: flex;
    flex-direction: column;
    gap: 2px;
`,RelayItem=dt.li`
    display: flex;
    align-items: center;
    gap: 8px;

    color: #9F9F9F;
    font-size: 14px;
`,breakpoint=getBreakpoint();function RelaysModal({isOpen:e,onClose:t}){const{relays:n,setRelays:s}=useRelaysContext(),[a,l]=reactExports.useState(n||[]),de=reactExports.useRef(null),[pe,me]=reactExports.useState(!1),Be=ot=>{if(ot.preventDefault(),!de||!de.current)return;const yt=de.current.value;l(nt=>[...nt,yt]),de.current.value=""},Le=ot=>{l(yt=>yt.filter(nt=>nt!==ot))},Ye=()=>{if(a.length===0){me(!0);return}s(a),t()};let tt={};return breakpoint==="small"||breakpoint==="medium"?tt={display:e?"flex":"none"}:tt={transform:e?"translateX(100%)":"translateX(95%)",opacity:e?1:0,pointerEvents:e?"all":"none"},jsxRuntimeExports.jsxs(RelaysContainer,{className:"relays-modal",style:tt,children:[jsxRuntimeExports.jsxs(RelaysCardHeader,{children:[jsxRuntimeExports.jsx("label",{htmlFor:"relay-address",children:"Relay address"}),jsxRuntimeExports.jsx(CloseButton,{onClick:()=>t(),"aria-label":"Close relay modal button",children:jsxRuntimeExports.jsx(Close,{})})]}),jsxRuntimeExports.jsxs("main",{children:[jsxRuntimeExports.jsx("form",{onSubmit:Be,children:jsxRuntimeExports.jsxs(InputContainer,{children:[jsxRuntimeExports.jsx(Input,{id:"relay-address",type:"text",placeholder:"wss://relay.primal.net",ref:de}),jsxRuntimeExports.jsx(AddButton,{onClick:Be,"aria-label":"Add a relay button",children:jsxRuntimeExports.jsx(Plus,{})})]})}),jsxRuntimeExports.jsxs(RelayList,{children:[pe?jsxRuntimeExports.jsx(ErrorText,{style:{transform:"unset",textAlign:"start"},children:"Set at least one relay"}):null,a.map((ot,yt)=>jsxRuntimeExports.jsxs(RelayItem,{children:[jsxRuntimeExports.jsx("span",{children:ot}),jsxRuntimeExports.jsx(Pointer,{onClick:()=>Le(ot),children:jsxRuntimeExports.jsx(Delete,{})})]},ot+yt))]})]}),jsxRuntimeExports.jsx(SaveButton,{onClick:Ye,children:"Save"})]})}function Toolbar({onDownload:e,onCopy:t,showResponse:n,onChangeShowResponse:s,gradient:a,onGradientChange:l,isDownloading:de,isCopying:pe}){const[me,Be]=reactExports.useState(!1);return jsxRuntimeExports.jsxs(ToolbarContainer,{children:[jsxRuntimeExports.jsx(ToolbarListItem,{children:jsxRuntimeExports.jsxs(Tool,{"aria-label":"Gradient picker button",children:[jsxRuntimeExports.jsx(GradientPicker,{gradient:a,onGradientChange:l}),jsxRuntimeExports.jsx(ColorTool,{$gradient:GRADIENTS[a]}),jsxRuntimeExports.jsx(ToolName,{children:"Color"})]})}),jsxRuntimeExports.jsx(ToolbarListItem,{children:jsxRuntimeExports.jsxs(Tool,{onClick:()=>s(!n),"aria-label":"Stats toggle button",children:[jsxRuntimeExports.jsx(HeartIcon,{isSelected:n}),jsxRuntimeExports.jsx(ToolName,{children:"Stats"})]})}),jsxRuntimeExports.jsx(ToolbarListItem,{children:jsxRuntimeExports.jsxs(RelaysToolContainer,{children:[jsxRuntimeExports.jsxs(Tool,{onClick:()=>Be(Le=>!Le),"aria-label":"Relays toggle button",children:[jsxRuntimeExports.jsx(Relays,{}),jsxRuntimeExports.jsx(ToolName,{children:"Relays"})]}),jsxRuntimeExports.jsx(RelaysModal,{isOpen:me,onClose:()=>{Be(!1)}})]})}),jsxRuntimeExports.jsx(ToolbarListItem,{children:jsxRuntimeExports.jsx(Divider,{})}),jsxRuntimeExports.jsx(ToolbarListItem,{children:jsxRuntimeExports.jsxs(Tool,{onClick:t,"aria-label":"Copy button",children:[pe?jsxRuntimeExports.jsx("div",{className:"loader"}):jsxRuntimeExports.jsx(CopyIcon,{}),jsxRuntimeExports.jsx(ToolName,{children:"Copy"})]})}),jsxRuntimeExports.jsx(ToolbarListItem,{children:jsxRuntimeExports.jsxs(Tool,{$withBackground:!0,onClick:e,"aria-label":"Download button",children:[de?jsxRuntimeExports.jsx("div",{className:"loader"}):jsxRuntimeExports.jsx(DownloadIcon,{}),jsxRuntimeExports.jsx(ToolName,{children:"Download"})]})})]})}const HomePageContainer=dt.main`
    min-height: 100vh;
    width: 100vw;
    background: rgb(24,25,26);
    background: linear-gradient(130deg, rgba(24,25,26,1) 0%, rgba(39,39,40,1) 100%);
    display: flex;
    flex-direction: column;
`,MainSection=dt.article`
    padding: 20px 60px;

    flex: 1;
    display: flex;
    align-items: center;
    justify-content: space-between;

    ${tablet(`
        flex-direction: column-reverse;
        padding: 20px;
    `)}
`;function HomePage(){const e=reactExports.useRef(null),[t,n]=reactExports.useState(!0),[s,a]=reactExports.useState(initialGradient),[l,de]=reactExports.useState(!1),[pe,me]=reactExports.useState(!1),{note:Be}=useNoteContext();function Le(){de(!0);const tt=e.current;tt&&getDataURLFromHTMLDOM(tt).then(ot=>downloadImage("nostr-note",ot)).finally(()=>{de(!1),B$1.success("Image ready for download!"),trackEvent("IMAGE_DOWNLOADED",Be.postId)})}function Ye(){const tt=e.current;tt&&(me(!0),getDataURLFromHTMLDOM(tt).then(copyDataURL).finally(()=>{me(!1),B$1.success("Image copied!"),trackEvent("IMAGE_COPIED",Be.postId)}))}return jsxRuntimeExports.jsxs(HomePageContainer,{children:[jsxRuntimeExports.jsx(Header,{}),jsxRuntimeExports.jsxs(MainSection,{children:[jsxRuntimeExports.jsx(Toolbar,{onDownload:Le,onCopy:Ye,showResponse:t,onChangeShowResponse:tt=>n(tt),gradient:s,onGradientChange:tt=>a(tt),isDownloading:l,isCopying:pe}),jsxRuntimeExports.jsx(Q$1,{position:"bottom-left",autoClose:1e3,hideProgressBar:!0,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"dark",transition:H$1}),jsxRuntimeExports.jsx(Canvas,{ref:e,noteHTML:Be.html,note:Be,showResponse:t,gradient:GRADIENTS[s],nostrBrandingColor:NOSTR_BRANDING_COLORS[s]})]})]})}export{HomePage as default};
